import{b as J,ax as He,r as R,c as A,o as f,R as e,J as t,al as v,a as l,K as ke,S as Ae,u as j,O as y,p as ve,ay as Ne,P as B,I as X,L as Y,az as De,t as Te,X as je,ar as We,E as de,w as Le,Q as se,a6 as oe,W as Ye,a4 as Ie,aA as fe,aB as le,aC as Ge,aD as Xe,aE as Je,au as Qe}from"./vue-Bh7ksF0J.js";import{h as Ze,u as ze,p as et,a as _e,m as tt,d as Ee,f as lt,b as at,l as st,c as ot,e as nt,t as it,E as P,g as ye,r as re,i as dt,j as ut,k as rt,n as Be,o as ct,q as pt,s as mt,v as ft,w as vt}from"./elementPlus-DoEz3rhs.js";import{a as _t}from"./utils-NIGUFBhG.js";(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&p(r)}).observe(document,{childList:!0,subtree:!0});function d(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function p(o){if(o.ep)return;o.ep=!0;const i=d(o);fetch(o.href,i)}})();const gt="/vite.svg",ee=(a,u)=>{const d=a.__vccOpts||a;for(const[p,o]of u)d[p]=o;return d},yt={id:"app"},ht={class:"sidebar"},bt={class:"logo"},wt={src:gt,alt:"Logo",class:"logo-img"},$t={class:"header-content"},Vt={class:"header-left"},kt={__name:"App",setup(a){const u=He(),d=J(()=>u.path),p=R(!1),o=()=>{p.value=!p.value};return(i,r)=>{const $=v("el-icon"),T=v("el-menu-item"),L=v("el-sub-menu"),M=v("el-menu"),I=v("el-aside"),V=v("el-header"),x=v("router-view"),c=v("el-main"),O=v("el-container");return f(),A("div",yt,[e(O,null,{default:t(()=>[e(I,{width:p.value?"64px":"200px"},{default:t(()=>[l("div",ht,[l("div",bt,[ke(l("img",wt,null,512),[[Ae,p.value]]),ke(l("h2",null,"自媒体自动化运营系统",512),[[Ae,!p.value]])]),e(M,{router:!0,"default-active":d.value,collapse:p.value,class:"sidebar-menu","background-color":"#001529","text-color":"#fff","active-text-color":"#409EFF"},{default:t(()=>[e(T,{index:"/"},{default:t(()=>[e($,null,{default:t(()=>[e(j(Ze))]),_:1}),r[0]||(r[0]=l("span",null,"首页",-1))]),_:1}),e(T,{index:"/account-management"},{default:t(()=>[e($,null,{default:t(()=>[e(j(ze))]),_:1}),r[1]||(r[1]=l("span",null,"账号管理",-1))]),_:1}),e(L,{index:"/material-management"},{title:t(()=>[e($,null,{default:t(()=>[e(j(et))]),_:1}),r[2]||(r[2]=l("span",null,"素材管理",-1))]),default:t(()=>[e(T,{index:"/material-management/list"},{default:t(()=>[...r[3]||(r[3]=[y("素材列表",-1)])]),_:1}),e(T,{index:"/material-management/cover"},{default:t(()=>[...r[4]||(r[4]=[y("封面生成",-1)])]),_:1})]),_:1}),e(T,{index:"/publish-center"},{default:t(()=>[e($,null,{default:t(()=>[e(j(_e))]),_:1}),r[5]||(r[5]=l("span",null,"发布中心",-1))]),_:1}),e(T,{index:"/website"},{default:t(()=>[e($,null,{default:t(()=>[e(j(tt))]),_:1}),r[6]||(r[6]=l("span",null,"网站",-1))]),_:1}),e(T,{index:"/data"},{default:t(()=>[e($,null,{default:t(()=>[e(j(Ee))]),_:1}),r[7]||(r[7]=l("span",null,"数据",-1))]),_:1})]),_:1},8,["default-active","collapse"])])]),_:1},8,["width"]),e(O,null,{default:t(()=>[e(V,null,{default:t(()=>[l("div",$t,[l("div",Vt,[e($,{class:"toggle-sidebar",onClick:o},{default:t(()=>[e(j(lt))]),_:1})]),r[8]||(r[8]=l("div",{class:"header-right"},null,-1))])]),_:1}),e(c,null,{default:t(()=>[e(x)]),_:1})]),_:1})]),_:1})])}}},Ct=ee(kt,[["__scopeId","data-v-480a24d9"]]),Tt={class:"dashboard"},xt={class:"dashboard-content"},At={class:"stat-card-content"},Ut={class:"stat-icon"},Pt={class:"stat-info"},St={class:"stat-value"},Mt={class:"stat-footer"},Dt={class:"stat-detail"},Lt={class:"stat-card-content"},It={class:"stat-icon platform-icon"},zt={class:"stat-info"},Et={class:"stat-value"},Bt={class:"stat-footer"},Ft={class:"stat-detail"},Rt={class:"stat-card-content"},Ot={class:"stat-icon task-icon"},qt={class:"stat-info"},Kt={class:"stat-value"},Ht={class:"stat-footer"},Nt={class:"stat-detail"},jt={class:"stat-card-content"},Wt={class:"stat-icon content-icon"},Yt={class:"stat-info"},Gt={class:"stat-value"},Xt={class:"stat-footer"},Jt={class:"stat-detail"},Qt={class:"quick-actions"},Zt={class:"action-icon"},el={class:"action-icon"},tl={class:"action-icon"},ll={class:"action-icon"},al={class:"recent-tasks"},sl={class:"section-header"},ol={__name:"Dashboard",setup(a){const u=Ne(),d=ve({total:12,normal:10,abnormal:2}),p=ve({total:4,kuaishou:3,douyin:4,channels:2,xiaohongshu:3}),o=ve({total:24,completed:18,inProgress:5,failed:1}),i=ve({total:36,published:30,draft:6}),r=R([{id:1,title:"快手视频自动发布",platform:"快手",account:"快手账号1",createTime:"2024-05-01 10:30:00",status:"已完成"},{id:2,title:"抖音视频定时发布",platform:"抖音",account:"抖音账号1",createTime:"2024-05-01 11:15:00",status:"进行中"},{id:3,title:"视频号内容上传",platform:"视频号",account:"视频号账号1",createTime:"2024-05-01 14:20:00",status:"待执行"},{id:4,title:"小红书图文发布",platform:"小红书",account:"小红书账号1",createTime:"2024-05-01 16:45:00",status:"已失败"},{id:5,title:"快手短视频批量上传",platform:"快手",account:"快手账号2",createTime:"2024-05-02 09:10:00",status:"待执行"}]),$=x=>({快手:"success",抖音:"danger",视频号:"warning",小红书:"info"})[x]||"info",T=x=>({已完成:"success",进行中:"warning",待执行:"info",已失败:"danger"})[x]||"info",L=x=>{u.push(x)},M=x=>{P.info(`查看任务: ${x.title}`)},I=x=>{ye.confirm(`确定要执行任务 ${x.title} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(()=>{const c=r.value.findIndex(O=>O.id===x.id);c!==-1&&(r.value[c].status="进行中"),P({type:"success",message:"任务已开始执行"})}).catch(()=>{})},V=x=>{ye.confirm(`确定要取消任务 ${x.title} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const c=r.value.findIndex(O=>O.id===x.id);c!==-1&&(r.value[c].status="已取消"),P({type:"success",message:"任务已取消"})}).catch(()=>{})};return(x,c)=>{const O=v("el-icon"),U=v("el-card"),n=v("el-col"),S=v("el-tag"),_=v("el-tooltip"),m=v("el-row"),W=v("el-button"),F=v("el-table-column"),k=v("el-table");return f(),A("div",Tt,[c[19]||(c[19]=l("div",{class:"page-header"},[l("h1",null,"自媒体自动化运营系统")],-1)),l("div",xt,[e(m,{gutter:20},{default:t(()=>[e(n,{span:6},{default:t(()=>[e(U,{class:"stat-card"},{default:t(()=>[l("div",At,[l("div",Ut,[e(O,null,{default:t(()=>[e(j(ze))]),_:1})]),l("div",Pt,[l("div",St,B(d.total),1),c[1]||(c[1]=l("div",{class:"stat-label"},"账号总数",-1))])]),l("div",Mt,[l("div",Dt,[l("span",null,"正常: "+B(d.normal),1),l("span",null,"异常: "+B(d.abnormal),1)])])]),_:1})]),_:1}),e(n,{span:6},{default:t(()=>[e(U,{class:"stat-card"},{default:t(()=>[l("div",Lt,[l("div",It,[e(O,null,{default:t(()=>[e(j(at))]),_:1})]),l("div",zt,[l("div",Et,B(p.total),1),c[2]||(c[2]=l("div",{class:"stat-label"},"平台总数",-1))])]),l("div",Bt,[l("div",Ft,[e(_,{content:"快手账号",placement:"top"},{default:t(()=>[e(S,{size:"small",type:"success"},{default:t(()=>[y(B(p.kuaishou),1)]),_:1})]),_:1}),e(_,{content:"抖音账号",placement:"top"},{default:t(()=>[e(S,{size:"small",type:"danger"},{default:t(()=>[y(B(p.douyin),1)]),_:1})]),_:1}),e(_,{content:"视频号账号",placement:"top"},{default:t(()=>[e(S,{size:"small",type:"warning"},{default:t(()=>[y(B(p.channels),1)]),_:1})]),_:1}),e(_,{content:"小红书账号",placement:"top"},{default:t(()=>[e(S,{size:"small",type:"info"},{default:t(()=>[y(B(p.xiaohongshu),1)]),_:1})]),_:1})])])]),_:1})]),_:1}),e(n,{span:6},{default:t(()=>[e(U,{class:"stat-card"},{default:t(()=>[l("div",Rt,[l("div",Ot,[e(O,null,{default:t(()=>[e(j(st))]),_:1})]),l("div",qt,[l("div",Kt,B(o.total),1),c[3]||(c[3]=l("div",{class:"stat-label"},"任务总数",-1))])]),l("div",Ht,[l("div",Nt,[l("span",null,"完成: "+B(o.completed),1),l("span",null,"进行中: "+B(o.inProgress),1),l("span",null,"失败: "+B(o.failed),1)])])]),_:1})]),_:1}),e(n,{span:6},{default:t(()=>[e(U,{class:"stat-card"},{default:t(()=>[l("div",jt,[l("div",Wt,[e(O,null,{default:t(()=>[e(j(ot))]),_:1})]),l("div",Yt,[l("div",Gt,B(i.total),1),c[4]||(c[4]=l("div",{class:"stat-label"},"内容总数",-1))])]),l("div",Xt,[l("div",Jt,[l("span",null,"已发布: "+B(i.published),1),l("span",null,"草稿: "+B(i.draft),1)])])]),_:1})]),_:1})]),_:1}),l("div",Qt,[c[13]||(c[13]=l("h2",null,"快捷操作",-1)),e(m,{gutter:20},{default:t(()=>[e(n,{span:6},{default:t(()=>[e(U,{class:"action-card",onClick:c[0]||(c[0]=b=>L("/account-management"))},{default:t(()=>[l("div",Zt,[e(O,null,{default:t(()=>[e(j(nt))]),_:1})]),c[5]||(c[5]=l("div",{class:"action-title"},"账号管理",-1)),c[6]||(c[6]=l("div",{class:"action-desc"},"管理所有平台账号",-1))]),_:1})]),_:1}),e(n,{span:6},{default:t(()=>[e(U,{class:"action-card"},{default:t(()=>[l("div",el,[e(O,null,{default:t(()=>[e(j(_e))]),_:1})]),c[7]||(c[7]=l("div",{class:"action-title"},"内容上传",-1)),c[8]||(c[8]=l("div",{class:"action-desc"},"上传视频和图文内容",-1))]),_:1})]),_:1}),e(n,{span:6},{default:t(()=>[e(U,{class:"action-card"},{default:t(()=>[l("div",tl,[e(O,null,{default:t(()=>[e(j(it))]),_:1})]),c[9]||(c[9]=l("div",{class:"action-title"},"定时发布",-1)),c[10]||(c[10]=l("div",{class:"action-desc"},"设置内容发布时间",-1))]),_:1})]),_:1}),e(n,{span:6},{default:t(()=>[e(U,{class:"action-card"},{default:t(()=>[l("div",ll,[e(O,null,{default:t(()=>[e(j(Ee))]),_:1})]),c[11]||(c[11]=l("div",{class:"action-title"},"数据分析",-1)),c[12]||(c[12]=l("div",{class:"action-desc"},"查看内容数据分析",-1))]),_:1})]),_:1})]),_:1})]),l("div",al,[l("div",sl,[c[15]||(c[15]=l("h2",null,"最近任务",-1)),e(W,{text:""},{default:t(()=>[...c[14]||(c[14]=[y("查看全部",-1)])]),_:1})]),e(k,{data:r.value,style:{width:"100%"}},{default:t(()=>[e(F,{prop:"title",label:"任务名称",width:"250"}),e(F,{prop:"platform",label:"平台",width:"120"},{default:t(b=>[e(S,{type:$(b.row.platform),effect:"plain"},{default:t(()=>[y(B(b.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(F,{prop:"account",label:"账号",width:"150"}),e(F,{prop:"createTime",label:"创建时间",width:"180"}),e(F,{prop:"status",label:"状态",width:"120"},{default:t(b=>[e(S,{type:T(b.row.status),effect:"plain"},{default:t(()=>[y(B(b.row.status),1)]),_:2},1032,["type"])]),_:1}),e(F,{label:"操作"},{default:t(b=>[e(W,{size:"small",onClick:q=>M(b.row)},{default:t(()=>[...c[16]||(c[16]=[y("查看",-1)])]),_:1},8,["onClick"]),b.row.status==="待执行"?(f(),X(W,{key:0,size:"small",type:"primary",onClick:q=>I(b.row)},{default:t(()=>[...c[17]||(c[17]=[y(" 执行 ",-1)])]),_:1},8,["onClick"])):Y("",!0),b.row.status!=="已完成"&&b.row.status!=="已失败"?(f(),X(W,{key:1,size:"small",type:"danger",onClick:q=>V(b.row)},{default:t(()=>[...c[18]||(c[18]=[y(" 取消 ",-1)])]),_:1},8,["onClick"])):Y("",!0)]),_:1})]),_:1},8,["data"])])])])}}},nl=ee(ol,[["__scopeId","data-v-db5c2d61"]]),me=_t.create({baseURL:"http://localhost:5409",headers:{"Content-Type":"application/json"}});me.interceptors.request.use(a=>{const u=localStorage.getItem("token");return u&&(a.headers.Authorization=`Bearer ${u}`),a},a=>(console.error("请求错误:",a),Promise.reject(a)));me.interceptors.response.use(a=>{const{data:u}=a;return u.code===200||u.success?u:(P.error(u.message||"请求失败"),Promise.reject(new Error(u.message||"请求失败")))},a=>{if(console.error("响应错误:",a),a.response){const{status:u}=a.response;switch(u){case 401:P.error("未授权，请重新登录");break;case 403:P.error("拒绝访问");break;case 404:P.error("请求地址不存在");break;case 500:P.error("服务器内部错误");break;default:P.error("网络错误")}}else P.error("网络连接失败");return Promise.reject(a)});const ce={get(a,u){return me.get(a,{params:u})},post(a,u,d={}){return me.post(a,u,d)},put(a,u,d={}){return me.put(a,u,d)},delete(a,u){return me.delete(a,{params:u})},upload(a,u){return me.post(a,u,{headers:{"Content-Type":"multipart/form-data"}})}},Ve={getValidAccounts(a){return ce.get("/getValidAccounts",a)},addAccount(a){return ce.post("/account",a)},updateAccount(a){return ce.post("/updateUserinfo",a)},deleteAccount(a){return ce.get(`/deleteAccount?id=${a}`)},openAccounts(a){return ce.post("/openAccounts",{ids:a})}},Se=De("account",()=>{const a=R([]),u={1:"小红书",2:"视频号",3:"抖音",4:"快手",5:"B站"};return{accounts:a,setAccounts:$=>{a.value=$.map(T=>({id:T[0],type:T[1],filePath:T[2],name:T[3],status:T[4]===1?"正常":"异常",platform:u[T[1]]||"未知",avatar:"/vite.svg"}))},addAccount:$=>{a.value.push($)},updateAccount:($,T)=>{const L=a.value.findIndex(M=>M.id===$);L!==-1&&(a.value[L]={...a.value[L],...T})},deleteAccount:$=>{a.value=a.value.filter(T=>T.id!==$)},getAccountsByPlatform:$=>a.value.filter(T=>T.platform===$)}}),xe=De("app",()=>{const a=R(!0),u=R(!0),d=R(!1),p=R([]);return{isFirstTimeAccountManagement:a,isFirstTimeMaterialManagement:u,isAccountRefreshing:d,materials:p,setAccountManagementVisited:()=>{a.value=!1},setMaterialManagementVisited:()=>{u.value=!1},resetVisitStatus:()=>{a.value=!0,u.value=!0},setMaterials:I=>{p.value=I},addMaterial:I=>{p.value.push(I)},removeMaterial:I=>{const V=p.value.findIndex(x=>x.id===I);V>-1&&p.value.splice(V,1)},setAccountRefreshing:I=>{d.value=I}}}),il={class:"account-management","element-loading-text":"正在验证账号..."},dl={class:"account-tabs"},ul={class:"account-list-container"},rl={class:"account-search"},cl={class:"action-buttons"},pl={class:"refresh-text"},ml={key:0,class:"account-list"},fl={key:1,class:"empty-data"},vl={class:"account-list-container"},_l={class:"account-search"},gl={class:"action-buttons"},yl={class:"refresh-text"},hl={key:0,class:"account-list"},bl={key:1,class:"empty-data"},wl={class:"account-list-container"},$l={class:"account-search"},Vl={class:"action-buttons"},kl={class:"refresh-text"},Cl={key:0,class:"account-list"},Tl={key:1,class:"empty-data"},xl={class:"account-list-container"},Al={class:"account-search"},Ul={class:"action-buttons"},Pl={class:"refresh-text"},Sl={key:0,class:"account-list"},Ml={key:1,class:"empty-data"},Dl={class:"account-list-container"},Ll={class:"account-search"},Il={class:"action-buttons"},zl={class:"refresh-text"},El={key:0,class:"account-list"},Bl={key:1,class:"empty-data"},Fl={class:"account-list-container"},Rl={class:"account-search"},Ol={class:"action-buttons"},ql={class:"refresh-text"},Kl={key:0,class:"account-list"},Hl={key:1,class:"empty-data"},Nl={key:0,class:"qrcode-container"},jl={key:0,class:"qrcode-wrapper"},Wl=["src"],Yl={key:1,class:"loading-wrapper"},Gl={key:2,class:"success-wrapper"},Xl={key:3,class:"error-wrapper"},Jl={class:"dialog-footer"},Ql={__name:"AccountManagement",setup(a){const u=Se(),d=xe(),p=R("all"),o=R(""),i=async(D=!1,s=[])=>{if(!d.isAccountRefreshing){d.setAccountRefreshing(!0);try{const H={validate:D?1:0};D&&Array.isArray(s)&&s.length>0&&(H.ids=s.join(","));const E=await Ve.getValidAccounts(H);E.code===200&&E.data?(u.setAccounts(E.data),D&&P.success("账号验证完成"),d.isFirstTimeAccountManagement&&d.setAccountManagementVisited()):P.error("获取账号数据失败")}catch(H){console.error("获取账号数据失败:",H),P.error("获取账号数据失败")}finally{d.setAccountRefreshing(!1)}}};Te(()=>{d.isFirstTimeAccountManagement&&i(!1)});const r=D=>({快手:"success",抖音:"danger",视频号:"warning",小红书:"info"})[D]||"info",$=J(()=>o.value?u.accounts.filter(D=>D.name.includes(o.value)):u.accounts),T=R([]),L=D=>{T.value=D.map(s=>s.id)},M=async()=>{var D;if(T.value.length)try{const s=await Ve.openAccounts(T.value);s.code===200?P.success(`已打开 ${((D=s.data)==null?void 0:D.opened)??T.value.length} 个标签页`):P.error(s.msg||"打开失败")}catch{P.error("打开失败")}},I=J(()=>$.value.filter(D=>D.platform==="快手")),V=J(()=>$.value.filter(D=>D.platform==="抖音")),x=J(()=>$.value.filter(D=>D.platform==="视频号")),c=J(()=>$.value.filter(D=>D.platform==="小红书")),O=J(()=>$.value.filter(D=>D.platform==="B站")),U=()=>{},n=R(!1),S=R("add"),_=R(null),m=ve({id:null,name:"",platform:"",status:"正常"}),W={platform:[{required:!0,message:"请选择平台",trigger:"change"}],name:[{required:!0,message:"请输入账号名称",trigger:"blur"}]},F=R(!1),k=R(""),b=R(""),q=()=>{S.value="add",Object.assign(m,{id:null,name:"",platform:"",status:"正常"}),F.value=!1,k.value="",b.value="",n.value=!0},K=D=>{ye.confirm(`确定要删除账号 ${D.name} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const s=await Ve.deleteAccount(D.id);s.code===200?(u.deleteAccount(D.id),P({type:"success",message:"删除成功"})):P.error(s.msg||"删除失败")}catch(s){console.error("删除账号失败:",s),P.error("删除账号失败")}}).catch(()=>{})};let G=null;const Z=()=>{G&&(G.close(),G=null)},C=(D,s,H=null)=>{Z(),F.value=!0,k.value="",b.value="";const h={小红书:"1",视频号:"2",抖音:"3",快手:"4",B站:"5"}[D]||"1",g="http://localhost:5409",Q=new URLSearchParams({type:h,id:s});H&&(Q.append("update","1"),Q.append("record_id",String(H)));const ae=`${g}/login?${Q.toString()}`;G=new EventSource(ae),G.onmessage=ie=>{const te=ie.data;if(console.log("SSE消息:",te),!k.value&&te.length>100)try{te.startsWith("data:image")?k.value=te:k.value=`data:image/png;base64,${te}`,console.log("设置二维码数据，长度:",te.length)}catch(ue){console.error("处理二维码数据出错:",ue)}else(te==="200"||te==="500")&&(b.value=te,te==="200"?setTimeout(()=>{Z(),setTimeout(()=>{n.value=!1,F.value=!1,P.success(H?"账号更新成功":"账号添加成功"),P({type:"info",message:"正在同步账号信息...",duration:0}),i().then(()=>{P.closeAll(),P.success("账号信息已更新")})},1e3)},1e3):(Z(),setTimeout(()=>{F.value=!1,k.value="",b.value=""},2e3)))},G.onerror=ie=>{console.error("SSE连接错误:",ie),P.error("连接服务器失败，请稍后再试"),Z(),F.value=!1}},z=()=>{_.value.validate(async D=>{if(D)S.value==="add"?C(m.platform,m.name,m.id):P.info("编辑功能已取消，请删除后重新添加");else return!1})},N=D=>{S.value="add",Object.assign(m,{id:D.id,platform:D.platform,name:D.name,status:"正常"}),F.value=!1,k.value="",b.value="",n.value=!0};return je(()=>{Z()}),(D,s)=>{const H=v("el-input"),E=v("el-button"),h=v("el-icon"),g=v("el-table-column"),Q=v("el-avatar"),ae=v("el-tag"),ie=v("el-table"),te=v("el-empty"),ue=v("el-tab-pane"),Fe=v("el-tabs"),ge=v("el-option"),Re=v("el-select"),Me=v("el-form-item"),Oe=v("el-form"),qe=v("el-dialog"),Ke=We("loading");return ke((f(),A("div",il,[s[41]||(s[41]=l("div",{class:"page-header"},[l("h1",null,"账号管理")],-1)),l("div",dl,[e(Fe,{modelValue:p.value,"onUpdate:modelValue":s[12]||(s[12]=w=>p.value=w),class:"account-tabs-nav"},{default:t(()=>[e(ue,{label:"全部",name:"all"},{default:t(()=>[l("div",ul,[l("div",rl,[e(H,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=w=>o.value=w),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:U,onInput:U},null,8,["modelValue"]),l("div",cl,[e(E,{type:"primary",onClick:q},{default:t(()=>[...s[17]||(s[17]=[y("添加账号",-1)])]),_:1}),e(E,{type:"success",onClick:M,disabled:T.value.length===0},{default:t(()=>[...s[18]||(s[18]=[y("作品查看",-1)])]),_:1},8,["disabled"]),e(E,{type:"info",onClick:s[1]||(s[1]=()=>i(!0,T.value))},{default:t(()=>[e(h,{class:de({"is-loading":j(d).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(j(re))]),_:1},8,["class"]),l("span",pl,B(j(d).isAccountRefreshing?"验证中...":"过期验证"),1)]),_:1})])]),$.value.length>0?(f(),A("div",ml,[e(ie,{data:$.value,style:{width:"100%"},onSelectionChange:L},{default:t(()=>[e(g,{type:"selection",width:"55"}),e(g,{label:"头像",width:"80"},{default:t(w=>[e(Q,{src:w.row.avatar,size:40},null,8,["src"])]),_:1}),e(g,{prop:"name",label:"名称",width:"180"}),e(g,{prop:"platform",label:"平台"},{default:t(w=>[e(ae,{type:r(w.row.platform),effect:"plain"},{default:t(()=>[y(B(w.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"status",label:"状态"},{default:t(w=>[e(ae,{type:w.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[y(B(w.row.status),1)]),_:2},1032,["type"])]),_:1}),e(g,{label:"操作"},{default:t(w=>[w.row.status!=="正常"?(f(),X(E,{key:0,size:"small",type:"warning",onClick:ne=>N(w.row)},{default:t(()=>[...s[19]||(s[19]=[y("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(E,{size:"small",type:"danger",onClick:ne=>K(w.row)},{default:t(()=>[...s[20]||(s[20]=[y("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(f(),A("div",fl,[e(te,{description:"暂无账号数据"})]))])]),_:1}),e(ue,{label:"快手",name:"kuaishou"},{default:t(()=>[l("div",vl,[l("div",_l,[e(H,{modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=w=>o.value=w),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:U,onInput:U},null,8,["modelValue"]),l("div",gl,[e(E,{type:"primary",onClick:q},{default:t(()=>[...s[21]||(s[21]=[y("添加账号",-1)])]),_:1}),e(E,{type:"info",onClick:s[3]||(s[3]=()=>i(!0))},{default:t(()=>[e(h,{class:de({"is-loading":j(d).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(j(re))]),_:1},8,["class"]),l("span",yl,B(j(d).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),I.value.length>0?(f(),A("div",hl,[e(ie,{data:I.value,style:{width:"100%"}},{default:t(()=>[e(g,{label:"头像",width:"80"},{default:t(w=>[e(Q,{src:w.row.avatar,size:40},null,8,["src"])]),_:1}),e(g,{prop:"name",label:"名称",width:"180"}),e(g,{prop:"platform",label:"平台"},{default:t(w=>[e(ae,{type:r(w.row.platform),effect:"plain"},{default:t(()=>[y(B(w.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"status",label:"状态"},{default:t(w=>[e(ae,{type:w.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[y(B(w.row.status),1)]),_:2},1032,["type"])]),_:1}),e(g,{label:"操作"},{default:t(w=>[w.row.status!=="正常"?(f(),X(E,{key:0,size:"small",type:"warning",onClick:ne=>N(w.row)},{default:t(()=>[...s[22]||(s[22]=[y("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(E,{size:"small",type:"danger",onClick:ne=>K(w.row)},{default:t(()=>[...s[23]||(s[23]=[y("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(f(),A("div",bl,[e(te,{description:"暂无快手账号数据"})]))])]),_:1}),e(ue,{label:"抖音",name:"douyin"},{default:t(()=>[l("div",wl,[l("div",$l,[e(H,{modelValue:o.value,"onUpdate:modelValue":s[4]||(s[4]=w=>o.value=w),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:U,onInput:U},null,8,["modelValue"]),l("div",Vl,[e(E,{type:"primary",onClick:q},{default:t(()=>[...s[24]||(s[24]=[y("添加账号",-1)])]),_:1}),e(E,{type:"info",onClick:s[5]||(s[5]=()=>i(!0))},{default:t(()=>[e(h,{class:de({"is-loading":j(d).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(j(re))]),_:1},8,["class"]),l("span",kl,B(j(d).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),V.value.length>0?(f(),A("div",Cl,[e(ie,{data:V.value,style:{width:"100%"}},{default:t(()=>[e(g,{label:"头像",width:"80"},{default:t(w=>[e(Q,{src:w.row.avatar,size:40},null,8,["src"])]),_:1}),e(g,{prop:"name",label:"名称",width:"180"}),e(g,{prop:"platform",label:"平台"},{default:t(w=>[e(ae,{type:r(w.row.platform),effect:"plain"},{default:t(()=>[y(B(w.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"status",label:"状态"},{default:t(w=>[e(ae,{type:w.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[y(B(w.row.status),1)]),_:2},1032,["type"])]),_:1}),e(g,{label:"操作"},{default:t(w=>[w.row.status!=="正常"?(f(),X(E,{key:0,size:"small",type:"warning",onClick:ne=>N(w.row)},{default:t(()=>[...s[25]||(s[25]=[y("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(E,{size:"small",type:"danger",onClick:ne=>K(w.row)},{default:t(()=>[...s[26]||(s[26]=[y("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(f(),A("div",Tl,[e(te,{description:"暂无抖音账号数据"})]))])]),_:1}),e(ue,{label:"视频号",name:"channels"},{default:t(()=>[l("div",xl,[l("div",Al,[e(H,{modelValue:o.value,"onUpdate:modelValue":s[6]||(s[6]=w=>o.value=w),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:U,onInput:U},null,8,["modelValue"]),l("div",Ul,[e(E,{type:"primary",onClick:q},{default:t(()=>[...s[27]||(s[27]=[y("添加账号",-1)])]),_:1}),e(E,{type:"info",onClick:s[7]||(s[7]=()=>i(!0))},{default:t(()=>[e(h,{class:de({"is-loading":j(d).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(j(re))]),_:1},8,["class"]),l("span",Pl,B(j(d).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),x.value.length>0?(f(),A("div",Sl,[e(ie,{data:x.value,style:{width:"100%"}},{default:t(()=>[e(g,{label:"头像",width:"80"},{default:t(w=>[e(Q,{src:w.row.avatar,size:40},null,8,["src"])]),_:1}),e(g,{prop:"name",label:"名称",width:"180"}),e(g,{prop:"platform",label:"平台"},{default:t(w=>[e(ae,{type:r(w.row.platform),effect:"plain"},{default:t(()=>[y(B(w.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"status",label:"状态"},{default:t(w=>[e(ae,{type:w.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[y(B(w.row.status),1)]),_:2},1032,["type"])]),_:1}),e(g,{label:"操作"},{default:t(w=>[w.row.status!=="正常"?(f(),X(E,{key:0,size:"small",type:"warning",onClick:ne=>N(w.row)},{default:t(()=>[...s[28]||(s[28]=[y("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(E,{size:"small",type:"danger",onClick:ne=>K(w.row)},{default:t(()=>[...s[29]||(s[29]=[y("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(f(),A("div",Ml,[e(te,{description:"暂无视频号账号数据"})]))])]),_:1}),e(ue,{label:"小红书",name:"xiaohongshu"},{default:t(()=>[l("div",Dl,[l("div",Ll,[e(H,{modelValue:o.value,"onUpdate:modelValue":s[8]||(s[8]=w=>o.value=w),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:U,onInput:U},null,8,["modelValue"]),l("div",Il,[e(E,{type:"primary",onClick:q},{default:t(()=>[...s[30]||(s[30]=[y("添加账号",-1)])]),_:1}),e(E,{type:"info",onClick:s[9]||(s[9]=()=>i(!0))},{default:t(()=>[e(h,{class:de({"is-loading":j(d).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(j(re))]),_:1},8,["class"]),l("span",zl,B(j(d).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),c.value.length>0?(f(),A("div",El,[e(ie,{data:c.value,style:{width:"100%"}},{default:t(()=>[e(g,{label:"头像",width:"80"},{default:t(w=>[e(Q,{src:w.row.avatar,size:40},null,8,["src"])]),_:1}),e(g,{prop:"name",label:"名称",width:"180"}),e(g,{prop:"platform",label:"平台"},{default:t(w=>[e(ae,{type:r(w.row.platform),effect:"plain"},{default:t(()=>[y(B(w.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"status",label:"状态"},{default:t(w=>[e(ae,{type:w.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[y(B(w.row.status),1)]),_:2},1032,["type"])]),_:1}),e(g,{label:"操作"},{default:t(w=>[w.row.status!=="正常"?(f(),X(E,{key:0,size:"small",type:"warning",onClick:ne=>N(w.row)},{default:t(()=>[...s[31]||(s[31]=[y("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(E,{size:"small",type:"danger",onClick:ne=>K(w.row)},{default:t(()=>[...s[32]||(s[32]=[y("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(f(),A("div",Bl,[e(te,{description:"暂无小红书账号数据"})]))])]),_:1}),e(ue,{label:"B站",name:"bilibili"},{default:t(()=>[l("div",Fl,[l("div",Rl,[e(H,{modelValue:o.value,"onUpdate:modelValue":s[10]||(s[10]=w=>o.value=w),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:U,onInput:U},null,8,["modelValue"]),l("div",Ol,[e(E,{type:"primary",onClick:q},{default:t(()=>[...s[33]||(s[33]=[y("添加账号",-1)])]),_:1}),e(E,{type:"info",onClick:s[11]||(s[11]=()=>i(!0))},{default:t(()=>[e(h,{class:de({"is-loading":j(d).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(j(re))]),_:1},8,["class"]),l("span",ql,B(j(d).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),O.value.length>0?(f(),A("div",Kl,[e(ie,{data:O.value,style:{width:"100%"}},{default:t(()=>[e(g,{label:"头像",width:"80"},{default:t(w=>[e(Q,{src:w.row.avatar,size:40},null,8,["src"])]),_:1}),e(g,{prop:"name",label:"名称",width:"180"}),e(g,{prop:"platform",label:"平台"},{default:t(w=>[e(ae,{type:r(w.row.platform),effect:"plain"},{default:t(()=>[y(B(w.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"status",label:"状态"},{default:t(w=>[e(ae,{type:w.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[y(B(w.row.status),1)]),_:2},1032,["type"])]),_:1}),e(g,{label:"操作"},{default:t(w=>[w.row.status!=="正常"?(f(),X(E,{key:0,size:"small",type:"warning",onClick:ne=>N(w.row)},{default:t(()=>[...s[34]||(s[34]=[y("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(E,{size:"small",type:"danger",onClick:ne=>K(w.row)},{default:t(()=>[...s[35]||(s[35]=[y("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(f(),A("div",Hl,[e(te,{description:"暂无B站账号数据"})]))])]),_:1})]),_:1},8,["modelValue"])]),e(qe,{modelValue:n.value,"onUpdate:modelValue":s[16]||(s[16]=w=>n.value=w),title:S.value==="add"?"添加账号":"编辑账号",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!F.value,"show-close":!F.value},{footer:t(()=>[l("span",Jl,[e(E,{onClick:s[15]||(s[15]=w=>n.value=!1)},{default:t(()=>[...s[40]||(s[40]=[y("取消",-1)])]),_:1}),e(E,{type:"primary",onClick:z,loading:F.value,disabled:F.value},{default:t(()=>[y(B(F.value?"请求中":"确认"),1)]),_:1},8,["loading","disabled"])])]),default:t(()=>[e(Oe,{model:m,"label-width":"80px",rules:W,ref_key:"accountFormRef",ref:_},{default:t(()=>[e(Me,{label:"平台",prop:"platform"},{default:t(()=>[e(Re,{modelValue:m.platform,"onUpdate:modelValue":s[13]||(s[13]=w=>m.platform=w),placeholder:"请选择平台",style:{width:"100%"},disabled:S.value==="edit"||F.value},{default:t(()=>[e(ge,{label:"快手",value:"快手"}),e(ge,{label:"抖音",value:"抖音"}),e(ge,{label:"视频号",value:"视频号"}),e(ge,{label:"小红书",value:"小红书"}),e(ge,{label:"B站",value:"B站"})]),_:1},8,["modelValue","disabled"])]),_:1}),e(Me,{label:"名称",prop:"name"},{default:t(()=>[e(H,{modelValue:m.name,"onUpdate:modelValue":s[14]||(s[14]=w=>m.name=w),placeholder:"请输入账号名称",disabled:F.value},null,8,["modelValue","disabled"])]),_:1}),F.value?(f(),A("div",Nl,[k.value&&!b.value?(f(),A("div",jl,[s[36]||(s[36]=l("p",{class:"qrcode-tip"},"请使用对应平台APP扫描二维码登录",-1)),l("img",{src:k.value,alt:"登录二维码",class:"qrcode-image"},null,8,Wl)])):!k.value&&!b.value?(f(),A("div",Yl,[e(h,{class:"is-loading"},{default:t(()=>[e(j(re))]),_:1}),s[37]||(s[37]=l("span",null,"请求中...",-1))])):b.value==="200"?(f(),A("div",Gl,[e(h,null,{default:t(()=>[e(j(dt))]),_:1}),s[38]||(s[38]=l("span",null,"添加成功",-1))])):b.value==="500"?(f(),A("div",Xl,[e(h,null,{default:t(()=>[e(j(ut))]),_:1}),s[39]||(s[39]=l("span",null,"添加失败，请稍后再试",-1))])):Y("",!0)])):Y("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title","close-on-press-escape","show-close"])])),[[Ke,j(d).isAccountRefreshing]])}}},Zl=ee(Ql,[["__scopeId","data-v-679b7766"]]),pe={getAllMaterials:()=>ce.get("/getFiles"),uploadMaterial:a=>ce.upload("/uploadSave",a),deleteMaterial:a=>ce.get(`/deleteFile?id=${a}`),downloadMaterial:a=>`http://localhost:5409/download/${a}`,getMaterialPreviewUrl:a=>`http://localhost:5409/getFile?filename=${a}`},ea={class:"material-management"},ta={class:"material-list-container"},la={class:"material-search"},aa={class:"action-buttons"},sa={key:0},oa={key:0,class:"material-list"},na={key:1,class:"empty-data"},ia={class:"upload-form"},da={class:"dialog-footer"},ua={key:0,class:"preview-container"},ra={key:0,class:"video-preview"},ca={controls:"",style:{"max-width":"100%","max-height":"60vh"}},pa=["src"],ma={key:1,class:"image-preview"},fa=["src"],va={key:2,class:"file-info"},_a={__name:"MaterialManagement",setup(a){const u=xe(),d=R(""),p=R(!1),o=R(!1),i=R(!1),r=R(!1),$=R(null),T=R([]),L=R(""),M=async()=>{p.value=!0;try{const k=await pe.getAllMaterials();k.code===200?(u.setMaterials(k.data),P.success("刷新成功")):P.error("获取素材列表失败")}catch(k){console.error("获取素材列表出错:",k),P.error("获取素材列表失败")}finally{p.value=!1}},I=J(()=>{if(!d.value)return u.materials;const k=d.value.toLowerCase();return u.materials.filter(b=>b.filename.toLowerCase().includes(k))}),V=()=>{},x=()=>{T.value=[],L.value="",i.value=!0},c=()=>{T.value=[],L.value=""},O=(k,b)=>{console.log("选择的文件:",k),k.raw&&(T.value=[k])},U=async()=>{if(T.value.length===0){P.warning("请选择要上传的文件");return}const k=T.value[0];if(!k||!k.raw){P.warning("文件对象无效，请重新选择文件");return}o.value=!0;try{const b=new FormData;console.log("上传文件对象:",k.raw),b.append("file",k.raw),L.value.trim()&&(b.append("filename",L.value.trim()),console.log("自定义文件名:",L.value.trim()));const q=await pe.uploadMaterial(b);q.code===200?(P.success("上传成功"),i.value=!1,await M()):P.error(q.msg||"上传失败")}catch(b){console.error("上传素材出错:",b),P.error("上传失败: "+(b.message||"未知错误"))}finally{o.value=!1}},n=async k=>{$.value=null,r.value=!0,P.info("加载中...");try{await new Promise(b=>setTimeout(b,100)),$.value=k}catch(b){console.error("预览素材出错:",b),P.error("预览加载失败"),r.value=!1}},S=k=>{ye.confirm(`确定要删除素材 ${k.filename} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const b=await pe.deleteMaterial(k.id);b.code===200?(u.removeMaterial(k.id),P.success("删除成功")):P.error(b.msg||"删除失败")}catch(b){console.error("删除素材出错:",b),P.error("删除失败")}}).catch(()=>{})},_=k=>{const b=k.split("/").pop();return pe.getMaterialPreviewUrl(b)},m=k=>{const b=pe.downloadMaterial(k.file_path);window.open(b,"_blank")},W=k=>[".mp4",".avi",".mov",".wmv",".flv",".mkv"].some(q=>k.toLowerCase().endsWith(q)),F=k=>[".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(q=>k.toLowerCase().endsWith(q));return Te(()=>{u.materials.length===0&&M()}),(k,b)=>{const q=v("el-input"),K=v("el-button"),G=v("el-icon"),Z=v("el-table-column"),C=v("el-table"),z=v("el-empty"),N=v("el-form-item"),D=v("el-upload"),s=v("el-form"),H=v("el-dialog");return f(),A("div",ea,[b[14]||(b[14]=l("div",{class:"page-header"},[l("h1",null,"素材管理")],-1)),l("div",ta,[l("div",la,[e(q,{modelValue:d.value,"onUpdate:modelValue":b[0]||(b[0]=E=>d.value=E),placeholder:"输入文件名搜索","prefix-icon":"Search",clearable:"",onClear:V,onInput:V},null,8,["modelValue"]),l("div",aa,[e(K,{type:"primary",onClick:x},{default:t(()=>[...b[6]||(b[6]=[y("上传素材",-1)])]),_:1}),e(K,{type:"info",onClick:M,loading:!1},{default:t(()=>[e(G,{class:de({"is-loading":p.value})},{default:t(()=>[e(j(re))]),_:1},8,["class"]),p.value?(f(),A("span",sa,"刷新中")):Y("",!0)]),_:1})])]),I.value.length>0?(f(),A("div",oa,[e(C,{data:I.value,style:{width:"100%"}},{default:t(()=>[e(Z,{prop:"filename",label:"文件名",width:"300"}),e(Z,{prop:"filesize",label:"文件大小",width:"120"},{default:t(E=>[y(B(E.row.filesize)+" MB ",1)]),_:1}),e(Z,{prop:"upload_time",label:"上传时间",width:"180"}),e(Z,{label:"操作"},{default:t(E=>[e(K,{size:"small",onClick:h=>n(E.row)},{default:t(()=>[...b[7]||(b[7]=[y("预览",-1)])]),_:1},8,["onClick"]),e(K,{size:"small",type:"danger",onClick:h=>S(E.row)},{default:t(()=>[...b[8]||(b[8]=[y("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(f(),A("div",na,[e(z,{description:"暂无素材数据"})]))]),e(H,{modelValue:i.value,"onUpdate:modelValue":b[3]||(b[3]=E=>i.value=E),title:"上传素材",width:"40%",onClose:c},{footer:t(()=>[l("div",da,[e(K,{onClick:b[2]||(b[2]=E=>i.value=!1)},{default:t(()=>[...b[11]||(b[11]=[y("取消",-1)])]),_:1}),e(K,{type:"primary",onClick:U,loading:o.value},{default:t(()=>[y(B(o.value?"上传中":"确认上传"),1)]),_:1},8,["loading"])])]),default:t(()=>[l("div",ia,[e(s,{"label-width":"80px"},{default:t(()=>[e(N,{label:"文件名称:"},{default:t(()=>[e(q,{modelValue:L.value,"onUpdate:modelValue":b[1]||(b[1]=E=>L.value=E),placeholder:"选填",clearable:""},null,8,["modelValue"])]),_:1}),e(N,{label:"选择文件"},{default:t(()=>[e(D,{class:"upload-demo",drag:"","auto-upload":!1,"on-change":O,"file-list":T.value,limit:1},{tip:t(()=>[...b[9]||(b[9]=[l("div",{class:"el-upload__tip"}," 支持视频、图片等格式文件，只能上传一个文件 ",-1)])]),default:t(()=>[e(G,{class:"el-icon--upload"},{default:t(()=>[e(j(_e))]),_:1}),b[10]||(b[10]=l("div",{class:"el-upload__text"},[y(" 将文件拖到此处，或"),l("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1})]),_:1})])]),_:1},8,["modelValue"]),e(H,{modelValue:r.value,"onUpdate:modelValue":b[5]||(b[5]=E=>r.value=E),title:"素材预览",width:"50%",top:"10vh"},{default:t(()=>[$.value?(f(),A("div",ua,[W($.value.filename)?(f(),A("div",ra,[l("video",ca,[l("source",{src:_($.value.file_path),type:"video/mp4"},null,8,pa),b[12]||(b[12]=y(" 您的浏览器不支持视频播放 ",-1))])])):F($.value.filename)?(f(),A("div",ma,[l("img",{src:_($.value.file_path),style:{"max-width":"100%","max-height":"60vh"}},null,8,fa)])):(f(),A("div",va,[l("p",null,"文件名: "+B($.value.filename),1),l("p",null,"文件大小: "+B($.value.filesize)+" MB",1),l("p",null,"上传时间: "+B($.value.upload_time),1),e(K,{type:"primary",onClick:b[4]||(b[4]=E=>m($.value))},{default:t(()=>[...b[13]||(b[13]=[y("下载文件",-1)])]),_:1})]))])):Y("",!0)]),_:1},8,["modelValue"])])}}},ga=ee(_a,[["__scopeId","data-v-3d75da5e"]]),ya={class:"cover-generator"},ha={class:"panel"},ba={key:0,class:"file-name"},wa={class:"size-row"},$a={class:"preview"},Va=["width","height"],ka={__name:"CoverGenerator",setup(a){const u=R(`示例标题：AI 自动化运营系统
高点击封面生成`),d=R(1280),p=R(720),o=R(100),i=R("#ff6f91"),r=R("#ffffff"),$=R(12),T=R(12),L=R(null),M=R(null),I=R("");function V(U){const n=U.raw||U;if(!n)return;I.value=n.name;const S=new FileReader;S.onload=()=>{const _=new Image;_.onload=()=>{M.value=_,c()},_.src=S.result},S.readAsDataURL(n)}function x(U,n){const S=U.replace(/\r/g,"").split(/\n|\s+/),_=[];let m="";for(const W of S)W!==""&&((m+(m?" ":"")+W).length<=n?m=m?m+" "+W:W:(m&&_.push(m),m=W));return m&&_.push(m),_}function c(){const U=L.value;if(!U)return;const n=U.getContext("2d");if(M.value){const F=M.value,k=F.width,b=F.height,q=U.width,K=U.height,G=k/b,Z=q/K;let C=0,z=0,N=k,D=b;G>Z?(N=b*Z,C=(k-N)/2):(D=k/Z,z=(b-D)/2),n.drawImage(F,C,z,N,D,0,0,q,K)}else n.fillStyle="#111827",n.fillRect(0,0,U.width,U.height);n.textBaseline="top",n.textAlign="left",n.font=`bold ${o.value}px "Microsoft YaHei UI", "PingFang SC", Arial`;const S=x(u.value,T.value),m=S.map(F=>o.value).reduce((F,k)=>F+k,0)+(S.length-1)*20;let W=(U.height-m)/2;for(const F of S){const b=n.measureText(F).width,q=(U.width-b)/2;$.value>0&&(n.lineJoin="round",n.miterLimit=2,n.lineWidth=$.value,n.strokeStyle=r.value,n.strokeText(F,q,W)),n.fillStyle=i.value,n.fillText(F,q,W),W+=o.value+20}}function O(){const U=L.value;if(!U)return;const n=document.createElement("a");n.download="cover.png",n.href=U.toDataURL("image/png"),n.click()}return Te(()=>{c()}),Le([u,d,p,o,i,r,$,T],()=>{c()}),(U,n)=>{const S=v("el-input"),_=v("el-form-item"),m=v("el-button"),W=v("el-upload"),F=v("el-input-number"),k=v("el-slider"),b=v("el-color-picker"),q=v("el-form");return f(),A("div",ya,[n[12]||(n[12]=l("div",{class:"page-header"},[l("h1",null,"封面生成")],-1)),l("div",ha,[e(q,{"label-width":"90px",class:"controls"},{default:t(()=>[e(_,{label:"标题文本"},{default:t(()=>[e(S,{modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=K=>u.value=K),type:"textarea",rows:3,placeholder:"输入封面标题，支持换行"},null,8,["modelValue"])]),_:1}),e(_,{label:"背景图片"},{default:t(()=>[e(W,{"auto-upload":!1,accept:"image/*","show-file-list":!1,"on-change":V},{default:t(()=>[e(m,null,{default:t(()=>[...n[8]||(n[8]=[y("选择图片",-1)])]),_:1})]),_:1}),I.value?(f(),A("span",ba,B(I.value),1)):Y("",!0)]),_:1}),e(_,{label:"画布尺寸"},{default:t(()=>[l("div",wa,[e(F,{modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=K=>d.value=K),min:320,max:4096},null,8,["modelValue"]),n[9]||(n[9]=l("span",{class:"x"},"×",-1)),e(F,{modelValue:p.value,"onUpdate:modelValue":n[2]||(n[2]=K=>p.value=K),min:320,max:4096},null,8,["modelValue"])])]),_:1}),e(_,{label:"字体大小"},{default:t(()=>[e(k,{modelValue:o.value,"onUpdate:modelValue":n[3]||(n[3]=K=>o.value=K),min:24,max:200,step:2,style:{width:"240px"}},null,8,["modelValue"])]),_:1}),e(_,{label:"主色"},{default:t(()=>[e(b,{modelValue:i.value,"onUpdate:modelValue":n[4]||(n[4]=K=>i.value=K)},null,8,["modelValue"])]),_:1}),e(_,{label:"描边色"},{default:t(()=>[e(b,{modelValue:r.value,"onUpdate:modelValue":n[5]||(n[5]=K=>r.value=K)},null,8,["modelValue"])]),_:1}),e(_,{label:"描边宽度"},{default:t(()=>[e(k,{modelValue:$.value,"onUpdate:modelValue":n[6]||(n[6]=K=>$.value=K),min:0,max:30,step:1,style:{width:"240px"}},null,8,["modelValue"])]),_:1}),e(_,{label:"每行字数"},{default:t(()=>[e(F,{modelValue:T.value,"onUpdate:modelValue":n[7]||(n[7]=K=>T.value=K),min:6,max:32},null,8,["modelValue"])]),_:1}),e(_,null,{default:t(()=>[e(m,{type:"primary",onClick:c},{default:t(()=>[...n[10]||(n[10]=[y("生成预览",-1)])]),_:1}),e(m,{type:"success",onClick:O},{default:t(()=>[...n[11]||(n[11]=[y("下载PNG",-1)])]),_:1})]),_:1})]),_:1}),l("div",$a,[l("canvas",{ref_key:"canvasRef",ref:L,width:d.value,height:p.value},null,8,Va)])])])}}},Ca=ee(ka,[["__scopeId","data-v-87a33854"]]),Ce={DOUYIN:{key:3,name:"抖音",titleLimit:30,topicLimit:5,titlePlaceholder:"请输入标题（最多30字）",topicPlaceholder:"最多可添加5个话题"},KUAISHOU:{key:4,name:"快手",titleLimit:30,topicLimit:3,titlePlaceholder:"请输入标题（最多30字）",topicPlaceholder:"最多可添加3个话题"},WEIXIN:{key:2,name:"视频号",titleLimit:16,topicLimit:20,titlePlaceholder:"请输入标题（最多16字）",topicPlaceholder:"最多可添加20个话题"},XIAOHONGSHU:{key:1,name:"小红书",titleLimit:20,topicLimit:10,titlePlaceholder:"请输入标题（最多20字）",topicPlaceholder:"最多可添加10个话题"}};Ce.BILIBILI={key:5,name:"B站",titleLimit:80,topicLimit:10,titlePlaceholder:"请输入标题（最多80字）",topicPlaceholder:"最多可添加10个话题"};function he(a){return Object.values(Ce).find(u=>u.key===a)||Ce.XIAOHONGSHU}function Ta(){return Object.values(Ce)}function Ue(a,u){const d=he(u);return!a||!a.trim()?{valid:!1,message:"请输入标题"}:a.length>d.titleLimit?{valid:!1,message:`标题不能超过${d.titleLimit}字，当前${a.length}字`}:{valid:!0,message:""}}function Pe(a,u){const d=he(u);return Array.isArray(a)?a.length>d.topicLimit?{valid:!1,message:`最多只能添加${d.topicLimit}个话题，当前${a.length}个`}:{valid:!0,message:""}:{valid:!1,message:"话题格式错误"}}function xa(a){return!a||!a.trim()?{valid:!1,message:"话题内容不能为空"}:a.length>20?{valid:!1,message:"单个话题不能超过20字"}:/[<>{}[\]()&$#@!%^*+=|\\/]/g.test(a)?{valid:!1,message:"话题不能包含特殊字符"}:{valid:!0,message:""}}function Aa(a){const u={};let d=!0;(!a.fileList||a.fileList.length===0)&&(u.fileList="请先上传视频文件",d=!1);const p=Ue(a.title,a.selectedPlatform);p.valid||(u.title=p.message,d=!1),a.selectedPlatform||(u.platform="请选择发布平台",d=!1),(!a.selectedAccounts||a.selectedAccounts.length===0)&&(u.accounts="请选择发布账号",d=!1);const o=Pe(a.selectedTopics,a.selectedPlatform);return o.valid||(u.topics=o.message,d=!1),a.scheduleEnabled&&((!a.videosPerDay||a.videosPerDay<1||a.videosPerDay>55)&&(u.videosPerDay="每天发布视频数必须在1-55之间",d=!1),(!a.dailyTimes||a.dailyTimes.length===0)&&(u.dailyTimes="请设置发布时间",d=!1),a.dailyTimes&&a.dailyTimes.length!==a.videosPerDay&&(u.dailyTimes="发布时间数量必须与每天发布视频数一致",d=!1),(a.startDays===void 0||a.startDays<0)&&(u.startDays="请选择开始天数",d=!1)),{valid:d,errors:u}}const Ua={class:"tab-management"},Pa={class:"tab-header"},Sa={class:"tab-list"},Ma=["onClick"],Da={class:"tab-actions"},La={__name:"TabManagement",props:{tabs:{type:Array,required:!0},activeTab:{type:String,required:!0},batchPublishing:{type:Boolean,default:!1}},emits:["tab-change","remove-tab","add-tab","batch-publish"],setup(a){return(u,d)=>{const p=v("el-icon"),o=v("el-button");return f(),A("div",Ua,[l("div",Pa,[l("div",Sa,[(f(!0),A(se,null,oe(a.tabs,i=>(f(),A("div",{key:i.name,class:de(["tab-item",{active:a.activeTab===i.name}]),onClick:r=>u.$emit("tab-change",i.name)},[l("span",null,B(i.label),1),a.tabs.length>1?(f(),X(p,{key:0,class:"close-icon",onClick:Ye(r=>u.$emit("remove-tab",i.name),["stop"])},{default:t(()=>[e(j(Be))]),_:1},8,["onClick"])):Y("",!0)],10,Ma))),128))]),l("div",Da,[e(o,{type:"primary",size:"small",onClick:d[0]||(d[0]=i=>u.$emit("add-tab")),class:"add-tab-btn"},{default:t(()=>[e(p,null,{default:t(()=>[e(j(rt))]),_:1}),d[2]||(d[2]=y(" 添加Tab ",-1))]),_:1}),e(o,{type:"success",size:"small",onClick:d[1]||(d[1]=i=>u.$emit("batch-publish")),loading:a.batchPublishing,class:"batch-publish-btn"},{default:t(()=>[...d[3]||(d[3]=[y(" 批量发布 ",-1)])]),_:1},8,["loading"])])])])}}},Ia=ee(La,[["__scopeId","data-v-7584dadb"]]),za={class:"upload-section"},Ea={class:"upload-options"},Ba={key:0,class:"uploaded-files"},Fa={class:"file-list"},Ra={class:"file-size"},Oa={class:"upload-options-content"},qa={class:"material-library-content"},Ka={class:"material-list"},Ha={class:"material-info"},Na={class:"material-name"},ja={class:"material-details"},Wa={class:"file-size"},Ya={class:"upload-time"},Ga={class:"dialog-footer"},Xa={__name:"VideoUpload",props:{fileList:{type:Array,default:()=>[]},uploadAction:{type:String,required:!0},authHeaders:{type:Object,required:!0},materials:{type:Array,default:()=>[]}},emits:["show-upload-options","remove-file","upload-success","material-selected"],setup(a,{expose:u,emit:d}){const p=a,o=d,i=xe(),r=R(!1),$=R(!1),T=R(!1),L=R([]),M=()=>{r.value=!1,$.value=!0},I=async()=>{if(r.value=!1,p.materials.length===0)try{const U=await pe.getAllMaterials();if(U.code===200)i.setMaterials(U.data);else{P.error("获取素材列表失败");return}}catch(U){console.error("获取素材列表出错:",U),P.error("获取素材列表失败");return}L.value=[],T.value=!0},V=(U,n)=>{U.code===200?(o("upload-success",U,n),$.value=!1,P.success("文件上传成功")):P.error(U.msg||"上传失败")},x=U=>{P.error("文件上传失败"),console.error("上传错误:",U)},c=()=>{if(L.value.length===0){P.warning("请选择至少一个素材");return}o("material-selected",L.value);const U=L.value.length;T.value=!1,L.value=[],P.success(`已添加 ${U} 个素材`)},O=()=>{r.value=!0};return u({showUploadOptions:O}),(U,n)=>{const S=v("el-icon"),_=v("el-button"),m=v("el-link"),W=v("el-dialog"),F=v("el-upload"),k=v("el-checkbox"),b=v("el-checkbox-group");return f(),A("div",za,[n[14]||(n[14]=l("h3",null,"视频",-1)),l("div",Ea,[e(_,{type:"primary",onClick:O,class:"upload-btn"},{default:t(()=>[e(S,null,{default:t(()=>[e(j(_e))]),_:1}),n[5]||(n[5]=y(" 上传视频 ",-1))]),_:1})]),a.fileList.length>0?(f(),A("div",Ba,[n[7]||(n[7]=l("h4",null,"已上传文件：",-1)),l("div",Fa,[(f(!0),A(se,null,oe(a.fileList,(q,K)=>(f(),A("div",{key:K,class:"file-item"},[e(m,{href:q.url,target:"_blank",type:"primary"},{default:t(()=>[y(B(q.name),1)]),_:2},1032,["href"]),l("span",Ra,B((q.size/1024/1024).toFixed(2))+"MB",1),e(_,{type:"danger",size:"small",onClick:G=>U.$emit("remove-file",K)},{default:t(()=>[...n[6]||(n[6]=[y("删除",-1)])]),_:1},8,["onClick"])]))),128))])])):Y("",!0),e(W,{modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=q=>r.value=q),title:"选择上传方式",width:"400px",class:"upload-options-dialog"},{default:t(()=>[l("div",Oa,[e(_,{type:"primary",onClick:M,class:"option-btn"},{default:t(()=>[e(S,null,{default:t(()=>[e(j(_e))]),_:1}),n[8]||(n[8]=y(" 本地上传 ",-1))]),_:1}),e(_,{type:"success",onClick:I,class:"option-btn"},{default:t(()=>[e(S,null,{default:t(()=>[e(j(ct))]),_:1}),n[9]||(n[9]=y(" 素材库 ",-1))]),_:1})])]),_:1},8,["modelValue"]),e(W,{modelValue:$.value,"onUpdate:modelValue":n[1]||(n[1]=q=>$.value=q),title:"本地上传",width:"600px",class:"local-upload-dialog"},{default:t(()=>[e(F,{class:"video-upload",drag:"","auto-upload":!0,action:a.uploadAction,"on-success":V,"on-error":x,multiple:"",accept:"video/*",headers:a.authHeaders},{tip:t(()=>[...n[10]||(n[10]=[l("div",{class:"el-upload__tip"}," 支持MP4、AVI等视频格式，可上传多个文件 ",-1)])]),default:t(()=>[e(S,{class:"el-icon--upload"},{default:t(()=>[e(j(_e))]),_:1}),n[11]||(n[11]=l("div",{class:"el-upload__text"},[y(" 将视频文件拖到此处，或"),l("em",null,"点击上传")],-1))]),_:1},8,["action","headers"])]),_:1},8,["modelValue"]),e(W,{modelValue:T.value,"onUpdate:modelValue":n[4]||(n[4]=q=>T.value=q),title:"选择素材",width:"800px",class:"material-library-dialog"},{footer:t(()=>[l("div",Ga,[e(_,{onClick:n[3]||(n[3]=q=>T.value=!1)},{default:t(()=>[...n[12]||(n[12]=[y("取消",-1)])]),_:1}),e(_,{type:"primary",onClick:c},{default:t(()=>[...n[13]||(n[13]=[y("确定",-1)])]),_:1})])]),default:t(()=>[l("div",qa,[e(b,{modelValue:L.value,"onUpdate:modelValue":n[2]||(n[2]=q=>L.value=q)},{default:t(()=>[l("div",Ka,[(f(!0),A(se,null,oe(a.materials,q=>(f(),A("div",{key:q.id,class:"material-item"},[e(k,{label:q.id,class:"material-checkbox"},{default:t(()=>[l("div",Ha,[l("div",Na,B(q.filename),1),l("div",ja,[l("span",Wa,B(q.filesize)+"MB",1),l("span",Ya,B(q.upload_time),1)])])]),_:2},1032,["label"])]))),128))])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}},Ja=ee(Xa,[["__scopeId","data-v-a4989d91"]]),Qa={class:"platform-section"},Za={key:0,class:"platform-tips"},es={__name:"PlatformSelection",props:{modelValue:{type:Number,required:!0}},emits:["update:modelValue","platform-change"],setup(a,{emit:u}){const d=a,p=u,o=Ta(),i=J({get:()=>d.modelValue,set:T=>p("update:modelValue",T)}),r=J(()=>he(d.modelValue)),$=T=>{p("platform-change",T)};return(T,L)=>{const M=v("el-radio"),I=v("el-radio-group"),V=v("el-alert");return f(),A("div",Qa,[L[1]||(L[1]=l("h3",null,"平台",-1)),e(I,{modelValue:i.value,"onUpdate:modelValue":L[0]||(L[0]=x=>i.value=x),onChange:$,class:"platform-radios"},{default:t(()=>[(f(!0),A(se,null,oe(j(o),x=>(f(),X(M,{key:x.key,label:x.key,class:"platform-radio"},{default:t(()=>[y(B(x.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),r.value?(f(),A("div",Za,[e(V,{title:`${r.value.name}平台限制：标题最多${r.value.titleLimit}字，话题最多${r.value.topicLimit}个`,type:"info",closable:!1,"show-icon":"",class:"platform-alert"},null,8,["title"])])):Y("",!0)])}}},ts=ee(es,[["__scopeId","data-v-4ae792d5"]]),ls={class:"account-section"},as={class:"account-display"},ss={class:"selected-accounts"},os={class:"account-dialog-content"},ns={class:"account-list"},is={class:"account-info"},ds={class:"account-name"},us={class:"dialog-footer"},rs={__name:"AccountSelection",props:{modelValue:{type:Array,default:()=>[]},platformKey:{type:Number,required:!0}},emits:["update:modelValue"],setup(a,{emit:u}){const d=a,p=u,o=Se(),i=J({get:()=>d.modelValue,set:x=>p("update:modelValue",x)}),r=R(!1),$=R([]),T=J(()=>{const c={3:"抖音",2:"视频号",1:"小红书",4:"快手",5:"B站"}[d.platformKey];return c?o.accounts.filter(O=>O.platform===c):[]}),L=()=>{$.value=[...i.value],r.value=!0},M=()=>{i.value=[...$.value],r.value=!1,P.success("账号选择完成")},I=x=>{i.value.splice(x,1)},V=x=>{const c=o.accounts.find(O=>O.id===x);return c?c.name:x};return(x,c)=>{const O=v("el-tag"),U=v("el-button"),n=v("el-checkbox"),S=v("el-checkbox-group"),_=v("el-dialog");return f(),A("div",ls,[c[6]||(c[6]=l("h3",null,"账号",-1)),l("div",as,[l("div",ss,[(f(!0),A(se,null,oe(i.value,(m,W)=>(f(),X(O,{key:W,closable:"",onClose:F=>I(W),class:"account-tag"},{default:t(()=>[y(B(V(m)),1)]),_:2},1032,["onClose"]))),128))]),e(U,{type:"primary",plain:"",onClick:L,class:"select-account-btn"},{default:t(()=>[...c[3]||(c[3]=[y(" 选择账号 ",-1)])]),_:1})]),e(_,{modelValue:r.value,"onUpdate:modelValue":c[2]||(c[2]=m=>r.value=m),title:"选择账号",width:"600px",class:"account-dialog"},{footer:t(()=>[l("div",us,[e(U,{onClick:c[1]||(c[1]=m=>r.value=!1)},{default:t(()=>[...c[4]||(c[4]=[y("取消",-1)])]),_:1}),e(U,{type:"primary",onClick:M},{default:t(()=>[...c[5]||(c[5]=[y("确定",-1)])]),_:1})])]),default:t(()=>[l("div",os,[e(S,{modelValue:$.value,"onUpdate:modelValue":c[0]||(c[0]=m=>$.value=m)},{default:t(()=>[l("div",ns,[(f(!0),A(se,null,oe(T.value,m=>(f(),X(n,{key:m.id,label:m.id,class:"account-item"},{default:t(()=>[l("div",is,[l("span",ds,B(m.name),1)])]),_:2},1032,["label"]))),128))])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}},cs=ee(rs,[["__scopeId","data-v-6501bc5d"]]),ps={class:"schedule-section"},ms={class:"schedule-controls"},fs={key:0,class:"schedule-settings"},vs={class:"schedule-item"},_s={class:"schedule-item"},gs={class:"time-selectors"},ys={class:"schedule-item"},hs={__name:"ScheduleSettings",props:{scheduleEnabled:{type:Boolean,default:!1},videosPerDay:{type:Number,default:1},dailyTimes:{type:Array,default:()=>["10:00"]},startDays:{type:Number,default:0}},emits:["update:scheduleEnabled","update:videosPerDay","update:dailyTimes","update:startDays"],setup(a,{emit:u}){const d=a,p=u,o=J({get:()=>d.scheduleEnabled,set:M=>p("update:scheduleEnabled",M)}),i=J({get:()=>d.videosPerDay,set:M=>p("update:videosPerDay",M)}),r=J({get:()=>d.dailyTimes,set:M=>p("update:dailyTimes",M)}),$=J({get:()=>d.startDays,set:M=>p("update:startDays",M)}),T=M=>{M||(p("update:videosPerDay",1),p("update:dailyTimes",["10:00"]),p("update:startDays",0))},L=()=>{if(r.value.length<i.value){const M=[...r.value,"10:00"];p("update:dailyTimes",M)}};return(M,I)=>{const V=v("el-switch"),x=v("el-option"),c=v("el-select"),O=v("el-time-select"),U=v("el-button");return f(),A("div",ps,[I[7]||(I[7]=l("h3",null,"定时发布",-1)),l("div",ms,[e(V,{modelValue:o.value,"onUpdate:modelValue":I[0]||(I[0]=n=>o.value=n),"active-text":"定时发布","inactive-text":"立即发布",onChange:T},null,8,["modelValue"]),o.value?(f(),A("div",fs,[l("div",vs,[I[3]||(I[3]=l("span",{class:"label"},"每天发布视频数：",-1)),e(c,{modelValue:i.value,"onUpdate:modelValue":I[1]||(I[1]=n=>i.value=n),placeholder:"选择发布数量"},{default:t(()=>[(f(),A(se,null,oe(55,n=>e(x,{key:n,label:n,value:n},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),l("div",_s,[I[5]||(I[5]=l("span",{class:"label"},"每天发布时间：",-1)),l("div",gs,[(f(!0),A(se,null,oe(r.value,(n,S)=>(f(),X(O,{key:S,modelValue:r.value[S],"onUpdate:modelValue":_=>r.value[S]=_,start:"00:00",step:"00:30",end:"23:30",placeholder:"选择时间"},null,8,["modelValue","onUpdate:modelValue"]))),128)),r.value.length<i.value?(f(),X(U,{key:0,type:"primary",size:"small",onClick:L},{default:t(()=>[...I[4]||(I[4]=[y(" 添加时间 ",-1)])]),_:1})):Y("",!0)])]),l("div",ys,[I[6]||(I[6]=l("span",{class:"label"},"开始天数：",-1)),e(c,{modelValue:$.value,"onUpdate:modelValue":I[2]||(I[2]=n=>$.value=n),placeholder:"选择开始天数"},{default:t(()=>[e(x,{label:"明天",value:0}),e(x,{label:"后天",value:1})]),_:1},8,["modelValue"])])])):Y("",!0)])])}}},bs=ee(hs,[["__scopeId","data-v-7e1e15aa"]]),ws={class:"title-section"},$s={key:0,class:"error-message"},Vs={__name:"TitleInput",props:{modelValue:{type:String,default:""},platformKey:{type:Number,required:!0},validateOnInput:{type:Boolean,default:!0}},emits:["update:modelValue","validation-change"],setup(a,{expose:u,emit:d}){const p=a,o=d,i=J(()=>he(p.platformKey)),r=J({get:()=>p.modelValue,set:V=>o("update:modelValue",V)}),$=J(()=>i.value.titlePlaceholder),T=J(()=>i.value.titleLimit),L=R(""),M=V=>{if(p.validateOnInput){const x=Ue(V,p.platformKey);L.value=x.valid?"":x.message,o("validation-change",x)}};return u({validate:()=>{const V=Ue(p.modelValue,p.platformKey);return L.value=V.valid?"":V.message,o("validation-change",V),V}}),(V,x)=>{const c=v("el-input"),O=v("el-alert");return f(),A("div",ws,[x[1]||(x[1]=l("h3",null,"标题",-1)),e(c,{modelValue:r.value,"onUpdate:modelValue":x[0]||(x[0]=U=>r.value=U),type:"textarea",rows:3,placeholder:$.value,maxlength:T.value,"show-word-limit":"",class:"title-input",onInput:M},null,8,["modelValue","placeholder","maxlength"]),L.value?(f(),A("div",$s,[e(O,{title:L.value,type:"error",closable:!1,"show-icon":"",class:"error-alert"},null,8,["title"])])):Y("",!0)])}}},be=ee(Vs,[["__scopeId","data-v-f75530ea"]]),ks={class:"topic-section"},Cs={class:"topic-display"},Ts={class:"selected-topics"},xs={key:0,class:"topic-tips"},As={key:1,class:"error-message"},Us={class:"topic-dialog-content"},Ps={class:"custom-topic-input"},Ss={class:"recommended-topics"},Ms={class:"topic-grid"},Ds={class:"dialog-footer"},Ls={__name:"TopicInput",props:{modelValue:{type:Array,default:()=>[]},platformKey:{type:Number,required:!0},validateOnInput:{type:Boolean,default:!0}},emits:["update:modelValue","validation-change"],setup(a,{expose:u,emit:d}){const p=a,o=d,i=J(()=>he(p.platformKey)),r=J({get:()=>p.modelValue,set:_=>o("update:modelValue",_)}),$=J(()=>r.value.length>=i.value.topicLimit),T=R(""),L=R(!1),M=R(""),I=["游戏","知识","自动化","系统平台","自媒体工具","跨境电商","科技","教程","云手机平台","云电脑平台","脚本","开源","健康","时尚","美妆","摄影","宠物","汽车"],V=()=>{if($.value){P.warning(`最多只能添加${i.value.topicLimit}个话题`);return}L.value=!0},x=()=>{if(!M.value.trim()){P.warning("请输入话题内容");return}const _=xa(M.value.trim());if(!_.valid){P.error(_.message);return}if($.value){P.warning(`最多只能添加${i.value.topicLimit}个话题`);return}r.value.includes(M.value.trim())?P.warning("话题已存在"):(r.value.push(M.value.trim()),M.value="",P.success("话题添加成功"),n())},c=_=>{if($.value&&!r.value.includes(_)){P.warning(`最多只能添加${i.value.topicLimit}个话题`);return}const m=r.value.indexOf(_);m>-1?r.value.splice(m,1):r.value.push(_),n()},O=_=>{r.value.splice(_,1),n()},U=()=>{L.value=!1,M.value="",P.success("添加话题完成")},n=()=>{if(p.validateOnInput){const _=Pe(r.value,p.platformKey);T.value=_.valid?"":_.message,o("validation-change",_)}};return u({validate:()=>{const _=Pe(p.modelValue,p.platformKey);return T.value=_.valid?"":_.message,o("validation-change",_),_}}),(_,m)=>{const W=v("el-tag"),F=v("el-button"),k=v("el-alert"),b=v("el-input"),q=v("el-dialog");return f(),A("div",ks,[m[9]||(m[9]=l("h3",null,"话题",-1)),l("div",Cs,[l("div",Ts,[(f(!0),A(se,null,oe(r.value,(K,G)=>(f(),X(W,{key:G,closable:"",onClose:Z=>O(G),class:"topic-tag"},{default:t(()=>[y(" #"+B(K),1)]),_:2},1032,["onClose"]))),128))]),e(F,{type:"primary",plain:"",onClick:V,class:"select-topic-btn",disabled:$.value},{default:t(()=>[...m[3]||(m[3]=[y(" 添加话题 ",-1)])]),_:1},8,["disabled"])]),i.value?(f(),A("div",xs,[e(k,{title:`已添加 ${r.value.length}/${i.value.topicLimit} 个话题`,type:$.value?"warning":"info",closable:!1,"show-icon":"",class:"topic-alert"},null,8,["title","type"])])):Y("",!0),T.value?(f(),A("div",As,[e(k,{title:T.value,type:"error",closable:!1,"show-icon":"",class:"error-alert"},null,8,["title"])])):Y("",!0),e(q,{modelValue:L.value,"onUpdate:modelValue":m[2]||(m[2]=K=>L.value=K),title:"添加话题",width:"600px",class:"topic-dialog"},{footer:t(()=>[l("div",Ds,[e(F,{onClick:m[1]||(m[1]=K=>L.value=!1)},{default:t(()=>[...m[7]||(m[7]=[y("取消",-1)])]),_:1}),e(F,{type:"primary",onClick:U},{default:t(()=>[...m[8]||(m[8]=[y("确定",-1)])]),_:1})])]),default:t(()=>[l("div",Us,[l("div",Ps,[e(b,{modelValue:M.value,"onUpdate:modelValue":m[0]||(m[0]=K=>M.value=K),placeholder:"输入自定义话题",class:"custom-input",onKeyup:Ie(x,["enter"])},{prepend:t(()=>[...m[4]||(m[4]=[y("#",-1)])]),_:1},8,["modelValue"]),e(F,{type:"primary",onClick:x},{default:t(()=>[...m[5]||(m[5]=[y("添加",-1)])]),_:1})]),l("div",Ss,[m[6]||(m[6]=l("h4",null,"推荐话题",-1)),l("div",Ms,[(f(),A(se,null,oe(I,K=>e(F,{key:K,type:r.value.includes(K)?"primary":"default",onClick:G=>c(K),class:"topic-btn",disabled:r.value.includes(K)&&$.value},{default:t(()=>[y(B(K),1)]),_:2},1032,["type","onClick","disabled"])),64))])])])]),_:1},8,["modelValue"])])}}},we=ee(Ls,[["__scopeId","data-v-b3973a1b"]]),Is={class:"xiaohongshu-form"},zs={__name:"XiaohongshuForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const u=le(a,"title"),d=le(a,"topics");return(p,o)=>(f(),A("div",Is,[e(be,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=i=>u.value=i),"platform-key":1,onValidationChange:o[1]||(o[1]=i=>p.$emit("validation-change","title",i))},null,8,["modelValue"]),e(we,{modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=i=>d.value=i),"platform-key":1,onValidationChange:o[3]||(o[3]=i=>p.$emit("validation-change","topics",i))},null,8,["modelValue"])]))}},Es=ee(zs,[["__scopeId","data-v-755d8f6d"]]),Bs={class:"wechat-video-form"},Fs={__name:"WechatVideoForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const u=le(a,"title"),d=le(a,"topics");return(p,o)=>(f(),A("div",Bs,[e(be,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=i=>u.value=i),"platform-key":2,onValidationChange:o[1]||(o[1]=i=>p.$emit("validation-change","title",i))},null,8,["modelValue"]),e(we,{modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=i=>d.value=i),"platform-key":2,onValidationChange:o[3]||(o[3]=i=>p.$emit("validation-change","topics",i))},null,8,["modelValue"])]))}},Rs=ee(Fs,[["__scopeId","data-v-e4342bc4"]]),Os={class:"douyin-form"},qs={__name:"DouyinForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const u=le(a,"title"),d=le(a,"topics");return(p,o)=>(f(),A("div",Os,[e(be,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=i=>u.value=i),"platform-key":3,onValidationChange:o[1]||(o[1]=i=>p.$emit("validation-change","title",i))},null,8,["modelValue"]),e(we,{modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=i=>d.value=i),"platform-key":3,onValidationChange:o[3]||(o[3]=i=>p.$emit("validation-change","topics",i))},null,8,["modelValue"])]))}},Ks=ee(qs,[["__scopeId","data-v-8f8e36c0"]]),Hs={class:"kuaishou-form"},Ns={__name:"KuaishouForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const u=le(a,"title"),d=le(a,"topics");return(p,o)=>(f(),A("div",Hs,[e(be,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=i=>u.value=i),"platform-key":4,onValidationChange:o[1]||(o[1]=i=>p.$emit("validation-change","title",i))},null,8,["modelValue"]),e(we,{modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=i=>d.value=i),"platform-key":4,onValidationChange:o[3]||(o[3]=i=>p.$emit("validation-change","topics",i))},null,8,["modelValue"])]))}},js=ee(Ns,[["__scopeId","data-v-567a13dc"]]),Ws={class:"bili-tag-section"},Ys={class:"tag-display"},Gs={class:"selected-tags"},Xs={class:"tag-tips"},Js={key:0,class:"error-message"},Qs={class:"tag-dialog-content"},Zs={class:"custom-tag-input"},eo={class:"recommended-tags"},to={class:"tag-grid"},lo={class:"dialog-footer"},ao={__name:"BiliTagInput",props:{modelValue:{type:Array,default:()=>[]},validateOnInput:{type:Boolean,default:!0}},emits:["update:modelValue","validation-change"],setup(a,{expose:u,emit:d}){const p=a,o=d,i=J({get:()=>p.modelValue,set:_=>o("update:modelValue",_)}),r=J(()=>i.value.length>=10),$=R(""),T=R(!1),L=R(""),M=["知识","游戏","科技","娱乐","音乐","舞蹈","动画","影视","生活","美食","体育","时尚","汽车","旅游","动物","搞笑","教程","测评","开箱","vlog","日常","分享","原创","转载"],I=()=>{if(r.value){P.warning("最多只能添加10个标签");return}T.value=!0},V=_=>{if(!_||_.trim()==="")return{valid:!1,message:"标签内容不能为空"};const m=_.trim();return m.length>10?{valid:!1,message:"单个标签不能超过10个字符"}:m.length<1?{valid:!1,message:"标签至少需要1个字符"}:/[<>\/\\|:"*?#]/.test(m)?{valid:!1,message:"标签不能包含特殊字符"}:{valid:!0,message:""}},x=()=>{if(!L.value.trim()){P.warning("请输入标签内容");return}const _=V(L.value.trim());if(!_.valid){P.error(_.message);return}if(r.value){P.warning("最多只能添加10个标签");return}const m=L.value.trim();i.value.includes(m)?P.warning("标签已存在"):(i.value.push(m),L.value="",P.success("标签添加成功"),n())},c=_=>{if(r.value&&!i.value.includes(_)){P.warning("最多只能添加10个标签");return}const m=i.value.indexOf(_);m>-1?i.value.splice(m,1):i.value.push(_),n()},O=_=>{i.value.splice(_,1),n()},U=()=>{T.value=!1,L.value="",P.success("添加标签完成")},n=()=>{if(p.validateOnInput){let _={valid:!0,message:""};if(i.value.length===0)_={valid:!1,message:"请至少添加一个标签"};else if(i.value.length>10)_={valid:!1,message:"最多只能添加10个标签"};else for(const m of i.value){const W=V(m);if(!W.valid){_=W;break}}$.value=_.valid?"":_.message,o("validation-change",_)}};return u({validate:()=>{let _={valid:!0,message:""};if(p.modelValue.length===0)_={valid:!1,message:"请至少添加一个标签"};else if(p.modelValue.length>10)_={valid:!1,message:"最多只能添加10个标签"};else for(const m of p.modelValue){const W=V(m);if(!W.valid){_=W;break}}return $.value=_.valid?"":_.message,o("validation-change",_),_}}),(_,m)=>{const W=v("el-tag"),F=v("el-button"),k=v("el-text"),b=v("el-alert"),q=v("el-input"),K=v("el-dialog");return f(),A("div",Ws,[l("div",Ys,[l("div",Gs,[(f(!0),A(se,null,oe(i.value,(G,Z)=>(f(),X(W,{key:Z,closable:"",onClose:C=>O(Z),class:"tag-item",size:"small"},{default:t(()=>[y(B(G),1)]),_:2},1032,["onClose"]))),128))]),e(F,{type:"primary",plain:"",onClick:I,class:"add-tag-btn",size:"small",disabled:r.value},{default:t(()=>[...m[3]||(m[3]=[y(" 添加标签 ",-1)])]),_:1},8,["disabled"])]),l("div",Xs,[e(k,{size:"small",type:"info"},{default:t(()=>[y(" 已添加 "+B(i.value.length)+"/10 个标签，标签有助于更多用户发现你的视频 ",1)]),_:1}),r.value?(f(),X(k,{key:0,size:"small",type:"warning",style:{"margin-left":"8px"}},{default:t(()=>[...m[4]||(m[4]=[y(" 已达上限 ",-1)])]),_:1})):Y("",!0)]),$.value?(f(),A("div",Js,[e(b,{title:$.value,type:"error",closable:!1,"show-icon":"",size:"small"},null,8,["title"])])):Y("",!0),e(K,{modelValue:T.value,"onUpdate:modelValue":m[2]||(m[2]=G=>T.value=G),title:"添加标签",width:"600px",class:"tag-dialog"},{footer:t(()=>[l("div",lo,[e(F,{onClick:m[1]||(m[1]=G=>T.value=!1)},{default:t(()=>[...m[7]||(m[7]=[y("取消",-1)])]),_:1}),e(F,{type:"primary",onClick:U},{default:t(()=>[...m[8]||(m[8]=[y("确定",-1)])]),_:1})])]),default:t(()=>[l("div",Qs,[l("div",Zs,[e(q,{modelValue:L.value,"onUpdate:modelValue":m[0]||(m[0]=G=>L.value=G),placeholder:"输入标签内容",class:"custom-input",onKeyup:Ie(x,["enter"]),maxlength:"10","show-word-limit":""},null,8,["modelValue"]),e(F,{type:"primary",onClick:x},{default:t(()=>[...m[5]||(m[5]=[y("添加",-1)])]),_:1})]),l("div",eo,[m[6]||(m[6]=l("h4",null,"推荐标签",-1)),l("div",to,[(f(),A(se,null,oe(M,G=>e(F,{key:G,type:i.value.includes(G)?"primary":"default",onClick:Z=>c(G),class:"tag-btn",size:"small",disabled:i.value.includes(G)&&r.value},{default:t(()=>[y(B(G),1)]),_:2},1032,["type","onClick","disabled"])),64))])])])]),_:1},8,["modelValue"])])}}},so=ee(ao,[["__scopeId","data-v-b01e071a"]]),oo={class:"bilibili-form"},no={class:"bili-specific-fields"},io={class:"field-tips"},uo={class:"field-tips"},ro={class:"field-tips"},co={class:"field-tips"},po={class:"schedule-setting"},mo={key:0,class:"schedule-datetime"},fo={class:"field-tips"},vo={__name:"BilibiliForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{},biliType:{type:String,default:"自制"},biliTypeModifiers:{},biliPartition:{type:String,default:""},biliPartitionModifiers:{},biliDesc:{type:String,default:""},biliDescModifiers:{},scheduleEnabled:{type:Boolean,default:!1},scheduleEnabledModifiers:{},scheduleTime:{type:String,default:""},scheduleTimeModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics","update:biliType","update:biliPartition","update:biliDesc","update:scheduleEnabled","update:scheduleTime"]),setup(a){const u=le(a,"title"),d=le(a,"topics"),p=le(a,"biliType"),o=le(a,"biliPartition"),i=le(a,"biliDesc"),r=le(a,"scheduleEnabled"),$=le(a,"scheduleTime"),T=I=>{const V=new Date,x=new Date(V.getTime()+10080*60*1e3);return I.getTime()<V.getTime()||I.getTime()>x.getTime()},L=()=>{const I=new Date;return new Date($.value).toDateString()===I.toDateString()?Array.from({length:I.getHours()},(x,c)=>c):[]},M=I=>{const V=new Date;return new Date($.value).toDateString()===V.toDateString()&&I===V.getHours()?Array.from({length:V.getMinutes()},(c,O)=>O):[]};return(I,V)=>{const x=v("el-input"),c=v("el-text"),O=v("el-form-item"),U=v("el-radio"),n=v("el-radio-group"),S=v("el-option"),_=v("el-select"),m=v("el-switch"),W=v("el-date-picker"),F=v("el-form");return f(),A("div",oo,[l("div",no,[e(F,{"label-width":"90px"},{default:t(()=>[e(O,{label:"标题",required:""},{default:t(()=>[e(x,{modelValue:u.value,"onUpdate:modelValue":V[0]||(V[0]=k=>u.value=k),placeholder:"请输入稿件标题",maxlength:"80","show-word-limit":"",clearable:""},null,8,["modelValue"]),l("div",io,[e(c,{size:"small",type:"info"},{default:t(()=>[...V[8]||(V[8]=[y("好的标题有助于作品获得更多推荐",-1)])]),_:1})])]),_:1}),e(O,{label:"类型",required:""},{default:t(()=>[e(n,{modelValue:p.value,"onUpdate:modelValue":V[1]||(V[1]=k=>p.value=k)},{default:t(()=>[e(U,{label:"自制"},{default:t(()=>[...V[9]||(V[9]=[y("自制",-1)])]),_:1}),e(U,{label:"转载"},{default:t(()=>[...V[10]||(V[10]=[y("转载",-1)])]),_:1})]),_:1},8,["modelValue"]),l("div",uo,[e(c,{size:"small",type:"info"},{default:t(()=>[...V[11]||(V[11]=[y("自制=原创内容，转载=搬运内容",-1)])]),_:1})])]),_:1}),e(O,{label:"分区",required:""},{default:t(()=>[e(_,{modelValue:o.value,"onUpdate:modelValue":V[2]||(V[2]=k=>o.value=k),placeholder:"请选择分区",filterable:"",clearable:"",style:{width:"100%"}},{default:t(()=>[e(S,{label:"影视",value:"影视"}),e(S,{label:"娱乐",value:"娱乐"}),e(S,{label:"音乐",value:"音乐"}),e(S,{label:"舞蹈",value:"舞蹈"}),e(S,{label:"动画",value:"动画"}),e(S,{label:"绘画",value:"绘画"}),e(S,{label:"鬼畜",value:"鬼畜"}),e(S,{label:"游戏",value:"游戏"}),e(S,{label:"资讯",value:"资讯"}),e(S,{label:"知识",value:"知识"}),e(S,{label:"人工智能",value:"人工智能"}),e(S,{label:"科技数码",value:"科技数码"}),e(S,{label:"汽车",value:"汽车"}),e(S,{label:"时尚美妆",value:"时尚美妆"}),e(S,{label:"家装房产",value:"家装房产"}),e(S,{label:"户外潮流",value:"户外潮流"}),e(S,{label:"健身",value:"健身"}),e(S,{label:"体育运动",value:"体育运动"}),e(S,{label:"手工",value:"手工"}),e(S,{label:"美食",value:"美食"}),e(S,{label:"小剧场",value:"小剧场"}),e(S,{label:"旅游出行",value:"旅游出行"}),e(S,{label:"三农",value:"三农"}),e(S,{label:"动物",value:"动物"}),e(S,{label:"亲子",value:"亲子"}),e(S,{label:"健康",value:"健康"}),e(S,{label:"情感",value:"情感"}),e(S,{label:"vlog",value:"vlog"}),e(S,{label:"生活兴趣",value:"生活兴趣"}),e(S,{label:"生活经验",value:"生活经验"})]),_:1},8,["modelValue"]),l("div",ro,[e(c,{size:"small",type:"warning"},{default:t(()=>[...V[12]||(V[12]=[y(" ⚠️ 分区选项需要根据B站实际页面更新。请访问 ",-1),l("a",{href:"https://member.bilibili.com/platform/upload/video/frame",target:"_blank",style:{color:"#409eff"}}," B站上传页面 ",-1),y(" 查看实际分区列表。 ",-1)])]),_:1})])]),_:1}),e(O,{label:"标签",required:""},{default:t(()=>[e(so,{modelValue:d.value,"onUpdate:modelValue":V[3]||(V[3]=k=>d.value=k),onValidationChange:V[4]||(V[4]=k=>I.$emit("validation-change","topics",k))},null,8,["modelValue"])]),_:1}),e(O,{label:"简介"},{default:t(()=>[e(x,{modelValue:i.value,"onUpdate:modelValue":V[5]||(V[5]=k=>i.value=k),type:"textarea",rows:5,maxlength:"2000","show-word-limit":"",placeholder:"填写更全面的相关信息，让更多的人能够找到你的视频吧",resize:"vertical"},null,8,["modelValue"]),l("div",co,[e(c,{size:"small",type:"info"},{default:t(()=>[...V[13]||(V[13]=[y("简介支持@用户、#话题、超链接",-1)])]),_:1})])]),_:1}),e(O,{label:"定时发布"},{default:t(()=>[l("div",po,[e(m,{modelValue:r.value,"onUpdate:modelValue":V[6]||(V[6]=k=>r.value=k),"active-text":"启用定时发布","inactive-text":"立即发布"},null,8,["modelValue"]),r.value?(f(),A("div",mo,[e(W,{modelValue:$.value,"onUpdate:modelValue":V[7]||(V[7]=k=>$.value=k),type:"datetime",placeholder:"选择发布时间",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm","disabled-date":T,"disabled-hours":L,"disabled-minutes":M,style:{width:"100%","margin-top":"8px"}},null,8,["modelValue"])])):Y("",!0)]),l("div",fo,[e(c,{size:"small",type:"info"},{default:t(()=>[...V[14]||(V[14]=[y("可设置未来7天内的发布时间",-1)])]),_:1})])]),_:1})]),_:1})])])}}},_o=ee(vo,[["__scopeId","data-v-7b834afc"]]),go={class:"common-form"},yo={class:"common-notice"},ho={__name:"CommonForm",props:fe({platformKey:{type:Number,required:!0}},{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}}),emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const u=le(a,"title"),d=le(a,"topics");return(p,o)=>{const i=v("el-alert");return f(),A("div",go,[e(be,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=r=>u.value=r),"platform-key":a.platformKey,onValidationChange:o[1]||(o[1]=r=>p.$emit("validation-change","title",r))},null,8,["modelValue","platform-key"]),e(we,{modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=r=>d.value=r),"platform-key":a.platformKey,onValidationChange:o[3]||(o[3]=r=>p.$emit("validation-change","topics",r))},null,8,["modelValue","platform-key"]),l("div",yo,[e(i,{title:"通用表单",description:"当前平台使用通用表单模板，如需平台专属字段，请联系开发者添加。",type:"info",closable:!1,"show-icon":""})])])}}},bo=ee(ho,[["__scopeId","data-v-4cc75321"]]),wo={class:"publish-center"},$o={class:"publish-content"},Vo={class:"tab-content-wrapper"},ko={key:0,class:"publish-status"},Co={class:"platform-forms"},To={class:"action-buttons"},xo={class:"publish-progress"},Ao={key:0,class:"current-publishing"},Uo={key:1,class:"publish-results"},Po={class:"label"},So={class:"message"},Mo={class:"dialog-footer"},Do={__name:"PublishCenter",setup(a){const u="http://localhost:5409",d=J(()=>({Authorization:`Bearer ${localStorage.getItem("token")||""}`})),p=R("tab1");let o=1;const i=xe(),r=Se(),$=J(()=>i.materials),T={1:"小红书",2:"视频号",3:"抖音",4:"快手",5:"B站"},L=R(!1);Te(async()=>{try{const C=await Ve.getValidAccounts({validate:0});C&&C.code===200&&Array.isArray(C.data)&&r.setAccounts(C.data)}catch(C){console.warn("初始化获取账号失败",C)}});const M=ve([{name:"tab1",label:T[1],fileList:[],displayFileList:[],selectedAccounts:[],selectedPlatform:1,title:"",selectedTopics:[],biliType:"自制",biliPartition:"",biliDesc:"",scheduleTime:"",scheduleEnabled:!1,videosPerDay:1,dailyTimes:["10:00"],startDays:0,publishStatus:null,validationErrors:{}}]),I=R(!1),V=R(null),x=R(0),c=R([]),O=R(!1),U=()=>{o++;const C={name:`tab${o}`,label:T[1],fileList:[],displayFileList:[],selectedAccounts:[],selectedPlatform:1,title:"",selectedTopics:[],biliType:"自制",biliPartition:"",biliDesc:"",scheduleTime:"",scheduleEnabled:!1,videosPerDay:1,dailyTimes:["10:00"],startDays:0,publishStatus:null,validationErrors:{}};M.push(C),p.value=C.name},n=C=>{const z=M.findIndex(N=>N.name===C);z>-1&&(M.splice(z,1),p.value===C&&M.length>0&&(p.value=M[0].name))},S=C=>{const z=M.find(N=>N.name===p.value);z&&(z.selectedAccounts=[],k(z))},_=(C,z,N)=>{z.valid?delete N.validationErrors[C]:N.validationErrors[C]=z.message},m=(C,z,N)=>{if(C.code===200){const D=C.data.path||C.data,s=D.split("/").pop(),H={name:z.name,url:pe.getMaterialPreviewUrl(s),path:D,size:z.size,type:z.type};N.fileList.push(H),N.displayFileList=[...N.fileList.map(E=>({name:E.name,url:E.url}))],P.success("文件上传成功"),console.log("上传成功:",H)}else P.error(C.msg||"上传失败")},W=(C,z)=>{C.forEach(N=>{const D=$.value.find(s=>s.id===N);if(D){const s={name:D.filename,url:pe.getMaterialPreviewUrl(D.file_path.split("/").pop()),path:D.file_path,size:D.filesize*1024*1024,type:"video/mp4"};z.fileList.some(E=>E.path===s.path)||z.fileList.push(s)}}),z.displayFileList=[...z.fileList.map(N=>({name:N.name,url:N.url}))]},F=(C,z)=>{C.fileList.splice(z,1),C.displayFileList=[...C.fileList.map(N=>({name:N.name,url:N.url}))],P.success("文件删除成功")},k=C=>{const z=T[C.selectedPlatform],N=C.selectedAccounts||[];if(z&&N.length>0){const D=r.accounts.find(H=>H.id===N[0]),s=(D==null?void 0:D.name)||"";C.label=s?`${z}_${s}`:`${z}`}else if(z)C.label=z;else{const D=M.findIndex(s=>s.name===C.name);C.label=`发布${D+1}`}};Le(M,()=>{M.forEach(k)},{deep:!0});const b=C=>{P.info("已取消发布")},q=async C=>new Promise((z,N)=>{const D=Aa(C);if(!D.valid){const H=Object.values(D.errors)[0];P.error(H),N(new Error(H));return}const s={type:C.selectedPlatform,title:C.title,tags:C.selectedTopics,fileList:C.fileList.map(H=>H.path),accountList:C.selectedAccounts.map(H=>{const E=r.accounts.find(h=>h.id===H);return E?E.filePath:H}),enableTimer:C.scheduleEnabled?1:0,videosPerDay:C.scheduleEnabled&&C.videosPerDay||1,dailyTimes:C.scheduleEnabled?C.dailyTimes||["10:00"]:["10:00"],startDays:C.scheduleEnabled&&C.startDays||0,category:0};C.selectedPlatform===5&&(s.biliType=C.biliType,s.biliPartition=C.biliPartition,s.biliDesc=C.biliDesc),fetch(`${u}/postVideo`,{method:"POST",headers:{"Content-Type":"application/json",...d.value},body:JSON.stringify(s)}).then(H=>H.json()).then(H=>{H.code===200?(C.publishStatus={message:"发布成功",type:"success"},C.fileList=[],C.displayFileList=[],C.title="",C.selectedTopics=[],C.selectedAccounts=[],C.scheduleEnabled=!1,C.validationErrors={},z()):(C.publishStatus={message:`发布失败：${H.msg||"发布失败"}`,type:"error"},N(new Error(H.msg||"发布失败")))}).catch(H=>{console.error("发布错误:",H),C.publishStatus={message:"发布失败，请检查网络连接",type:"error"},N(H)})}),K=()=>{const C=[];return M.forEach(z=>{const N=[];(!z.fileList||z.fileList.length===0)&&N.push("未上传视频"),(!z.selectedAccounts||z.selectedAccounts.length===0)&&N.push("未选择账号"),N.length&&C.push({tab:z,message:`${z.label}: ${N.join("、")}`})}),C},G=async()=>{if(L.value)return;const C=K();if(C.length>0){p.value=C[0].tab.name,C[0].tab.publishStatus={message:C[0].message,type:"error"};try{await ye.alert(C.map(z=>z.message).join(`
`),"请完善发布项后再批量发布",{confirmButtonText:"好的"})}catch{}P.error("存在未准备完成的发布项：请为每个发布项上传视频并选择账号");return}L.value=!0,V.value=null,x.value=0,c.value=[],O.value=!1,I.value=!0;try{for(let s=0;s<M.length;s++){if(O.value){c.value.push({label:M[s].label,status:"cancelled",message:"已取消"});continue}const H=M[s];V.value=H,x.value=Math.floor(s/M.length*100);try{await q(H),c.value.push({label:H.label,status:"success",message:"发布成功"})}catch(E){c.value.push({label:H.label,status:"error",message:E.message})}}x.value=100;const z=c.value.filter(s=>s.status==="success").length,N=c.value.filter(s=>s.status==="error").length,D=c.value.filter(s=>s.status==="cancelled").length;O.value?P.warning(`发布已取消：${z}个成功，${N}个失败，${D}个未执行`):N>0?P.error(`发布完成：${z}个成功，${N}个失败`):(P.success("所有Tab发布成功"),setTimeout(()=>{I.value=!1},1e3))}catch(z){console.error("批量发布出错:",z),P.error("批量发布出错，请重试")}finally{L.value=!1,O.value=!1}},Z=()=>{O.value=!0,P.info("正在取消发布...")};return(C,z)=>{const N=v("el-alert"),D=v("el-button"),s=v("el-progress"),H=v("el-icon"),E=v("el-dialog");return f(),A("div",wo,[e(Ia,{tabs:M,"active-tab":p.value,"batch-publishing":L.value,onTabChange:z[0]||(z[0]=h=>p.value=h),onRemoveTab:n,onAddTab:U,onBatchPublish:G},null,8,["tabs","active-tab","batch-publishing"]),l("div",$o,[l("div",Vo,[(f(!0),A(se,null,oe(M,h=>ke((f(),A("div",{key:h.name,class:"tab-content"},[h.publishStatus?(f(),A("div",ko,[e(N,{title:h.publishStatus.message,type:h.publishStatus.type,closable:!1,"show-icon":""},null,8,["title","type"])])):Y("",!0),e(Ja,{"file-list":h.fileList,"upload-action":`${j(u)}/upload`,"auth-headers":d.value,materials:$.value,onRemoveFile:g=>F(h,g),onUploadSuccess:(g,Q)=>m(g,Q,h),onMaterialSelected:g=>W(g,h)},null,8,["file-list","upload-action","auth-headers","materials","onRemoveFile","onUploadSuccess","onMaterialSelected"]),e(ts,{modelValue:h.selectedPlatform,"onUpdate:modelValue":g=>h.selectedPlatform=g,onPlatformChange:S},null,8,["modelValue","onUpdate:modelValue"]),e(cs,{modelValue:h.selectedAccounts,"onUpdate:modelValue":g=>h.selectedAccounts=g,"platform-key":h.selectedPlatform},null,8,["modelValue","onUpdate:modelValue","platform-key"]),l("div",Co,[h.selectedPlatform===1?(f(),X(Es,{key:0,title:h.title,"onUpdate:title":g=>h.title=g,topics:h.selectedTopics,"onUpdate:topics":g=>h.selectedTopics=g,onValidationChange:(g,Q)=>_(g,Q,h)},null,8,["title","onUpdate:title","topics","onUpdate:topics","onValidationChange"])):Y("",!0),h.selectedPlatform===2?(f(),X(Rs,{key:1,title:h.title,"onUpdate:title":g=>h.title=g,topics:h.selectedTopics,"onUpdate:topics":g=>h.selectedTopics=g,onValidationChange:(g,Q)=>_(g,Q,h)},null,8,["title","onUpdate:title","topics","onUpdate:topics","onValidationChange"])):Y("",!0),h.selectedPlatform===3?(f(),X(Ks,{key:2,title:h.title,"onUpdate:title":g=>h.title=g,topics:h.selectedTopics,"onUpdate:topics":g=>h.selectedTopics=g,onValidationChange:(g,Q)=>_(g,Q,h)},null,8,["title","onUpdate:title","topics","onUpdate:topics","onValidationChange"])):Y("",!0),h.selectedPlatform===4?(f(),X(js,{key:3,title:h.title,"onUpdate:title":g=>h.title=g,topics:h.selectedTopics,"onUpdate:topics":g=>h.selectedTopics=g,onValidationChange:(g,Q)=>_(g,Q,h)},null,8,["title","onUpdate:title","topics","onUpdate:topics","onValidationChange"])):Y("",!0),h.selectedPlatform===5?(f(),X(_o,{key:4,title:h.title,"onUpdate:title":g=>h.title=g,topics:h.selectedTopics,"onUpdate:topics":g=>h.selectedTopics=g,"bili-type":h.biliType,"onUpdate:biliType":g=>h.biliType=g,"bili-partition":h.biliPartition,"onUpdate:biliPartition":g=>h.biliPartition=g,"bili-desc":h.biliDesc,"onUpdate:biliDesc":g=>h.biliDesc=g,"schedule-enabled":h.scheduleEnabled,"onUpdate:scheduleEnabled":g=>h.scheduleEnabled=g,"schedule-time":h.scheduleTime,"onUpdate:scheduleTime":g=>h.scheduleTime=g,onValidationChange:(g,Q)=>_(g,Q,h)},null,8,["title","onUpdate:title","topics","onUpdate:topics","bili-type","onUpdate:biliType","bili-partition","onUpdate:biliPartition","bili-desc","onUpdate:biliDesc","schedule-enabled","onUpdate:scheduleEnabled","schedule-time","onUpdate:scheduleTime","onValidationChange"])):Y("",!0),[1,2,3,4,5].includes(h.selectedPlatform)?Y("",!0):(f(),X(bo,{key:5,title:h.title,"onUpdate:title":g=>h.title=g,topics:h.selectedTopics,"onUpdate:topics":g=>h.selectedTopics=g,"platform-key":h.selectedPlatform,onValidationChange:(g,Q)=>_(g,Q,h)},null,8,["title","onUpdate:title","topics","onUpdate:topics","platform-key","onValidationChange"]))]),h.selectedPlatform!==5?(f(),X(bs,{key:1,"schedule-enabled":h.scheduleEnabled,"onUpdate:scheduleEnabled":g=>h.scheduleEnabled=g,"videos-per-day":h.videosPerDay,"onUpdate:videosPerDay":g=>h.videosPerDay=g,"daily-times":h.dailyTimes,"onUpdate:dailyTimes":g=>h.dailyTimes=g,"start-days":h.startDays,"onUpdate:startDays":g=>h.startDays=g},null,8,["schedule-enabled","onUpdate:scheduleEnabled","videos-per-day","onUpdate:videosPerDay","daily-times","onUpdate:dailyTimes","start-days","onUpdate:startDays"])):Y("",!0),l("div",To,[e(D,{size:"small",onClick:g=>b()},{default:t(()=>[...z[3]||(z[3]=[y("取消",-1)])]),_:1},8,["onClick"]),e(D,{size:"small",type:"primary",onClick:g=>q(h)},{default:t(()=>[...z[4]||(z[4]=[y("发布",-1)])]),_:1},8,["onClick"])])])),[[Ae,p.value===h.name]])),128))])]),e(E,{modelValue:I.value,"onUpdate:modelValue":z[2]||(z[2]=h=>I.value=h),title:"批量发布进度",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{footer:t(()=>[l("div",Mo,[e(D,{onClick:Z,disabled:x.value===100},{default:t(()=>[...z[5]||(z[5]=[y(" 取消发布 ",-1)])]),_:1},8,["disabled"]),x.value===100?(f(),X(D,{key:0,type:"primary",onClick:z[1]||(z[1]=h=>I.value=!1)},{default:t(()=>[...z[6]||(z[6]=[y(" 关闭 ",-1)])]),_:1})):Y("",!0)])]),default:t(()=>[l("div",xo,[e(s,{percentage:x.value,status:x.value===100?"success":""},null,8,["percentage","status"]),V.value?(f(),A("div",Ao," 正在发布："+B(V.value.label),1)):Y("",!0),c.value.length>0?(f(),A("div",Uo,[(f(!0),A(se,null,oe(c.value,(h,g)=>(f(),A("div",{key:g,class:de(["result-item",h.status])},[h.status==="success"?(f(),X(H,{key:0},{default:t(()=>[e(j(pt))]),_:1})):h.status==="error"?(f(),X(H,{key:1},{default:t(()=>[e(j(Be))]),_:1})):(f(),X(H,{key:2},{default:t(()=>[e(j(mt))]),_:1})),l("span",Po,B(h.label),1),l("span",So,B(h.message),1)],2))),128))])):Y("",!0)])]),_:1},8,["modelValue"])])}}},Lo=ee(Do,[["__scopeId","data-v-cdc7a2a5"]]),Io={class:"about"},zo={__name:"About",setup(a){return(u,d)=>(f(),A("div",Io,[...d[0]||(d[0]=[l("h1",null,"关于我们",-1),l("p",null,"这是关于页面",-1)])]))}},Eo=ee(zo,[["__scopeId","data-v-cd67ee8e"]]),Bo=[{path:"/",name:"Dashboard",component:nl},{path:"/account-management",name:"AccountManagement",component:Zl},{path:"/material-management",redirect:"/material-management/list"},{path:"/material-management/list",name:"MaterialList",component:ga},{path:"/material-management/cover",name:"CoverGenerator",component:Ca},{path:"/publish-center",name:"PublishCenter",component:Lo},{path:"/about",name:"About",component:Eo}],Fo=Ge({history:Xe(),routes:Bo}),Ro=Je(),$e=Qe(Ct);for(const[a,u]of Object.entries(ft))$e.component(a,u);$e.use(Fo);$e.use(Ro);$e.use(vt);$e.mount("#app");
