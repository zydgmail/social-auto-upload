import{b as J,ax as Ke,r as N,c as T,o as c,R as e,J as t,al as _,a as l,K as ke,S as Ae,u as F,p as ve,ay as Ne,P as z,O as v,I as G,L as Y,az as De,t as xe,X as je,ar as He,E as de,Q as se,a6 as oe,W as Ye,a4 as Le,aA as fe,aB as le,w as We,aC as Xe,aD as Ge,aE as Je,au as Qe}from"./vue-Bh7ksF0J.js";import{h as Ze,u as Ie,p as et,a as _e,m as tt,d as ze,f as lt,b as at,l as st,c as ot,e as nt,t as it,E as A,g as ye,r as re,i as dt,j as ut,k as rt,n as Ee,o as ct,q as pt,s as mt,v as ft,w as vt}from"./elementPlus-DoEz3rhs.js";import{a as _t}from"./utils-NIGUFBhG.js";(function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))p(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&p(r)}).observe(document,{childList:!0,subtree:!0});function i(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function p(o){if(o.ep)return;o.ep=!0;const n=i(o);fetch(o.href,n)}})();const gt="/vite.svg",Z=(a,d)=>{const i=a.__vccOpts||a;for(const[p,o]of d)i[p]=o;return i},yt={id:"app"},ht={class:"sidebar"},bt={class:"logo"},$t={src:gt,alt:"Logo",class:"logo-img"},wt={class:"header-content"},Vt={class:"header-left"},kt={__name:"App",setup(a){const d=Ke(),i=J(()=>d.path),p=N(!1),o=()=>{p.value=!p.value};return(n,r)=>{const V=_("el-icon"),P=_("el-menu-item"),S=_("el-menu"),x=_("el-aside"),D=_("el-header"),$=_("router-view"),C=_("el-main"),u=_("el-container");return c(),T("div",yt,[e(u,null,{default:t(()=>[e(x,{width:p.value?"64px":"200px"},{default:t(()=>[l("div",ht,[l("div",bt,[ke(l("img",$t,null,512),[[Ae,p.value]]),ke(l("h2",null,"自媒体自动化运营系统",512),[[Ae,!p.value]])]),e(S,{router:!0,"default-active":i.value,collapse:p.value,class:"sidebar-menu","background-color":"#001529","text-color":"#fff","active-text-color":"#409EFF"},{default:t(()=>[e(P,{index:"/"},{default:t(()=>[e(V,null,{default:t(()=>[e(F(Ze))]),_:1}),r[0]||(r[0]=l("span",null,"首页",-1))]),_:1}),e(P,{index:"/account-management"},{default:t(()=>[e(V,null,{default:t(()=>[e(F(Ie))]),_:1}),r[1]||(r[1]=l("span",null,"账号管理",-1))]),_:1}),e(P,{index:"/material-management"},{default:t(()=>[e(V,null,{default:t(()=>[e(F(et))]),_:1}),r[2]||(r[2]=l("span",null,"素材管理",-1))]),_:1}),e(P,{index:"/publish-center"},{default:t(()=>[e(V,null,{default:t(()=>[e(F(_e))]),_:1}),r[3]||(r[3]=l("span",null,"发布中心",-1))]),_:1}),e(P,{index:"/website"},{default:t(()=>[e(V,null,{default:t(()=>[e(F(tt))]),_:1}),r[4]||(r[4]=l("span",null,"网站",-1))]),_:1}),e(P,{index:"/data"},{default:t(()=>[e(V,null,{default:t(()=>[e(F(ze))]),_:1}),r[5]||(r[5]=l("span",null,"数据",-1))]),_:1})]),_:1},8,["default-active","collapse"])])]),_:1},8,["width"]),e(u,null,{default:t(()=>[e(D,null,{default:t(()=>[l("div",wt,[l("div",Vt,[e(V,{class:"toggle-sidebar",onClick:o},{default:t(()=>[e(F(lt))]),_:1})]),r[6]||(r[6]=l("div",{class:"header-right"},null,-1))])]),_:1}),e(C,null,{default:t(()=>[e($)]),_:1})]),_:1})]),_:1})])}}},Ct=Z(kt,[["__scopeId","data-v-176fbaed"]]),Tt={class:"dashboard"},At={class:"dashboard-content"},Ut={class:"stat-card-content"},Pt={class:"stat-icon"},xt={class:"stat-info"},Mt={class:"stat-value"},St={class:"stat-footer"},Dt={class:"stat-detail"},Lt={class:"stat-card-content"},It={class:"stat-icon platform-icon"},zt={class:"stat-info"},Et={class:"stat-value"},Bt={class:"stat-footer"},Ft={class:"stat-detail"},Rt={class:"stat-card-content"},Ot={class:"stat-icon task-icon"},qt={class:"stat-info"},Kt={class:"stat-value"},Nt={class:"stat-footer"},jt={class:"stat-detail"},Ht={class:"stat-card-content"},Yt={class:"stat-icon content-icon"},Wt={class:"stat-info"},Xt={class:"stat-value"},Gt={class:"stat-footer"},Jt={class:"stat-detail"},Qt={class:"quick-actions"},Zt={class:"action-icon"},el={class:"action-icon"},tl={class:"action-icon"},ll={class:"action-icon"},al={class:"recent-tasks"},sl={class:"section-header"},ol={__name:"Dashboard",setup(a){const d=Ne(),i=ve({total:12,normal:10,abnormal:2}),p=ve({total:4,kuaishou:3,douyin:4,channels:2,xiaohongshu:3}),o=ve({total:24,completed:18,inProgress:5,failed:1}),n=ve({total:36,published:30,draft:6}),r=N([{id:1,title:"快手视频自动发布",platform:"快手",account:"快手账号1",createTime:"2024-05-01 10:30:00",status:"已完成"},{id:2,title:"抖音视频定时发布",platform:"抖音",account:"抖音账号1",createTime:"2024-05-01 11:15:00",status:"进行中"},{id:3,title:"视频号内容上传",platform:"视频号",account:"视频号账号1",createTime:"2024-05-01 14:20:00",status:"待执行"},{id:4,title:"小红书图文发布",platform:"小红书",account:"小红书账号1",createTime:"2024-05-01 16:45:00",status:"已失败"},{id:5,title:"快手短视频批量上传",platform:"快手",account:"快手账号2",createTime:"2024-05-02 09:10:00",status:"待执行"}]),V=C=>({快手:"success",抖音:"danger",视频号:"warning",小红书:"info"})[C]||"info",P=C=>({已完成:"success",进行中:"warning",待执行:"info",已失败:"danger"})[C]||"info",S=C=>{d.push(C)},x=C=>{A.info(`查看任务: ${C.title}`)},D=C=>{ye.confirm(`确定要执行任务 ${C.title} 吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"}).then(()=>{const u=r.value.findIndex(R=>R.id===C.id);u!==-1&&(r.value[u].status="进行中"),A({type:"success",message:"任务已开始执行"})}).catch(()=>{})},$=C=>{ye.confirm(`确定要取消任务 ${C.title} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const u=r.value.findIndex(R=>R.id===C.id);u!==-1&&(r.value[u].status="已取消"),A({type:"success",message:"任务已取消"})}).catch(()=>{})};return(C,u)=>{const R=_("el-icon"),E=_("el-card"),k=_("el-col"),I=_("el-tag"),b=_("el-tooltip"),y=_("el-row"),W=_("el-button"),j=_("el-table-column"),U=_("el-table");return c(),T("div",Tt,[u[19]||(u[19]=l("div",{class:"page-header"},[l("h1",null,"自媒体自动化运营系统")],-1)),l("div",At,[e(y,{gutter:20},{default:t(()=>[e(k,{span:6},{default:t(()=>[e(E,{class:"stat-card"},{default:t(()=>[l("div",Ut,[l("div",Pt,[e(R,null,{default:t(()=>[e(F(Ie))]),_:1})]),l("div",xt,[l("div",Mt,z(i.total),1),u[1]||(u[1]=l("div",{class:"stat-label"},"账号总数",-1))])]),l("div",St,[l("div",Dt,[l("span",null,"正常: "+z(i.normal),1),l("span",null,"异常: "+z(i.abnormal),1)])])]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(E,{class:"stat-card"},{default:t(()=>[l("div",Lt,[l("div",It,[e(R,null,{default:t(()=>[e(F(at))]),_:1})]),l("div",zt,[l("div",Et,z(p.total),1),u[2]||(u[2]=l("div",{class:"stat-label"},"平台总数",-1))])]),l("div",Bt,[l("div",Ft,[e(b,{content:"快手账号",placement:"top"},{default:t(()=>[e(I,{size:"small",type:"success"},{default:t(()=>[v(z(p.kuaishou),1)]),_:1})]),_:1}),e(b,{content:"抖音账号",placement:"top"},{default:t(()=>[e(I,{size:"small",type:"danger"},{default:t(()=>[v(z(p.douyin),1)]),_:1})]),_:1}),e(b,{content:"视频号账号",placement:"top"},{default:t(()=>[e(I,{size:"small",type:"warning"},{default:t(()=>[v(z(p.channels),1)]),_:1})]),_:1}),e(b,{content:"小红书账号",placement:"top"},{default:t(()=>[e(I,{size:"small",type:"info"},{default:t(()=>[v(z(p.xiaohongshu),1)]),_:1})]),_:1})])])]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(E,{class:"stat-card"},{default:t(()=>[l("div",Rt,[l("div",Ot,[e(R,null,{default:t(()=>[e(F(st))]),_:1})]),l("div",qt,[l("div",Kt,z(o.total),1),u[3]||(u[3]=l("div",{class:"stat-label"},"任务总数",-1))])]),l("div",Nt,[l("div",jt,[l("span",null,"完成: "+z(o.completed),1),l("span",null,"进行中: "+z(o.inProgress),1),l("span",null,"失败: "+z(o.failed),1)])])]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(E,{class:"stat-card"},{default:t(()=>[l("div",Ht,[l("div",Yt,[e(R,null,{default:t(()=>[e(F(ot))]),_:1})]),l("div",Wt,[l("div",Xt,z(n.total),1),u[4]||(u[4]=l("div",{class:"stat-label"},"内容总数",-1))])]),l("div",Gt,[l("div",Jt,[l("span",null,"已发布: "+z(n.published),1),l("span",null,"草稿: "+z(n.draft),1)])])]),_:1})]),_:1})]),_:1}),l("div",Qt,[u[13]||(u[13]=l("h2",null,"快捷操作",-1)),e(y,{gutter:20},{default:t(()=>[e(k,{span:6},{default:t(()=>[e(E,{class:"action-card",onClick:u[0]||(u[0]=h=>S("/account-management"))},{default:t(()=>[l("div",Zt,[e(R,null,{default:t(()=>[e(F(nt))]),_:1})]),u[5]||(u[5]=l("div",{class:"action-title"},"账号管理",-1)),u[6]||(u[6]=l("div",{class:"action-desc"},"管理所有平台账号",-1))]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(E,{class:"action-card"},{default:t(()=>[l("div",el,[e(R,null,{default:t(()=>[e(F(_e))]),_:1})]),u[7]||(u[7]=l("div",{class:"action-title"},"内容上传",-1)),u[8]||(u[8]=l("div",{class:"action-desc"},"上传视频和图文内容",-1))]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(E,{class:"action-card"},{default:t(()=>[l("div",tl,[e(R,null,{default:t(()=>[e(F(it))]),_:1})]),u[9]||(u[9]=l("div",{class:"action-title"},"定时发布",-1)),u[10]||(u[10]=l("div",{class:"action-desc"},"设置内容发布时间",-1))]),_:1})]),_:1}),e(k,{span:6},{default:t(()=>[e(E,{class:"action-card"},{default:t(()=>[l("div",ll,[e(R,null,{default:t(()=>[e(F(ze))]),_:1})]),u[11]||(u[11]=l("div",{class:"action-title"},"数据分析",-1)),u[12]||(u[12]=l("div",{class:"action-desc"},"查看内容数据分析",-1))]),_:1})]),_:1})]),_:1})]),l("div",al,[l("div",sl,[u[15]||(u[15]=l("h2",null,"最近任务",-1)),e(W,{text:""},{default:t(()=>[...u[14]||(u[14]=[v("查看全部",-1)])]),_:1})]),e(U,{data:r.value,style:{width:"100%"}},{default:t(()=>[e(j,{prop:"title",label:"任务名称",width:"250"}),e(j,{prop:"platform",label:"平台",width:"120"},{default:t(h=>[e(I,{type:V(h.row.platform),effect:"plain"},{default:t(()=>[v(z(h.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(j,{prop:"account",label:"账号",width:"150"}),e(j,{prop:"createTime",label:"创建时间",width:"180"}),e(j,{prop:"status",label:"状态",width:"120"},{default:t(h=>[e(I,{type:P(h.row.status),effect:"plain"},{default:t(()=>[v(z(h.row.status),1)]),_:2},1032,["type"])]),_:1}),e(j,{label:"操作"},{default:t(h=>[e(W,{size:"small",onClick:K=>x(h.row)},{default:t(()=>[...u[16]||(u[16]=[v("查看",-1)])]),_:1},8,["onClick"]),h.row.status==="待执行"?(c(),G(W,{key:0,size:"small",type:"primary",onClick:K=>D(h.row)},{default:t(()=>[...u[17]||(u[17]=[v(" 执行 ",-1)])]),_:1},8,["onClick"])):Y("",!0),h.row.status!=="已完成"&&h.row.status!=="已失败"?(c(),G(W,{key:1,size:"small",type:"danger",onClick:K=>$(h.row)},{default:t(()=>[...u[18]||(u[18]=[v(" 取消 ",-1)])]),_:1},8,["onClick"])):Y("",!0)]),_:1})]),_:1},8,["data"])])])])}}},nl=Z(ol,[["__scopeId","data-v-db5c2d61"]]),me=_t.create({baseURL:"http://localhost:5409",headers:{"Content-Type":"application/json"}});me.interceptors.request.use(a=>{const d=localStorage.getItem("token");return d&&(a.headers.Authorization=`Bearer ${d}`),a},a=>(console.error("请求错误:",a),Promise.reject(a)));me.interceptors.response.use(a=>{const{data:d}=a;return d.code===200||d.success?d:(A.error(d.message||"请求失败"),Promise.reject(new Error(d.message||"请求失败")))},a=>{if(console.error("响应错误:",a),a.response){const{status:d}=a.response;switch(d){case 401:A.error("未授权，请重新登录");break;case 403:A.error("拒绝访问");break;case 404:A.error("请求地址不存在");break;case 500:A.error("服务器内部错误");break;default:A.error("网络错误")}}else A.error("网络连接失败");return Promise.reject(a)});const ce={get(a,d){return me.get(a,{params:d})},post(a,d,i={}){return me.post(a,d,i)},put(a,d,i={}){return me.put(a,d,i)},delete(a,d){return me.delete(a,{params:d})},upload(a,d){return me.post(a,d,{headers:{"Content-Type":"multipart/form-data"}})}},Ve={getValidAccounts(a){return ce.get("/getValidAccounts",a)},addAccount(a){return ce.post("/account",a)},updateAccount(a){return ce.post("/updateUserinfo",a)},deleteAccount(a){return ce.get(`/deleteAccount?id=${a}`)},openAccounts(a){return ce.post("/openAccounts",{ids:a})}},Me=De("account",()=>{const a=N([]),d={1:"小红书",2:"视频号",3:"抖音",4:"快手",5:"B站"};return{accounts:a,setAccounts:V=>{a.value=V.map(P=>({id:P[0],type:P[1],filePath:P[2],name:P[3],status:P[4]===1?"正常":"异常",platform:d[P[1]]||"未知",avatar:"/vite.svg"}))},addAccount:V=>{a.value.push(V)},updateAccount:(V,P)=>{const S=a.value.findIndex(x=>x.id===V);S!==-1&&(a.value[S]={...a.value[S],...P})},deleteAccount:V=>{a.value=a.value.filter(P=>P.id!==V)},getAccountsByPlatform:V=>a.value.filter(P=>P.platform===V)}}),Te=De("app",()=>{const a=N(!0),d=N(!0),i=N(!1),p=N([]);return{isFirstTimeAccountManagement:a,isFirstTimeMaterialManagement:d,isAccountRefreshing:i,materials:p,setAccountManagementVisited:()=>{a.value=!1},setMaterialManagementVisited:()=>{d.value=!1},resetVisitStatus:()=>{a.value=!0,d.value=!0},setMaterials:D=>{p.value=D},addMaterial:D=>{p.value.push(D)},removeMaterial:D=>{const $=p.value.findIndex(C=>C.id===D);$>-1&&p.value.splice($,1)},setAccountRefreshing:D=>{i.value=D}}}),il={class:"account-management","element-loading-text":"正在验证账号..."},dl={class:"account-tabs"},ul={class:"account-list-container"},rl={class:"account-search"},cl={class:"action-buttons"},pl={class:"refresh-text"},ml={key:0,class:"account-list"},fl={key:1,class:"empty-data"},vl={class:"account-list-container"},_l={class:"account-search"},gl={class:"action-buttons"},yl={class:"refresh-text"},hl={key:0,class:"account-list"},bl={key:1,class:"empty-data"},$l={class:"account-list-container"},wl={class:"account-search"},Vl={class:"action-buttons"},kl={class:"refresh-text"},Cl={key:0,class:"account-list"},Tl={key:1,class:"empty-data"},Al={class:"account-list-container"},Ul={class:"account-search"},Pl={class:"action-buttons"},xl={class:"refresh-text"},Ml={key:0,class:"account-list"},Sl={key:1,class:"empty-data"},Dl={class:"account-list-container"},Ll={class:"account-search"},Il={class:"action-buttons"},zl={class:"refresh-text"},El={key:0,class:"account-list"},Bl={key:1,class:"empty-data"},Fl={class:"account-list-container"},Rl={class:"account-search"},Ol={class:"action-buttons"},ql={class:"refresh-text"},Kl={key:0,class:"account-list"},Nl={key:1,class:"empty-data"},jl={key:0,class:"qrcode-container"},Hl={key:0,class:"qrcode-wrapper"},Yl=["src"],Wl={key:1,class:"loading-wrapper"},Xl={key:2,class:"success-wrapper"},Gl={key:3,class:"error-wrapper"},Jl={class:"dialog-footer"},Ql={__name:"AccountManagement",setup(a){const d=Me(),i=Te(),p=N("all"),o=N(""),n=async(L=!1)=>{if(!i.isAccountRefreshing){i.setAccountRefreshing(!0);try{const s=await Ve.getValidAccounts({validate:L?1:0});s.code===200&&s.data?(d.setAccounts(s.data),L&&A.success("账号验证完成"),i.isFirstTimeAccountManagement&&i.setAccountManagementVisited()):A.error("获取账号数据失败")}catch(s){console.error("获取账号数据失败:",s),A.error("获取账号数据失败")}finally{i.setAccountRefreshing(!1)}}};xe(()=>{i.isFirstTimeAccountManagement&&n(!1)});const r=L=>({快手:"success",抖音:"danger",视频号:"warning",小红书:"info"})[L]||"info",V=J(()=>o.value?d.accounts.filter(L=>L.name.includes(o.value)):d.accounts),P=N([]),S=L=>{P.value=L.map(s=>s.id)},x=async()=>{var L;if(P.value.length)try{const s=await Ve.openAccounts(P.value);s.code===200?A.success(`已打开 ${((L=s.data)==null?void 0:L.opened)??P.value.length} 个标签页`):A.error(s.msg||"打开失败")}catch{A.error("打开失败")}},D=J(()=>V.value.filter(L=>L.platform==="快手")),$=J(()=>V.value.filter(L=>L.platform==="抖音")),C=J(()=>V.value.filter(L=>L.platform==="视频号")),u=J(()=>V.value.filter(L=>L.platform==="小红书")),R=J(()=>V.value.filter(L=>L.platform==="B站")),E=()=>{},k=N(!1),I=N("add"),b=N(null),y=ve({id:null,name:"",platform:"",status:"正常"}),W={platform:[{required:!0,message:"请选择平台",trigger:"change"}],name:[{required:!0,message:"请输入账号名称",trigger:"blur"}]},j=N(!1),U=N(""),h=N(""),K=()=>{I.value="add",Object.assign(y,{id:null,name:"",platform:"",status:"正常"}),j.value=!1,U.value="",h.value="",k.value=!0},H=L=>{ye.confirm(`确定要删除账号 ${L.name} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const s=await Ve.deleteAccount(L.id);s.code===200?(d.deleteAccount(L.id),A({type:"success",message:"删除成功"})):A.error(s.msg||"删除失败")}catch(s){console.error("删除账号失败:",s),A.error("删除账号失败")}}).catch(()=>{})};let X=null;const ee=()=>{X&&(X.close(),X=null)},w=(L,s,q=null)=>{ee(),j.value=!0,U.value="",h.value="";const f={小红书:"1",视频号:"2",抖音:"3",快手:"4",B站:"5"}[L]||"1",m="http://localhost:5409",Q=new URLSearchParams({type:f,id:s});q&&(Q.append("update","1"),Q.append("record_id",String(q)));const ae=`${m}/login?${Q.toString()}`;X=new EventSource(ae),X.onmessage=ie=>{const te=ie.data;if(console.log("SSE消息:",te),!U.value&&te.length>100)try{te.startsWith("data:image")?U.value=te:U.value=`data:image/png;base64,${te}`,console.log("设置二维码数据，长度:",te.length)}catch(ue){console.error("处理二维码数据出错:",ue)}else(te==="200"||te==="500")&&(h.value=te,te==="200"?setTimeout(()=>{ee(),setTimeout(()=>{k.value=!1,j.value=!1,A.success(q?"账号更新成功":"账号添加成功"),A({type:"info",message:"正在同步账号信息...",duration:0}),n().then(()=>{A.closeAll(),A.success("账号信息已更新")})},1e3)},1e3):(ee(),setTimeout(()=>{j.value=!1,U.value="",h.value=""},2e3)))},X.onerror=ie=>{console.error("SSE连接错误:",ie),A.error("连接服务器失败，请稍后再试"),ee(),j.value=!1}},M=()=>{b.value.validate(async L=>{if(L)I.value==="add"?w(y.platform,y.name,y.id):A.info("编辑功能已取消，请删除后重新添加");else return!1})},O=L=>{I.value="add",Object.assign(y,{id:L.id,platform:L.platform,name:L.name,status:"正常"}),j.value=!1,U.value="",h.value="",k.value=!0};return je(()=>{ee()}),(L,s)=>{const q=_("el-input"),B=_("el-button"),f=_("el-icon"),m=_("el-table-column"),Q=_("el-avatar"),ae=_("el-tag"),ie=_("el-table"),te=_("el-empty"),ue=_("el-tab-pane"),Be=_("el-tabs"),ge=_("el-option"),Fe=_("el-select"),Se=_("el-form-item"),Re=_("el-form"),Oe=_("el-dialog"),qe=He("loading");return ke((c(),T("div",il,[s[41]||(s[41]=l("div",{class:"page-header"},[l("h1",null,"账号管理")],-1)),l("div",dl,[e(Be,{modelValue:p.value,"onUpdate:modelValue":s[12]||(s[12]=g=>p.value=g),class:"account-tabs-nav"},{default:t(()=>[e(ue,{label:"全部",name:"all"},{default:t(()=>[l("div",ul,[l("div",rl,[e(q,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=g=>o.value=g),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:E,onInput:E},null,8,["modelValue"]),l("div",cl,[e(B,{type:"primary",onClick:K},{default:t(()=>[...s[17]||(s[17]=[v("添加账号",-1)])]),_:1}),e(B,{type:"success",onClick:x,disabled:P.value.length===0},{default:t(()=>[...s[18]||(s[18]=[v("作品查看",-1)])]),_:1},8,["disabled"]),e(B,{type:"info",onClick:s[1]||(s[1]=()=>n(!0))},{default:t(()=>[e(f,{class:de({"is-loading":F(i).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(F(re))]),_:1},8,["class"]),l("span",pl,z(F(i).isAccountRefreshing?"验证中...":"过期验证"),1)]),_:1})])]),V.value.length>0?(c(),T("div",ml,[e(ie,{data:V.value,style:{width:"100%"},onSelectionChange:S},{default:t(()=>[e(m,{type:"selection",width:"55"}),e(m,{label:"头像",width:"80"},{default:t(g=>[e(Q,{src:g.row.avatar,size:40},null,8,["src"])]),_:1}),e(m,{prop:"name",label:"名称",width:"180"}),e(m,{prop:"platform",label:"平台"},{default:t(g=>[e(ae,{type:r(g.row.platform),effect:"plain"},{default:t(()=>[v(z(g.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"status",label:"状态"},{default:t(g=>[e(ae,{type:g.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[v(z(g.row.status),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作"},{default:t(g=>[g.row.status!=="正常"?(c(),G(B,{key:0,size:"small",type:"warning",onClick:ne=>O(g.row)},{default:t(()=>[...s[19]||(s[19]=[v("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(B,{size:"small",type:"danger",onClick:ne=>H(g.row)},{default:t(()=>[...s[20]||(s[20]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(c(),T("div",fl,[e(te,{description:"暂无账号数据"})]))])]),_:1}),e(ue,{label:"快手",name:"kuaishou"},{default:t(()=>[l("div",vl,[l("div",_l,[e(q,{modelValue:o.value,"onUpdate:modelValue":s[2]||(s[2]=g=>o.value=g),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:E,onInput:E},null,8,["modelValue"]),l("div",gl,[e(B,{type:"primary",onClick:K},{default:t(()=>[...s[21]||(s[21]=[v("添加账号",-1)])]),_:1}),e(B,{type:"info",onClick:s[3]||(s[3]=()=>n(!0))},{default:t(()=>[e(f,{class:de({"is-loading":F(i).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(F(re))]),_:1},8,["class"]),l("span",yl,z(F(i).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),D.value.length>0?(c(),T("div",hl,[e(ie,{data:D.value,style:{width:"100%"}},{default:t(()=>[e(m,{label:"头像",width:"80"},{default:t(g=>[e(Q,{src:g.row.avatar,size:40},null,8,["src"])]),_:1}),e(m,{prop:"name",label:"名称",width:"180"}),e(m,{prop:"platform",label:"平台"},{default:t(g=>[e(ae,{type:r(g.row.platform),effect:"plain"},{default:t(()=>[v(z(g.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"status",label:"状态"},{default:t(g=>[e(ae,{type:g.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[v(z(g.row.status),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作"},{default:t(g=>[g.row.status!=="正常"?(c(),G(B,{key:0,size:"small",type:"warning",onClick:ne=>O(g.row)},{default:t(()=>[...s[22]||(s[22]=[v("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(B,{size:"small",type:"danger",onClick:ne=>H(g.row)},{default:t(()=>[...s[23]||(s[23]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(c(),T("div",bl,[e(te,{description:"暂无快手账号数据"})]))])]),_:1}),e(ue,{label:"抖音",name:"douyin"},{default:t(()=>[l("div",$l,[l("div",wl,[e(q,{modelValue:o.value,"onUpdate:modelValue":s[4]||(s[4]=g=>o.value=g),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:E,onInput:E},null,8,["modelValue"]),l("div",Vl,[e(B,{type:"primary",onClick:K},{default:t(()=>[...s[24]||(s[24]=[v("添加账号",-1)])]),_:1}),e(B,{type:"info",onClick:s[5]||(s[5]=()=>n(!0))},{default:t(()=>[e(f,{class:de({"is-loading":F(i).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(F(re))]),_:1},8,["class"]),l("span",kl,z(F(i).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),$.value.length>0?(c(),T("div",Cl,[e(ie,{data:$.value,style:{width:"100%"}},{default:t(()=>[e(m,{label:"头像",width:"80"},{default:t(g=>[e(Q,{src:g.row.avatar,size:40},null,8,["src"])]),_:1}),e(m,{prop:"name",label:"名称",width:"180"}),e(m,{prop:"platform",label:"平台"},{default:t(g=>[e(ae,{type:r(g.row.platform),effect:"plain"},{default:t(()=>[v(z(g.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"status",label:"状态"},{default:t(g=>[e(ae,{type:g.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[v(z(g.row.status),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作"},{default:t(g=>[g.row.status!=="正常"?(c(),G(B,{key:0,size:"small",type:"warning",onClick:ne=>O(g.row)},{default:t(()=>[...s[25]||(s[25]=[v("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(B,{size:"small",type:"danger",onClick:ne=>H(g.row)},{default:t(()=>[...s[26]||(s[26]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(c(),T("div",Tl,[e(te,{description:"暂无抖音账号数据"})]))])]),_:1}),e(ue,{label:"视频号",name:"channels"},{default:t(()=>[l("div",Al,[l("div",Ul,[e(q,{modelValue:o.value,"onUpdate:modelValue":s[6]||(s[6]=g=>o.value=g),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:E,onInput:E},null,8,["modelValue"]),l("div",Pl,[e(B,{type:"primary",onClick:K},{default:t(()=>[...s[27]||(s[27]=[v("添加账号",-1)])]),_:1}),e(B,{type:"info",onClick:s[7]||(s[7]=()=>n(!0))},{default:t(()=>[e(f,{class:de({"is-loading":F(i).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(F(re))]),_:1},8,["class"]),l("span",xl,z(F(i).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),C.value.length>0?(c(),T("div",Ml,[e(ie,{data:C.value,style:{width:"100%"}},{default:t(()=>[e(m,{label:"头像",width:"80"},{default:t(g=>[e(Q,{src:g.row.avatar,size:40},null,8,["src"])]),_:1}),e(m,{prop:"name",label:"名称",width:"180"}),e(m,{prop:"platform",label:"平台"},{default:t(g=>[e(ae,{type:r(g.row.platform),effect:"plain"},{default:t(()=>[v(z(g.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"status",label:"状态"},{default:t(g=>[e(ae,{type:g.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[v(z(g.row.status),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作"},{default:t(g=>[g.row.status!=="正常"?(c(),G(B,{key:0,size:"small",type:"warning",onClick:ne=>O(g.row)},{default:t(()=>[...s[28]||(s[28]=[v("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(B,{size:"small",type:"danger",onClick:ne=>H(g.row)},{default:t(()=>[...s[29]||(s[29]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(c(),T("div",Sl,[e(te,{description:"暂无视频号账号数据"})]))])]),_:1}),e(ue,{label:"小红书",name:"xiaohongshu"},{default:t(()=>[l("div",Dl,[l("div",Ll,[e(q,{modelValue:o.value,"onUpdate:modelValue":s[8]||(s[8]=g=>o.value=g),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:E,onInput:E},null,8,["modelValue"]),l("div",Il,[e(B,{type:"primary",onClick:K},{default:t(()=>[...s[30]||(s[30]=[v("添加账号",-1)])]),_:1}),e(B,{type:"info",onClick:s[9]||(s[9]=()=>n(!0))},{default:t(()=>[e(f,{class:de({"is-loading":F(i).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(F(re))]),_:1},8,["class"]),l("span",zl,z(F(i).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),u.value.length>0?(c(),T("div",El,[e(ie,{data:u.value,style:{width:"100%"}},{default:t(()=>[e(m,{label:"头像",width:"80"},{default:t(g=>[e(Q,{src:g.row.avatar,size:40},null,8,["src"])]),_:1}),e(m,{prop:"name",label:"名称",width:"180"}),e(m,{prop:"platform",label:"平台"},{default:t(g=>[e(ae,{type:r(g.row.platform),effect:"plain"},{default:t(()=>[v(z(g.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"status",label:"状态"},{default:t(g=>[e(ae,{type:g.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[v(z(g.row.status),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作"},{default:t(g=>[g.row.status!=="正常"?(c(),G(B,{key:0,size:"small",type:"warning",onClick:ne=>O(g.row)},{default:t(()=>[...s[31]||(s[31]=[v("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(B,{size:"small",type:"danger",onClick:ne=>H(g.row)},{default:t(()=>[...s[32]||(s[32]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(c(),T("div",Bl,[e(te,{description:"暂无小红书账号数据"})]))])]),_:1}),e(ue,{label:"B站",name:"bilibili"},{default:t(()=>[l("div",Fl,[l("div",Rl,[e(q,{modelValue:o.value,"onUpdate:modelValue":s[10]||(s[10]=g=>o.value=g),placeholder:"输入名称或账号搜索","prefix-icon":"Search",clearable:"",onClear:E,onInput:E},null,8,["modelValue"]),l("div",Ol,[e(B,{type:"primary",onClick:K},{default:t(()=>[...s[33]||(s[33]=[v("添加账号",-1)])]),_:1}),e(B,{type:"info",onClick:s[11]||(s[11]=()=>n(!0))},{default:t(()=>[e(f,{class:de({"is-loading":F(i).isAccountRefreshing,"refresh-icon":!0})},{default:t(()=>[e(F(re))]),_:1},8,["class"]),l("span",ql,z(F(i).isAccountRefreshing?"验证中...":"手动过期验证"),1)]),_:1})])]),R.value.length>0?(c(),T("div",Kl,[e(ie,{data:R.value,style:{width:"100%"}},{default:t(()=>[e(m,{label:"头像",width:"80"},{default:t(g=>[e(Q,{src:g.row.avatar,size:40},null,8,["src"])]),_:1}),e(m,{prop:"name",label:"名称",width:"180"}),e(m,{prop:"platform",label:"平台"},{default:t(g=>[e(ae,{type:r(g.row.platform),effect:"plain"},{default:t(()=>[v(z(g.row.platform),1)]),_:2},1032,["type"])]),_:1}),e(m,{prop:"status",label:"状态"},{default:t(g=>[e(ae,{type:g.row.status==="正常"?"success":"danger",effect:"plain"},{default:t(()=>[v(z(g.row.status),1)]),_:2},1032,["type"])]),_:1}),e(m,{label:"操作"},{default:t(g=>[g.row.status!=="正常"?(c(),G(B,{key:0,size:"small",type:"warning",onClick:ne=>O(g.row)},{default:t(()=>[...s[34]||(s[34]=[v("重新添加",-1)])]),_:1},8,["onClick"])):Y("",!0),e(B,{size:"small",type:"danger",onClick:ne=>H(g.row)},{default:t(()=>[...s[35]||(s[35]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(c(),T("div",Nl,[e(te,{description:"暂无B站账号数据"})]))])]),_:1})]),_:1},8,["modelValue"])]),e(Oe,{modelValue:k.value,"onUpdate:modelValue":s[16]||(s[16]=g=>k.value=g),title:I.value==="add"?"添加账号":"编辑账号",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!j.value,"show-close":!j.value},{footer:t(()=>[l("span",Jl,[e(B,{onClick:s[15]||(s[15]=g=>k.value=!1)},{default:t(()=>[...s[40]||(s[40]=[v("取消",-1)])]),_:1}),e(B,{type:"primary",onClick:M,loading:j.value,disabled:j.value},{default:t(()=>[v(z(j.value?"请求中":"确认"),1)]),_:1},8,["loading","disabled"])])]),default:t(()=>[e(Re,{model:y,"label-width":"80px",rules:W,ref_key:"accountFormRef",ref:b},{default:t(()=>[e(Se,{label:"平台",prop:"platform"},{default:t(()=>[e(Fe,{modelValue:y.platform,"onUpdate:modelValue":s[13]||(s[13]=g=>y.platform=g),placeholder:"请选择平台",style:{width:"100%"},disabled:I.value==="edit"||j.value},{default:t(()=>[e(ge,{label:"快手",value:"快手"}),e(ge,{label:"抖音",value:"抖音"}),e(ge,{label:"视频号",value:"视频号"}),e(ge,{label:"小红书",value:"小红书"}),e(ge,{label:"B站",value:"B站"})]),_:1},8,["modelValue","disabled"])]),_:1}),e(Se,{label:"名称",prop:"name"},{default:t(()=>[e(q,{modelValue:y.name,"onUpdate:modelValue":s[14]||(s[14]=g=>y.name=g),placeholder:"请输入账号名称",disabled:j.value},null,8,["modelValue","disabled"])]),_:1}),j.value?(c(),T("div",jl,[U.value&&!h.value?(c(),T("div",Hl,[s[36]||(s[36]=l("p",{class:"qrcode-tip"},"请使用对应平台APP扫描二维码登录",-1)),l("img",{src:U.value,alt:"登录二维码",class:"qrcode-image"},null,8,Yl)])):!U.value&&!h.value?(c(),T("div",Wl,[e(f,{class:"is-loading"},{default:t(()=>[e(F(re))]),_:1}),s[37]||(s[37]=l("span",null,"请求中...",-1))])):h.value==="200"?(c(),T("div",Xl,[e(f,null,{default:t(()=>[e(F(dt))]),_:1}),s[38]||(s[38]=l("span",null,"添加成功",-1))])):h.value==="500"?(c(),T("div",Gl,[e(f,null,{default:t(()=>[e(F(ut))]),_:1}),s[39]||(s[39]=l("span",null,"添加失败，请稍后再试",-1))])):Y("",!0)])):Y("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title","close-on-press-escape","show-close"])])),[[qe,F(i).isAccountRefreshing]])}}},Zl=Z(Ql,[["__scopeId","data-v-7d2f1e54"]]),pe={getAllMaterials:()=>ce.get("/getFiles"),uploadMaterial:a=>ce.upload("/uploadSave",a),deleteMaterial:a=>ce.get(`/deleteFile?id=${a}`),downloadMaterial:a=>`http://localhost:5409/download/${a}`,getMaterialPreviewUrl:a=>`http://localhost:5409/getFile?filename=${a}`},ea={class:"material-management"},ta={class:"material-list-container"},la={class:"material-search"},aa={class:"action-buttons"},sa={key:0},oa={key:0,class:"material-list"},na={key:1,class:"empty-data"},ia={class:"upload-form"},da={class:"dialog-footer"},ua={key:0,class:"preview-container"},ra={key:0,class:"video-preview"},ca={controls:"",style:{"max-width":"100%","max-height":"60vh"}},pa=["src"],ma={key:1,class:"image-preview"},fa=["src"],va={key:2,class:"file-info"},_a={__name:"MaterialManagement",setup(a){const d=Te(),i=N(""),p=N(!1),o=N(!1),n=N(!1),r=N(!1),V=N(null),P=N([]),S=N(""),x=async()=>{p.value=!0;try{const U=await pe.getAllMaterials();U.code===200?(d.setMaterials(U.data),A.success("刷新成功")):A.error("获取素材列表失败")}catch(U){console.error("获取素材列表出错:",U),A.error("获取素材列表失败")}finally{p.value=!1}},D=J(()=>{if(!i.value)return d.materials;const U=i.value.toLowerCase();return d.materials.filter(h=>h.filename.toLowerCase().includes(U))}),$=()=>{},C=()=>{P.value=[],S.value="",n.value=!0},u=()=>{P.value=[],S.value=""},R=(U,h)=>{console.log("选择的文件:",U),U.raw&&(P.value=[U])},E=async()=>{if(P.value.length===0){A.warning("请选择要上传的文件");return}const U=P.value[0];if(!U||!U.raw){A.warning("文件对象无效，请重新选择文件");return}o.value=!0;try{const h=new FormData;console.log("上传文件对象:",U.raw),h.append("file",U.raw),S.value.trim()&&(h.append("filename",S.value.trim()),console.log("自定义文件名:",S.value.trim()));const K=await pe.uploadMaterial(h);K.code===200?(A.success("上传成功"),n.value=!1,await x()):A.error(K.msg||"上传失败")}catch(h){console.error("上传素材出错:",h),A.error("上传失败: "+(h.message||"未知错误"))}finally{o.value=!1}},k=async U=>{V.value=null,r.value=!0,A.info("加载中...");try{await new Promise(h=>setTimeout(h,100)),V.value=U}catch(h){console.error("预览素材出错:",h),A.error("预览加载失败"),r.value=!1}},I=U=>{ye.confirm(`确定要删除素材 ${U.filename} 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{const h=await pe.deleteMaterial(U.id);h.code===200?(d.removeMaterial(U.id),A.success("删除成功")):A.error(h.msg||"删除失败")}catch(h){console.error("删除素材出错:",h),A.error("删除失败")}}).catch(()=>{})},b=U=>{const h=U.split("/").pop();return pe.getMaterialPreviewUrl(h)},y=U=>{const h=pe.downloadMaterial(U.file_path);window.open(h,"_blank")},W=U=>[".mp4",".avi",".mov",".wmv",".flv",".mkv"].some(K=>U.toLowerCase().endsWith(K)),j=U=>[".jpg",".jpeg",".png",".gif",".bmp",".webp"].some(K=>U.toLowerCase().endsWith(K));return xe(()=>{d.materials.length===0&&x()}),(U,h)=>{const K=_("el-input"),H=_("el-button"),X=_("el-icon"),ee=_("el-table-column"),w=_("el-table"),M=_("el-empty"),O=_("el-form-item"),L=_("el-upload"),s=_("el-form"),q=_("el-dialog");return c(),T("div",ea,[h[14]||(h[14]=l("div",{class:"page-header"},[l("h1",null,"素材管理")],-1)),l("div",ta,[l("div",la,[e(K,{modelValue:i.value,"onUpdate:modelValue":h[0]||(h[0]=B=>i.value=B),placeholder:"输入文件名搜索","prefix-icon":"Search",clearable:"",onClear:$,onInput:$},null,8,["modelValue"]),l("div",aa,[e(H,{type:"primary",onClick:C},{default:t(()=>[...h[6]||(h[6]=[v("上传素材",-1)])]),_:1}),e(H,{type:"info",onClick:x,loading:!1},{default:t(()=>[e(X,{class:de({"is-loading":p.value})},{default:t(()=>[e(F(re))]),_:1},8,["class"]),p.value?(c(),T("span",sa,"刷新中")):Y("",!0)]),_:1})])]),D.value.length>0?(c(),T("div",oa,[e(w,{data:D.value,style:{width:"100%"}},{default:t(()=>[e(ee,{prop:"filename",label:"文件名",width:"300"}),e(ee,{prop:"filesize",label:"文件大小",width:"120"},{default:t(B=>[v(z(B.row.filesize)+" MB ",1)]),_:1}),e(ee,{prop:"upload_time",label:"上传时间",width:"180"}),e(ee,{label:"操作"},{default:t(B=>[e(H,{size:"small",onClick:f=>k(B.row)},{default:t(()=>[...h[7]||(h[7]=[v("预览",-1)])]),_:1},8,["onClick"]),e(H,{size:"small",type:"danger",onClick:f=>I(B.row)},{default:t(()=>[...h[8]||(h[8]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])])):(c(),T("div",na,[e(M,{description:"暂无素材数据"})]))]),e(q,{modelValue:n.value,"onUpdate:modelValue":h[3]||(h[3]=B=>n.value=B),title:"上传素材",width:"40%",onClose:u},{footer:t(()=>[l("div",da,[e(H,{onClick:h[2]||(h[2]=B=>n.value=!1)},{default:t(()=>[...h[11]||(h[11]=[v("取消",-1)])]),_:1}),e(H,{type:"primary",onClick:E,loading:o.value},{default:t(()=>[v(z(o.value?"上传中":"确认上传"),1)]),_:1},8,["loading"])])]),default:t(()=>[l("div",ia,[e(s,{"label-width":"80px"},{default:t(()=>[e(O,{label:"文件名称:"},{default:t(()=>[e(K,{modelValue:S.value,"onUpdate:modelValue":h[1]||(h[1]=B=>S.value=B),placeholder:"选填",clearable:""},null,8,["modelValue"])]),_:1}),e(O,{label:"选择文件"},{default:t(()=>[e(L,{class:"upload-demo",drag:"","auto-upload":!1,"on-change":R,"file-list":P.value,limit:1},{tip:t(()=>[...h[9]||(h[9]=[l("div",{class:"el-upload__tip"}," 支持视频、图片等格式文件，只能上传一个文件 ",-1)])]),default:t(()=>[e(X,{class:"el-icon--upload"},{default:t(()=>[e(F(_e))]),_:1}),h[10]||(h[10]=l("div",{class:"el-upload__text"},[v(" 将文件拖到此处，或"),l("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1})]),_:1})])]),_:1},8,["modelValue"]),e(q,{modelValue:r.value,"onUpdate:modelValue":h[5]||(h[5]=B=>r.value=B),title:"素材预览",width:"50%",top:"10vh"},{default:t(()=>[V.value?(c(),T("div",ua,[W(V.value.filename)?(c(),T("div",ra,[l("video",ca,[l("source",{src:b(V.value.file_path),type:"video/mp4"},null,8,pa),h[12]||(h[12]=v(" 您的浏览器不支持视频播放 ",-1))])])):j(V.value.filename)?(c(),T("div",ma,[l("img",{src:b(V.value.file_path),style:{"max-width":"100%","max-height":"60vh"}},null,8,fa)])):(c(),T("div",va,[l("p",null,"文件名: "+z(V.value.filename),1),l("p",null,"文件大小: "+z(V.value.filesize)+" MB",1),l("p",null,"上传时间: "+z(V.value.upload_time),1),e(H,{type:"primary",onClick:h[4]||(h[4]=B=>y(V.value))},{default:t(()=>[...h[13]||(h[13]=[v("下载文件",-1)])]),_:1})]))])):Y("",!0)]),_:1},8,["modelValue"])])}}},ga=Z(_a,[["__scopeId","data-v-3d75da5e"]]),Ce={DOUYIN:{key:3,name:"抖音",titleLimit:30,topicLimit:5,titlePlaceholder:"请输入标题（最多30字）",topicPlaceholder:"最多可添加5个话题"},KUAISHOU:{key:4,name:"快手",titleLimit:30,topicLimit:3,titlePlaceholder:"请输入标题（最多30字）",topicPlaceholder:"最多可添加3个话题"},WEIXIN:{key:2,name:"视频号",titleLimit:16,topicLimit:20,titlePlaceholder:"请输入标题（最多16字）",topicPlaceholder:"最多可添加20个话题"},XIAOHONGSHU:{key:1,name:"小红书",titleLimit:20,topicLimit:10,titlePlaceholder:"请输入标题（最多20字）",topicPlaceholder:"最多可添加10个话题"}};Ce.BILIBILI={key:5,name:"B站",titleLimit:80,topicLimit:10,titlePlaceholder:"请输入标题（最多80字）",topicPlaceholder:"最多可添加10个话题"};function he(a){return Object.values(Ce).find(d=>d.key===a)||Ce.XIAOHONGSHU}function ya(){return Object.values(Ce)}function Ue(a,d){const i=he(d);return!a||!a.trim()?{valid:!1,message:"请输入标题"}:a.length>i.titleLimit?{valid:!1,message:`标题不能超过${i.titleLimit}字，当前${a.length}字`}:{valid:!0,message:""}}function Pe(a,d){const i=he(d);return Array.isArray(a)?a.length>i.topicLimit?{valid:!1,message:`最多只能添加${i.topicLimit}个话题，当前${a.length}个`}:{valid:!0,message:""}:{valid:!1,message:"话题格式错误"}}function ha(a){return!a||!a.trim()?{valid:!1,message:"话题内容不能为空"}:a.length>20?{valid:!1,message:"单个话题不能超过20字"}:/[<>{}[\]()&$#@!%^*+=|\\/]/g.test(a)?{valid:!1,message:"话题不能包含特殊字符"}:{valid:!0,message:""}}function ba(a){const d={};let i=!0;(!a.fileList||a.fileList.length===0)&&(d.fileList="请先上传视频文件",i=!1);const p=Ue(a.title,a.selectedPlatform);p.valid||(d.title=p.message,i=!1),a.selectedPlatform||(d.platform="请选择发布平台",i=!1),(!a.selectedAccounts||a.selectedAccounts.length===0)&&(d.accounts="请选择发布账号",i=!1);const o=Pe(a.selectedTopics,a.selectedPlatform);return o.valid||(d.topics=o.message,i=!1),a.scheduleEnabled&&((!a.videosPerDay||a.videosPerDay<1||a.videosPerDay>55)&&(d.videosPerDay="每天发布视频数必须在1-55之间",i=!1),(!a.dailyTimes||a.dailyTimes.length===0)&&(d.dailyTimes="请设置发布时间",i=!1),a.dailyTimes&&a.dailyTimes.length!==a.videosPerDay&&(d.dailyTimes="发布时间数量必须与每天发布视频数一致",i=!1),(a.startDays===void 0||a.startDays<0)&&(d.startDays="请选择开始天数",i=!1)),{valid:i,errors:d}}const $a={class:"tab-management"},wa={class:"tab-header"},Va={class:"tab-list"},ka=["onClick"],Ca={class:"tab-actions"},Ta={__name:"TabManagement",props:{tabs:{type:Array,required:!0},activeTab:{type:String,required:!0},batchPublishing:{type:Boolean,default:!1}},emits:["tab-change","remove-tab","add-tab","batch-publish"],setup(a){return(d,i)=>{const p=_("el-icon"),o=_("el-button");return c(),T("div",$a,[l("div",wa,[l("div",Va,[(c(!0),T(se,null,oe(a.tabs,n=>(c(),T("div",{key:n.name,class:de(["tab-item",{active:a.activeTab===n.name}]),onClick:r=>d.$emit("tab-change",n.name)},[l("span",null,z(n.label),1),a.tabs.length>1?(c(),G(p,{key:0,class:"close-icon",onClick:Ye(r=>d.$emit("remove-tab",n.name),["stop"])},{default:t(()=>[e(F(Ee))]),_:1},8,["onClick"])):Y("",!0)],10,ka))),128))]),l("div",Ca,[e(o,{type:"primary",size:"small",onClick:i[0]||(i[0]=n=>d.$emit("add-tab")),class:"add-tab-btn"},{default:t(()=>[e(p,null,{default:t(()=>[e(F(rt))]),_:1}),i[2]||(i[2]=v(" 添加Tab ",-1))]),_:1}),e(o,{type:"success",size:"small",onClick:i[1]||(i[1]=n=>d.$emit("batch-publish")),loading:a.batchPublishing,class:"batch-publish-btn"},{default:t(()=>[...i[3]||(i[3]=[v(" 批量发布 ",-1)])]),_:1},8,["loading"])])])])}}},Aa=Z(Ta,[["__scopeId","data-v-7584dadb"]]),Ua={class:"upload-section"},Pa={class:"upload-options"},xa={key:0,class:"uploaded-files"},Ma={class:"file-list"},Sa={class:"file-size"},Da={class:"upload-options-content"},La={class:"material-library-content"},Ia={class:"material-list"},za={class:"material-info"},Ea={class:"material-name"},Ba={class:"material-details"},Fa={class:"file-size"},Ra={class:"upload-time"},Oa={class:"dialog-footer"},qa={__name:"VideoUpload",props:{fileList:{type:Array,default:()=>[]},uploadAction:{type:String,required:!0},authHeaders:{type:Object,required:!0},materials:{type:Array,default:()=>[]}},emits:["show-upload-options","remove-file","upload-success","material-selected"],setup(a,{expose:d,emit:i}){const p=a,o=i,n=Te(),r=N(!1),V=N(!1),P=N(!1),S=N([]),x=()=>{r.value=!1,V.value=!0},D=async()=>{if(r.value=!1,p.materials.length===0)try{const E=await pe.getAllMaterials();if(E.code===200)n.setMaterials(E.data);else{A.error("获取素材列表失败");return}}catch(E){console.error("获取素材列表出错:",E),A.error("获取素材列表失败");return}S.value=[],P.value=!0},$=(E,k)=>{E.code===200?(o("upload-success",E,k),V.value=!1,A.success("文件上传成功")):A.error(E.msg||"上传失败")},C=E=>{A.error("文件上传失败"),console.error("上传错误:",E)},u=()=>{if(S.value.length===0){A.warning("请选择至少一个素材");return}o("material-selected",S.value);const E=S.value.length;P.value=!1,S.value=[],A.success(`已添加 ${E} 个素材`)},R=()=>{r.value=!0};return d({showUploadOptions:R}),(E,k)=>{const I=_("el-icon"),b=_("el-button"),y=_("el-link"),W=_("el-dialog"),j=_("el-upload"),U=_("el-checkbox"),h=_("el-checkbox-group");return c(),T("div",Ua,[k[14]||(k[14]=l("h3",null,"视频",-1)),l("div",Pa,[e(b,{type:"primary",onClick:R,class:"upload-btn"},{default:t(()=>[e(I,null,{default:t(()=>[e(F(_e))]),_:1}),k[5]||(k[5]=v(" 上传视频 ",-1))]),_:1})]),a.fileList.length>0?(c(),T("div",xa,[k[7]||(k[7]=l("h4",null,"已上传文件：",-1)),l("div",Ma,[(c(!0),T(se,null,oe(a.fileList,(K,H)=>(c(),T("div",{key:H,class:"file-item"},[e(y,{href:K.url,target:"_blank",type:"primary"},{default:t(()=>[v(z(K.name),1)]),_:2},1032,["href"]),l("span",Sa,z((K.size/1024/1024).toFixed(2))+"MB",1),e(b,{type:"danger",size:"small",onClick:X=>E.$emit("remove-file",H)},{default:t(()=>[...k[6]||(k[6]=[v("删除",-1)])]),_:1},8,["onClick"])]))),128))])])):Y("",!0),e(W,{modelValue:r.value,"onUpdate:modelValue":k[0]||(k[0]=K=>r.value=K),title:"选择上传方式",width:"400px",class:"upload-options-dialog"},{default:t(()=>[l("div",Da,[e(b,{type:"primary",onClick:x,class:"option-btn"},{default:t(()=>[e(I,null,{default:t(()=>[e(F(_e))]),_:1}),k[8]||(k[8]=v(" 本地上传 ",-1))]),_:1}),e(b,{type:"success",onClick:D,class:"option-btn"},{default:t(()=>[e(I,null,{default:t(()=>[e(F(ct))]),_:1}),k[9]||(k[9]=v(" 素材库 ",-1))]),_:1})])]),_:1},8,["modelValue"]),e(W,{modelValue:V.value,"onUpdate:modelValue":k[1]||(k[1]=K=>V.value=K),title:"本地上传",width:"600px",class:"local-upload-dialog"},{default:t(()=>[e(j,{class:"video-upload",drag:"","auto-upload":!0,action:a.uploadAction,"on-success":$,"on-error":C,multiple:"",accept:"video/*",headers:a.authHeaders},{tip:t(()=>[...k[10]||(k[10]=[l("div",{class:"el-upload__tip"}," 支持MP4、AVI等视频格式，可上传多个文件 ",-1)])]),default:t(()=>[e(I,{class:"el-icon--upload"},{default:t(()=>[e(F(_e))]),_:1}),k[11]||(k[11]=l("div",{class:"el-upload__text"},[v(" 将视频文件拖到此处，或"),l("em",null,"点击上传")],-1))]),_:1},8,["action","headers"])]),_:1},8,["modelValue"]),e(W,{modelValue:P.value,"onUpdate:modelValue":k[4]||(k[4]=K=>P.value=K),title:"选择素材",width:"800px",class:"material-library-dialog"},{footer:t(()=>[l("div",Oa,[e(b,{onClick:k[3]||(k[3]=K=>P.value=!1)},{default:t(()=>[...k[12]||(k[12]=[v("取消",-1)])]),_:1}),e(b,{type:"primary",onClick:u},{default:t(()=>[...k[13]||(k[13]=[v("确定",-1)])]),_:1})])]),default:t(()=>[l("div",La,[e(h,{modelValue:S.value,"onUpdate:modelValue":k[2]||(k[2]=K=>S.value=K)},{default:t(()=>[l("div",Ia,[(c(!0),T(se,null,oe(a.materials,K=>(c(),T("div",{key:K.id,class:"material-item"},[e(U,{label:K.id,class:"material-checkbox"},{default:t(()=>[l("div",za,[l("div",Ea,z(K.filename),1),l("div",Ba,[l("span",Fa,z(K.filesize)+"MB",1),l("span",Ra,z(K.upload_time),1)])])]),_:2},1032,["label"])]))),128))])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}},Ka=Z(qa,[["__scopeId","data-v-a4989d91"]]),Na={class:"platform-section"},ja={key:0,class:"platform-tips"},Ha={__name:"PlatformSelection",props:{modelValue:{type:Number,required:!0}},emits:["update:modelValue","platform-change"],setup(a,{emit:d}){const i=a,p=d,o=ya(),n=J({get:()=>i.modelValue,set:P=>p("update:modelValue",P)}),r=J(()=>he(i.modelValue)),V=P=>{p("platform-change",P)};return(P,S)=>{const x=_("el-radio"),D=_("el-radio-group"),$=_("el-alert");return c(),T("div",Na,[S[1]||(S[1]=l("h3",null,"平台",-1)),e(D,{modelValue:n.value,"onUpdate:modelValue":S[0]||(S[0]=C=>n.value=C),onChange:V,class:"platform-radios"},{default:t(()=>[(c(!0),T(se,null,oe(F(o),C=>(c(),G(x,{key:C.key,label:C.key,class:"platform-radio"},{default:t(()=>[v(z(C.name),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),r.value?(c(),T("div",ja,[e($,{title:`${r.value.name}平台限制：标题最多${r.value.titleLimit}字，话题最多${r.value.topicLimit}个`,type:"info",closable:!1,"show-icon":"",class:"platform-alert"},null,8,["title"])])):Y("",!0)])}}},Ya=Z(Ha,[["__scopeId","data-v-4ae792d5"]]),Wa={class:"account-section"},Xa={class:"account-display"},Ga={class:"selected-accounts"},Ja={class:"account-dialog-content"},Qa={class:"account-list"},Za={class:"account-info"},es={class:"account-name"},ts={class:"dialog-footer"},ls={__name:"AccountSelection",props:{modelValue:{type:Array,default:()=>[]},platformKey:{type:Number,required:!0}},emits:["update:modelValue"],setup(a,{emit:d}){const i=a,p=d,o=Me(),n=J({get:()=>i.modelValue,set:C=>p("update:modelValue",C)}),r=N(!1),V=N([]),P=J(()=>{const u={3:"抖音",2:"视频号",1:"小红书",4:"快手",5:"B站"}[i.platformKey];return u?o.accounts.filter(R=>R.platform===u):[]}),S=()=>{V.value=[...n.value],r.value=!0},x=()=>{n.value=[...V.value],r.value=!1,A.success("账号选择完成")},D=C=>{n.value.splice(C,1)},$=C=>{const u=o.accounts.find(R=>R.id===C);return u?u.name:C};return(C,u)=>{const R=_("el-tag"),E=_("el-button"),k=_("el-checkbox"),I=_("el-checkbox-group"),b=_("el-dialog");return c(),T("div",Wa,[u[6]||(u[6]=l("h3",null,"账号",-1)),l("div",Xa,[l("div",Ga,[(c(!0),T(se,null,oe(n.value,(y,W)=>(c(),G(R,{key:W,closable:"",onClose:j=>D(W),class:"account-tag"},{default:t(()=>[v(z($(y)),1)]),_:2},1032,["onClose"]))),128))]),e(E,{type:"primary",plain:"",onClick:S,class:"select-account-btn"},{default:t(()=>[...u[3]||(u[3]=[v(" 选择账号 ",-1)])]),_:1})]),e(b,{modelValue:r.value,"onUpdate:modelValue":u[2]||(u[2]=y=>r.value=y),title:"选择账号",width:"600px",class:"account-dialog"},{footer:t(()=>[l("div",ts,[e(E,{onClick:u[1]||(u[1]=y=>r.value=!1)},{default:t(()=>[...u[4]||(u[4]=[v("取消",-1)])]),_:1}),e(E,{type:"primary",onClick:x},{default:t(()=>[...u[5]||(u[5]=[v("确定",-1)])]),_:1})])]),default:t(()=>[l("div",Ja,[e(I,{modelValue:V.value,"onUpdate:modelValue":u[0]||(u[0]=y=>V.value=y)},{default:t(()=>[l("div",Qa,[(c(!0),T(se,null,oe(P.value,y=>(c(),G(k,{key:y.id,label:y.id,class:"account-item"},{default:t(()=>[l("div",Za,[l("span",es,z(y.name),1)])]),_:2},1032,["label"]))),128))])]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])])}}},as=Z(ls,[["__scopeId","data-v-6501bc5d"]]),ss={class:"schedule-section"},os={class:"schedule-controls"},ns={key:0,class:"schedule-settings"},is={class:"schedule-item"},ds={class:"schedule-item"},us={class:"time-selectors"},rs={class:"schedule-item"},cs={__name:"ScheduleSettings",props:{scheduleEnabled:{type:Boolean,default:!1},videosPerDay:{type:Number,default:1},dailyTimes:{type:Array,default:()=>["10:00"]},startDays:{type:Number,default:0}},emits:["update:scheduleEnabled","update:videosPerDay","update:dailyTimes","update:startDays"],setup(a,{emit:d}){const i=a,p=d,o=J({get:()=>i.scheduleEnabled,set:x=>p("update:scheduleEnabled",x)}),n=J({get:()=>i.videosPerDay,set:x=>p("update:videosPerDay",x)}),r=J({get:()=>i.dailyTimes,set:x=>p("update:dailyTimes",x)}),V=J({get:()=>i.startDays,set:x=>p("update:startDays",x)}),P=x=>{x||(p("update:videosPerDay",1),p("update:dailyTimes",["10:00"]),p("update:startDays",0))},S=()=>{if(r.value.length<n.value){const x=[...r.value,"10:00"];p("update:dailyTimes",x)}};return(x,D)=>{const $=_("el-switch"),C=_("el-option"),u=_("el-select"),R=_("el-time-select"),E=_("el-button");return c(),T("div",ss,[D[7]||(D[7]=l("h3",null,"定时发布",-1)),l("div",os,[e($,{modelValue:o.value,"onUpdate:modelValue":D[0]||(D[0]=k=>o.value=k),"active-text":"定时发布","inactive-text":"立即发布",onChange:P},null,8,["modelValue"]),o.value?(c(),T("div",ns,[l("div",is,[D[3]||(D[3]=l("span",{class:"label"},"每天发布视频数：",-1)),e(u,{modelValue:n.value,"onUpdate:modelValue":D[1]||(D[1]=k=>n.value=k),placeholder:"选择发布数量"},{default:t(()=>[(c(),T(se,null,oe(55,k=>e(C,{key:k,label:k,value:k},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),l("div",ds,[D[5]||(D[5]=l("span",{class:"label"},"每天发布时间：",-1)),l("div",us,[(c(!0),T(se,null,oe(r.value,(k,I)=>(c(),G(R,{key:I,modelValue:r.value[I],"onUpdate:modelValue":b=>r.value[I]=b,start:"00:00",step:"00:30",end:"23:30",placeholder:"选择时间"},null,8,["modelValue","onUpdate:modelValue"]))),128)),r.value.length<n.value?(c(),G(E,{key:0,type:"primary",size:"small",onClick:S},{default:t(()=>[...D[4]||(D[4]=[v(" 添加时间 ",-1)])]),_:1})):Y("",!0)])]),l("div",rs,[D[6]||(D[6]=l("span",{class:"label"},"开始天数：",-1)),e(u,{modelValue:V.value,"onUpdate:modelValue":D[2]||(D[2]=k=>V.value=k),placeholder:"选择开始天数"},{default:t(()=>[e(C,{label:"明天",value:0}),e(C,{label:"后天",value:1})]),_:1},8,["modelValue"])])])):Y("",!0)])])}}},ps=Z(cs,[["__scopeId","data-v-7e1e15aa"]]),ms={class:"title-section"},fs={key:0,class:"error-message"},vs={__name:"TitleInput",props:{modelValue:{type:String,default:""},platformKey:{type:Number,required:!0},validateOnInput:{type:Boolean,default:!0}},emits:["update:modelValue","validation-change"],setup(a,{expose:d,emit:i}){const p=a,o=i,n=J(()=>he(p.platformKey)),r=J({get:()=>p.modelValue,set:$=>o("update:modelValue",$)}),V=J(()=>n.value.titlePlaceholder),P=J(()=>n.value.titleLimit),S=N(""),x=$=>{if(p.validateOnInput){const C=Ue($,p.platformKey);S.value=C.valid?"":C.message,o("validation-change",C)}};return d({validate:()=>{const $=Ue(p.modelValue,p.platformKey);return S.value=$.valid?"":$.message,o("validation-change",$),$}}),($,C)=>{const u=_("el-input"),R=_("el-alert");return c(),T("div",ms,[C[1]||(C[1]=l("h3",null,"标题",-1)),e(u,{modelValue:r.value,"onUpdate:modelValue":C[0]||(C[0]=E=>r.value=E),type:"textarea",rows:3,placeholder:V.value,maxlength:P.value,"show-word-limit":"",class:"title-input",onInput:x},null,8,["modelValue","placeholder","maxlength"]),S.value?(c(),T("div",fs,[e(R,{title:S.value,type:"error",closable:!1,"show-icon":"",class:"error-alert"},null,8,["title"])])):Y("",!0)])}}},be=Z(vs,[["__scopeId","data-v-f75530ea"]]),_s={class:"topic-section"},gs={class:"topic-display"},ys={class:"selected-topics"},hs={key:0,class:"topic-tips"},bs={key:1,class:"error-message"},$s={class:"topic-dialog-content"},ws={class:"custom-topic-input"},Vs={class:"recommended-topics"},ks={class:"topic-grid"},Cs={class:"dialog-footer"},Ts={__name:"TopicInput",props:{modelValue:{type:Array,default:()=>[]},platformKey:{type:Number,required:!0},validateOnInput:{type:Boolean,default:!0}},emits:["update:modelValue","validation-change"],setup(a,{expose:d,emit:i}){const p=a,o=i,n=J(()=>he(p.platformKey)),r=J({get:()=>p.modelValue,set:b=>o("update:modelValue",b)}),V=J(()=>r.value.length>=n.value.topicLimit),P=N(""),S=N(!1),x=N(""),D=["游戏","知识","自动化","系统平台","自媒体工具","跨境电商","科技","教程","云手机平台","云电脑平台","脚本","开源","健康","时尚","美妆","摄影","宠物","汽车"],$=()=>{if(V.value){A.warning(`最多只能添加${n.value.topicLimit}个话题`);return}S.value=!0},C=()=>{if(!x.value.trim()){A.warning("请输入话题内容");return}const b=ha(x.value.trim());if(!b.valid){A.error(b.message);return}if(V.value){A.warning(`最多只能添加${n.value.topicLimit}个话题`);return}r.value.includes(x.value.trim())?A.warning("话题已存在"):(r.value.push(x.value.trim()),x.value="",A.success("话题添加成功"),k())},u=b=>{if(V.value&&!r.value.includes(b)){A.warning(`最多只能添加${n.value.topicLimit}个话题`);return}const y=r.value.indexOf(b);y>-1?r.value.splice(y,1):r.value.push(b),k()},R=b=>{r.value.splice(b,1),k()},E=()=>{S.value=!1,x.value="",A.success("添加话题完成")},k=()=>{if(p.validateOnInput){const b=Pe(r.value,p.platformKey);P.value=b.valid?"":b.message,o("validation-change",b)}};return d({validate:()=>{const b=Pe(p.modelValue,p.platformKey);return P.value=b.valid?"":b.message,o("validation-change",b),b}}),(b,y)=>{const W=_("el-tag"),j=_("el-button"),U=_("el-alert"),h=_("el-input"),K=_("el-dialog");return c(),T("div",_s,[y[9]||(y[9]=l("h3",null,"话题",-1)),l("div",gs,[l("div",ys,[(c(!0),T(se,null,oe(r.value,(H,X)=>(c(),G(W,{key:X,closable:"",onClose:ee=>R(X),class:"topic-tag"},{default:t(()=>[v(" #"+z(H),1)]),_:2},1032,["onClose"]))),128))]),e(j,{type:"primary",plain:"",onClick:$,class:"select-topic-btn",disabled:V.value},{default:t(()=>[...y[3]||(y[3]=[v(" 添加话题 ",-1)])]),_:1},8,["disabled"])]),n.value?(c(),T("div",hs,[e(U,{title:`已添加 ${r.value.length}/${n.value.topicLimit} 个话题`,type:V.value?"warning":"info",closable:!1,"show-icon":"",class:"topic-alert"},null,8,["title","type"])])):Y("",!0),P.value?(c(),T("div",bs,[e(U,{title:P.value,type:"error",closable:!1,"show-icon":"",class:"error-alert"},null,8,["title"])])):Y("",!0),e(K,{modelValue:S.value,"onUpdate:modelValue":y[2]||(y[2]=H=>S.value=H),title:"添加话题",width:"600px",class:"topic-dialog"},{footer:t(()=>[l("div",Cs,[e(j,{onClick:y[1]||(y[1]=H=>S.value=!1)},{default:t(()=>[...y[7]||(y[7]=[v("取消",-1)])]),_:1}),e(j,{type:"primary",onClick:E},{default:t(()=>[...y[8]||(y[8]=[v("确定",-1)])]),_:1})])]),default:t(()=>[l("div",$s,[l("div",ws,[e(h,{modelValue:x.value,"onUpdate:modelValue":y[0]||(y[0]=H=>x.value=H),placeholder:"输入自定义话题",class:"custom-input",onKeyup:Le(C,["enter"])},{prepend:t(()=>[...y[4]||(y[4]=[v("#",-1)])]),_:1},8,["modelValue"]),e(j,{type:"primary",onClick:C},{default:t(()=>[...y[5]||(y[5]=[v("添加",-1)])]),_:1})]),l("div",Vs,[y[6]||(y[6]=l("h4",null,"推荐话题",-1)),l("div",ks,[(c(),T(se,null,oe(D,H=>e(j,{key:H,type:r.value.includes(H)?"primary":"default",onClick:X=>u(H),class:"topic-btn",disabled:r.value.includes(H)&&V.value},{default:t(()=>[v(z(H),1)]),_:2},1032,["type","onClick","disabled"])),64))])])])]),_:1},8,["modelValue"])])}}},$e=Z(Ts,[["__scopeId","data-v-b3973a1b"]]),As={class:"xiaohongshu-form"},Us={__name:"XiaohongshuForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const d=le(a,"title"),i=le(a,"topics");return(p,o)=>(c(),T("div",As,[e(be,{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=n=>d.value=n),"platform-key":1,onValidationChange:o[1]||(o[1]=n=>p.$emit("validation-change","title",n))},null,8,["modelValue"]),e($e,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=n=>i.value=n),"platform-key":1,onValidationChange:o[3]||(o[3]=n=>p.$emit("validation-change","topics",n))},null,8,["modelValue"])]))}},Ps=Z(Us,[["__scopeId","data-v-755d8f6d"]]),xs={class:"wechat-video-form"},Ms={__name:"WechatVideoForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const d=le(a,"title"),i=le(a,"topics");return(p,o)=>(c(),T("div",xs,[e(be,{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=n=>d.value=n),"platform-key":2,onValidationChange:o[1]||(o[1]=n=>p.$emit("validation-change","title",n))},null,8,["modelValue"]),e($e,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=n=>i.value=n),"platform-key":2,onValidationChange:o[3]||(o[3]=n=>p.$emit("validation-change","topics",n))},null,8,["modelValue"])]))}},Ss=Z(Ms,[["__scopeId","data-v-e4342bc4"]]),Ds={class:"douyin-form"},Ls={__name:"DouyinForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const d=le(a,"title"),i=le(a,"topics");return(p,o)=>(c(),T("div",Ds,[e(be,{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=n=>d.value=n),"platform-key":3,onValidationChange:o[1]||(o[1]=n=>p.$emit("validation-change","title",n))},null,8,["modelValue"]),e($e,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=n=>i.value=n),"platform-key":3,onValidationChange:o[3]||(o[3]=n=>p.$emit("validation-change","topics",n))},null,8,["modelValue"])]))}},Is=Z(Ls,[["__scopeId","data-v-8f8e36c0"]]),zs={class:"kuaishou-form"},Es={__name:"KuaishouForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const d=le(a,"title"),i=le(a,"topics");return(p,o)=>(c(),T("div",zs,[e(be,{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=n=>d.value=n),"platform-key":4,onValidationChange:o[1]||(o[1]=n=>p.$emit("validation-change","title",n))},null,8,["modelValue"]),e($e,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=n=>i.value=n),"platform-key":4,onValidationChange:o[3]||(o[3]=n=>p.$emit("validation-change","topics",n))},null,8,["modelValue"])]))}},Bs=Z(Es,[["__scopeId","data-v-567a13dc"]]),Fs={class:"bili-tag-section"},Rs={class:"tag-display"},Os={class:"selected-tags"},qs={class:"tag-tips"},Ks={key:0,class:"error-message"},Ns={class:"tag-dialog-content"},js={class:"custom-tag-input"},Hs={class:"recommended-tags"},Ys={class:"tag-grid"},Ws={class:"dialog-footer"},Xs={__name:"BiliTagInput",props:{modelValue:{type:Array,default:()=>[]},validateOnInput:{type:Boolean,default:!0}},emits:["update:modelValue","validation-change"],setup(a,{expose:d,emit:i}){const p=a,o=i,n=J({get:()=>p.modelValue,set:b=>o("update:modelValue",b)}),r=J(()=>n.value.length>=10),V=N(""),P=N(!1),S=N(""),x=["知识","游戏","科技","娱乐","音乐","舞蹈","动画","影视","生活","美食","体育","时尚","汽车","旅游","动物","搞笑","教程","测评","开箱","vlog","日常","分享","原创","转载"],D=()=>{if(r.value){A.warning("最多只能添加10个标签");return}P.value=!0},$=b=>{if(!b||b.trim()==="")return{valid:!1,message:"标签内容不能为空"};const y=b.trim();return y.length>10?{valid:!1,message:"单个标签不能超过10个字符"}:y.length<1?{valid:!1,message:"标签至少需要1个字符"}:/[<>\/\\|:"*?#]/.test(y)?{valid:!1,message:"标签不能包含特殊字符"}:{valid:!0,message:""}},C=()=>{if(!S.value.trim()){A.warning("请输入标签内容");return}const b=$(S.value.trim());if(!b.valid){A.error(b.message);return}if(r.value){A.warning("最多只能添加10个标签");return}const y=S.value.trim();n.value.includes(y)?A.warning("标签已存在"):(n.value.push(y),S.value="",A.success("标签添加成功"),k())},u=b=>{if(r.value&&!n.value.includes(b)){A.warning("最多只能添加10个标签");return}const y=n.value.indexOf(b);y>-1?n.value.splice(y,1):n.value.push(b),k()},R=b=>{n.value.splice(b,1),k()},E=()=>{P.value=!1,S.value="",A.success("添加标签完成")},k=()=>{if(p.validateOnInput){let b={valid:!0,message:""};if(n.value.length===0)b={valid:!1,message:"请至少添加一个标签"};else if(n.value.length>10)b={valid:!1,message:"最多只能添加10个标签"};else for(const y of n.value){const W=$(y);if(!W.valid){b=W;break}}V.value=b.valid?"":b.message,o("validation-change",b)}};return d({validate:()=>{let b={valid:!0,message:""};if(p.modelValue.length===0)b={valid:!1,message:"请至少添加一个标签"};else if(p.modelValue.length>10)b={valid:!1,message:"最多只能添加10个标签"};else for(const y of p.modelValue){const W=$(y);if(!W.valid){b=W;break}}return V.value=b.valid?"":b.message,o("validation-change",b),b}}),(b,y)=>{const W=_("el-tag"),j=_("el-button"),U=_("el-text"),h=_("el-alert"),K=_("el-input"),H=_("el-dialog");return c(),T("div",Fs,[l("div",Rs,[l("div",Os,[(c(!0),T(se,null,oe(n.value,(X,ee)=>(c(),G(W,{key:ee,closable:"",onClose:w=>R(ee),class:"tag-item",size:"small"},{default:t(()=>[v(z(X),1)]),_:2},1032,["onClose"]))),128))]),e(j,{type:"primary",plain:"",onClick:D,class:"add-tag-btn",size:"small",disabled:r.value},{default:t(()=>[...y[3]||(y[3]=[v(" 添加标签 ",-1)])]),_:1},8,["disabled"])]),l("div",qs,[e(U,{size:"small",type:"info"},{default:t(()=>[v(" 已添加 "+z(n.value.length)+"/10 个标签，标签有助于更多用户发现你的视频 ",1)]),_:1}),r.value?(c(),G(U,{key:0,size:"small",type:"warning",style:{"margin-left":"8px"}},{default:t(()=>[...y[4]||(y[4]=[v(" 已达上限 ",-1)])]),_:1})):Y("",!0)]),V.value?(c(),T("div",Ks,[e(h,{title:V.value,type:"error",closable:!1,"show-icon":"",size:"small"},null,8,["title"])])):Y("",!0),e(H,{modelValue:P.value,"onUpdate:modelValue":y[2]||(y[2]=X=>P.value=X),title:"添加标签",width:"600px",class:"tag-dialog"},{footer:t(()=>[l("div",Ws,[e(j,{onClick:y[1]||(y[1]=X=>P.value=!1)},{default:t(()=>[...y[7]||(y[7]=[v("取消",-1)])]),_:1}),e(j,{type:"primary",onClick:E},{default:t(()=>[...y[8]||(y[8]=[v("确定",-1)])]),_:1})])]),default:t(()=>[l("div",Ns,[l("div",js,[e(K,{modelValue:S.value,"onUpdate:modelValue":y[0]||(y[0]=X=>S.value=X),placeholder:"输入标签内容",class:"custom-input",onKeyup:Le(C,["enter"]),maxlength:"10","show-word-limit":""},null,8,["modelValue"]),e(j,{type:"primary",onClick:C},{default:t(()=>[...y[5]||(y[5]=[v("添加",-1)])]),_:1})]),l("div",Hs,[y[6]||(y[6]=l("h4",null,"推荐标签",-1)),l("div",Ys,[(c(),T(se,null,oe(x,X=>e(j,{key:X,type:n.value.includes(X)?"primary":"default",onClick:ee=>u(X),class:"tag-btn",size:"small",disabled:n.value.includes(X)&&r.value},{default:t(()=>[v(z(X),1)]),_:2},1032,["type","onClick","disabled"])),64))])])])]),_:1},8,["modelValue"])])}}},Gs=Z(Xs,[["__scopeId","data-v-b01e071a"]]),Js={class:"bilibili-form"},Qs={class:"bili-specific-fields"},Zs={class:"field-tips"},eo={class:"field-tips"},to={class:"field-tips"},lo={class:"field-tips"},ao={class:"schedule-setting"},so={key:0,class:"schedule-datetime"},oo={class:"field-tips"},no={__name:"BilibiliForm",props:{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{},biliType:{type:String,default:"自制"},biliTypeModifiers:{},biliPartition:{type:String,default:""},biliPartitionModifiers:{},biliDesc:{type:String,default:""},biliDescModifiers:{},scheduleEnabled:{type:Boolean,default:!1},scheduleEnabledModifiers:{},scheduleTime:{type:String,default:""},scheduleTimeModifiers:{}},emits:fe(["validation-change"],["update:title","update:topics","update:biliType","update:biliPartition","update:biliDesc","update:scheduleEnabled","update:scheduleTime"]),setup(a){const d=le(a,"title"),i=le(a,"topics"),p=le(a,"biliType"),o=le(a,"biliPartition"),n=le(a,"biliDesc"),r=le(a,"scheduleEnabled"),V=le(a,"scheduleTime"),P=D=>{const $=new Date,C=new Date($.getTime()+10080*60*1e3);return D.getTime()<$.getTime()||D.getTime()>C.getTime()},S=()=>{const D=new Date;return new Date(V.value).toDateString()===D.toDateString()?Array.from({length:D.getHours()},(C,u)=>u):[]},x=D=>{const $=new Date;return new Date(V.value).toDateString()===$.toDateString()&&D===$.getHours()?Array.from({length:$.getMinutes()},(u,R)=>R):[]};return(D,$)=>{const C=_("el-input"),u=_("el-text"),R=_("el-form-item"),E=_("el-radio"),k=_("el-radio-group"),I=_("el-option"),b=_("el-select"),y=_("el-switch"),W=_("el-date-picker"),j=_("el-form");return c(),T("div",Js,[l("div",Qs,[e(j,{"label-width":"90px"},{default:t(()=>[e(R,{label:"标题",required:""},{default:t(()=>[e(C,{modelValue:d.value,"onUpdate:modelValue":$[0]||($[0]=U=>d.value=U),placeholder:"请输入稿件标题",maxlength:"80","show-word-limit":"",clearable:""},null,8,["modelValue"]),l("div",Zs,[e(u,{size:"small",type:"info"},{default:t(()=>[...$[8]||($[8]=[v("好的标题有助于作品获得更多推荐",-1)])]),_:1})])]),_:1}),e(R,{label:"类型",required:""},{default:t(()=>[e(k,{modelValue:p.value,"onUpdate:modelValue":$[1]||($[1]=U=>p.value=U)},{default:t(()=>[e(E,{label:"自制"},{default:t(()=>[...$[9]||($[9]=[v("自制",-1)])]),_:1}),e(E,{label:"转载"},{default:t(()=>[...$[10]||($[10]=[v("转载",-1)])]),_:1})]),_:1},8,["modelValue"]),l("div",eo,[e(u,{size:"small",type:"info"},{default:t(()=>[...$[11]||($[11]=[v("自制=原创内容，转载=搬运内容",-1)])]),_:1})])]),_:1}),e(R,{label:"分区",required:""},{default:t(()=>[e(b,{modelValue:o.value,"onUpdate:modelValue":$[2]||($[2]=U=>o.value=U),placeholder:"请选择分区",filterable:"",clearable:"",style:{width:"100%"}},{default:t(()=>[e(I,{label:"影视",value:"影视"}),e(I,{label:"娱乐",value:"娱乐"}),e(I,{label:"音乐",value:"音乐"}),e(I,{label:"舞蹈",value:"舞蹈"}),e(I,{label:"动画",value:"动画"}),e(I,{label:"绘画",value:"绘画"}),e(I,{label:"鬼畜",value:"鬼畜"}),e(I,{label:"游戏",value:"游戏"}),e(I,{label:"资讯",value:"资讯"}),e(I,{label:"知识",value:"知识"}),e(I,{label:"人工智能",value:"人工智能"}),e(I,{label:"科技数码",value:"科技数码"}),e(I,{label:"汽车",value:"汽车"}),e(I,{label:"时尚美妆",value:"时尚美妆"}),e(I,{label:"家装房产",value:"家装房产"}),e(I,{label:"户外潮流",value:"户外潮流"}),e(I,{label:"健身",value:"健身"}),e(I,{label:"体育运动",value:"体育运动"}),e(I,{label:"手工",value:"手工"}),e(I,{label:"美食",value:"美食"}),e(I,{label:"小剧场",value:"小剧场"}),e(I,{label:"旅游出行",value:"旅游出行"}),e(I,{label:"三农",value:"三农"}),e(I,{label:"动物",value:"动物"}),e(I,{label:"亲子",value:"亲子"}),e(I,{label:"健康",value:"健康"}),e(I,{label:"情感",value:"情感"}),e(I,{label:"vlog",value:"vlog"}),e(I,{label:"生活兴趣",value:"生活兴趣"}),e(I,{label:"生活经验",value:"生活经验"})]),_:1},8,["modelValue"]),l("div",to,[e(u,{size:"small",type:"warning"},{default:t(()=>[...$[12]||($[12]=[v(" ⚠️ 分区选项需要根据B站实际页面更新。请访问 ",-1),l("a",{href:"https://member.bilibili.com/platform/upload/video/frame",target:"_blank",style:{color:"#409eff"}}," B站上传页面 ",-1),v(" 查看实际分区列表。 ",-1)])]),_:1})])]),_:1}),e(R,{label:"标签",required:""},{default:t(()=>[e(Gs,{modelValue:i.value,"onUpdate:modelValue":$[3]||($[3]=U=>i.value=U),onValidationChange:$[4]||($[4]=U=>D.$emit("validation-change","topics",U))},null,8,["modelValue"])]),_:1}),e(R,{label:"简介"},{default:t(()=>[e(C,{modelValue:n.value,"onUpdate:modelValue":$[5]||($[5]=U=>n.value=U),type:"textarea",rows:5,maxlength:"2000","show-word-limit":"",placeholder:"填写更全面的相关信息，让更多的人能够找到你的视频吧",resize:"vertical"},null,8,["modelValue"]),l("div",lo,[e(u,{size:"small",type:"info"},{default:t(()=>[...$[13]||($[13]=[v("简介支持@用户、#话题、超链接",-1)])]),_:1})])]),_:1}),e(R,{label:"定时发布"},{default:t(()=>[l("div",ao,[e(y,{modelValue:r.value,"onUpdate:modelValue":$[6]||($[6]=U=>r.value=U),"active-text":"启用定时发布","inactive-text":"立即发布"},null,8,["modelValue"]),r.value?(c(),T("div",so,[e(W,{modelValue:V.value,"onUpdate:modelValue":$[7]||($[7]=U=>V.value=U),type:"datetime",placeholder:"选择发布时间",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm","disabled-date":P,"disabled-hours":S,"disabled-minutes":x,style:{width:"100%","margin-top":"8px"}},null,8,["modelValue"])])):Y("",!0)]),l("div",oo,[e(u,{size:"small",type:"info"},{default:t(()=>[...$[14]||($[14]=[v("可设置未来7天内的发布时间",-1)])]),_:1})])]),_:1})]),_:1})])])}}},io=Z(no,[["__scopeId","data-v-7b834afc"]]),uo={class:"common-form"},ro={class:"common-notice"},co={__name:"CommonForm",props:fe({platformKey:{type:Number,required:!0}},{title:{type:String,default:""},titleModifiers:{},topics:{type:Array,default:()=>[]},topicsModifiers:{}}),emits:fe(["validation-change"],["update:title","update:topics"]),setup(a){const d=le(a,"title"),i=le(a,"topics");return(p,o)=>{const n=_("el-alert");return c(),T("div",uo,[e(be,{modelValue:d.value,"onUpdate:modelValue":o[0]||(o[0]=r=>d.value=r),"platform-key":a.platformKey,onValidationChange:o[1]||(o[1]=r=>p.$emit("validation-change","title",r))},null,8,["modelValue","platform-key"]),e($e,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=r=>i.value=r),"platform-key":a.platformKey,onValidationChange:o[3]||(o[3]=r=>p.$emit("validation-change","topics",r))},null,8,["modelValue","platform-key"]),l("div",ro,[e(n,{title:"通用表单",description:"当前平台使用通用表单模板，如需平台专属字段，请联系开发者添加。",type:"info",closable:!1,"show-icon":""})])])}}},po=Z(co,[["__scopeId","data-v-4cc75321"]]),mo={class:"publish-center"},fo={class:"publish-content"},vo={class:"tab-content-wrapper"},_o={key:0,class:"publish-status"},go={class:"platform-forms"},yo={class:"action-buttons"},ho={class:"publish-progress"},bo={key:0,class:"current-publishing"},$o={key:1,class:"publish-results"},wo={class:"label"},Vo={class:"message"},ko={class:"dialog-footer"},Co={__name:"PublishCenter",setup(a){const d="http://localhost:5409",i=J(()=>({Authorization:`Bearer ${localStorage.getItem("token")||""}`})),p=N("tab1");let o=1;const n=Te(),r=Me(),V=J(()=>n.materials),P={1:"小红书",2:"视频号",3:"抖音",4:"快手",5:"B站"},S=N(!1);xe(async()=>{try{const w=await Ve.getValidAccounts({validate:0});w&&w.code===200&&Array.isArray(w.data)&&r.setAccounts(w.data)}catch(w){console.warn("初始化获取账号失败",w)}});const x=ve([{name:"tab1",label:P[1],fileList:[],displayFileList:[],selectedAccounts:[],selectedPlatform:1,title:"",selectedTopics:[],biliType:"自制",biliPartition:"",biliDesc:"",scheduleTime:"",scheduleEnabled:!1,videosPerDay:1,dailyTimes:["10:00"],startDays:0,publishStatus:null,validationErrors:{}}]),D=N(!1),$=N(null),C=N(0),u=N([]),R=N(!1),E=()=>{o++;const w={name:`tab${o}`,label:P[1],fileList:[],displayFileList:[],selectedAccounts:[],selectedPlatform:1,title:"",selectedTopics:[],biliType:"自制",biliPartition:"",biliDesc:"",scheduleTime:"",scheduleEnabled:!1,videosPerDay:1,dailyTimes:["10:00"],startDays:0,publishStatus:null,validationErrors:{}};x.push(w),p.value=w.name},k=w=>{const M=x.findIndex(O=>O.name===w);M>-1&&(x.splice(M,1),p.value===w&&x.length>0&&(p.value=x[0].name))},I=w=>{const M=x.find(O=>O.name===p.value);M&&(M.selectedAccounts=[],U(M))},b=(w,M,O)=>{M.valid?delete O.validationErrors[w]:O.validationErrors[w]=M.message},y=(w,M,O)=>{if(w.code===200){const L=w.data.path||w.data,s=L.split("/").pop(),q={name:M.name,url:pe.getMaterialPreviewUrl(s),path:L,size:M.size,type:M.type};O.fileList.push(q),O.displayFileList=[...O.fileList.map(B=>({name:B.name,url:B.url}))],A.success("文件上传成功"),console.log("上传成功:",q)}else A.error(w.msg||"上传失败")},W=(w,M)=>{w.forEach(O=>{const L=V.value.find(s=>s.id===O);if(L){const s={name:L.filename,url:pe.getMaterialPreviewUrl(L.file_path.split("/").pop()),path:L.file_path,size:L.filesize*1024*1024,type:"video/mp4"};M.fileList.some(B=>B.path===s.path)||M.fileList.push(s)}}),M.displayFileList=[...M.fileList.map(O=>({name:O.name,url:O.url}))]},j=(w,M)=>{w.fileList.splice(M,1),w.displayFileList=[...w.fileList.map(O=>({name:O.name,url:O.url}))],A.success("文件删除成功")},U=w=>{const M=P[w.selectedPlatform],O=w.selectedAccounts||[];if(M&&O.length>0){const L=r.accounts.find(q=>q.id===O[0]),s=(L==null?void 0:L.name)||"";w.label=s?`${M}_${s}`:`${M}`}else if(M)w.label=M;else{const L=x.findIndex(s=>s.name===w.name);w.label=`发布${L+1}`}};We(x,()=>{x.forEach(U)},{deep:!0});const h=w=>{A.info("已取消发布")},K=async w=>new Promise((M,O)=>{const L=ba(w);if(!L.valid){const q=Object.values(L.errors)[0];A.error(q),O(new Error(q));return}const s={type:w.selectedPlatform,title:w.title,tags:w.selectedTopics,fileList:w.fileList.map(q=>q.path),accountList:w.selectedAccounts.map(q=>{const B=r.accounts.find(f=>f.id===q);return B?B.filePath:q}),enableTimer:w.scheduleEnabled?1:0,videosPerDay:w.scheduleEnabled&&w.videosPerDay||1,dailyTimes:w.scheduleEnabled?w.dailyTimes||["10:00"]:["10:00"],startDays:w.scheduleEnabled&&w.startDays||0,category:0};w.selectedPlatform===5&&(s.biliType=w.biliType,s.biliPartition=w.biliPartition,s.biliDesc=w.biliDesc),fetch(`${d}/postVideo`,{method:"POST",headers:{"Content-Type":"application/json",...i.value},body:JSON.stringify(s)}).then(q=>q.json()).then(q=>{q.code===200?(w.publishStatus={message:"发布成功",type:"success"},w.fileList=[],w.displayFileList=[],w.title="",w.selectedTopics=[],w.selectedAccounts=[],w.scheduleEnabled=!1,w.validationErrors={},M()):(w.publishStatus={message:`发布失败：${q.msg||"发布失败"}`,type:"error"},O(new Error(q.msg||"发布失败")))}).catch(q=>{console.error("发布错误:",q),w.publishStatus={message:"发布失败，请检查网络连接",type:"error"},O(q)})}),H=()=>{const w=[];return x.forEach(M=>{const O=[];(!M.fileList||M.fileList.length===0)&&O.push("未上传视频"),(!M.selectedAccounts||M.selectedAccounts.length===0)&&O.push("未选择账号"),O.length&&w.push({tab:M,message:`${M.label}: ${O.join("、")}`})}),w},X=async()=>{if(S.value)return;const w=H();if(w.length>0){p.value=w[0].tab.name,w[0].tab.publishStatus={message:w[0].message,type:"error"};try{await ye.alert(w.map(M=>M.message).join(`
`),"请完善发布项后再批量发布",{confirmButtonText:"好的"})}catch{}A.error("存在未准备完成的发布项：请为每个发布项上传视频并选择账号");return}S.value=!0,$.value=null,C.value=0,u.value=[],R.value=!1,D.value=!0;try{for(let s=0;s<x.length;s++){if(R.value){u.value.push({label:x[s].label,status:"cancelled",message:"已取消"});continue}const q=x[s];$.value=q,C.value=Math.floor(s/x.length*100);try{await K(q),u.value.push({label:q.label,status:"success",message:"发布成功"})}catch(B){u.value.push({label:q.label,status:"error",message:B.message})}}C.value=100;const M=u.value.filter(s=>s.status==="success").length,O=u.value.filter(s=>s.status==="error").length,L=u.value.filter(s=>s.status==="cancelled").length;R.value?A.warning(`发布已取消：${M}个成功，${O}个失败，${L}个未执行`):O>0?A.error(`发布完成：${M}个成功，${O}个失败`):(A.success("所有Tab发布成功"),setTimeout(()=>{D.value=!1},1e3))}catch(M){console.error("批量发布出错:",M),A.error("批量发布出错，请重试")}finally{S.value=!1,R.value=!1}},ee=()=>{R.value=!0,A.info("正在取消发布...")};return(w,M)=>{const O=_("el-alert"),L=_("el-button"),s=_("el-progress"),q=_("el-icon"),B=_("el-dialog");return c(),T("div",mo,[e(Aa,{tabs:x,"active-tab":p.value,"batch-publishing":S.value,onTabChange:M[0]||(M[0]=f=>p.value=f),onRemoveTab:k,onAddTab:E,onBatchPublish:X},null,8,["tabs","active-tab","batch-publishing"]),l("div",fo,[l("div",vo,[(c(!0),T(se,null,oe(x,f=>ke((c(),T("div",{key:f.name,class:"tab-content"},[f.publishStatus?(c(),T("div",_o,[e(O,{title:f.publishStatus.message,type:f.publishStatus.type,closable:!1,"show-icon":""},null,8,["title","type"])])):Y("",!0),e(Ka,{"file-list":f.fileList,"upload-action":`${F(d)}/upload`,"auth-headers":i.value,materials:V.value,onRemoveFile:m=>j(f,m),onUploadSuccess:(m,Q)=>y(m,Q,f),onMaterialSelected:m=>W(m,f)},null,8,["file-list","upload-action","auth-headers","materials","onRemoveFile","onUploadSuccess","onMaterialSelected"]),e(Ya,{modelValue:f.selectedPlatform,"onUpdate:modelValue":m=>f.selectedPlatform=m,onPlatformChange:I},null,8,["modelValue","onUpdate:modelValue"]),e(as,{modelValue:f.selectedAccounts,"onUpdate:modelValue":m=>f.selectedAccounts=m,"platform-key":f.selectedPlatform},null,8,["modelValue","onUpdate:modelValue","platform-key"]),l("div",go,[f.selectedPlatform===1?(c(),G(Ps,{key:0,title:f.title,"onUpdate:title":m=>f.title=m,topics:f.selectedTopics,"onUpdate:topics":m=>f.selectedTopics=m,onValidationChange:(m,Q)=>b(m,Q,f)},null,8,["title","onUpdate:title","topics","onUpdate:topics","onValidationChange"])):Y("",!0),f.selectedPlatform===2?(c(),G(Ss,{key:1,title:f.title,"onUpdate:title":m=>f.title=m,topics:f.selectedTopics,"onUpdate:topics":m=>f.selectedTopics=m,onValidationChange:(m,Q)=>b(m,Q,f)},null,8,["title","onUpdate:title","topics","onUpdate:topics","onValidationChange"])):Y("",!0),f.selectedPlatform===3?(c(),G(Is,{key:2,title:f.title,"onUpdate:title":m=>f.title=m,topics:f.selectedTopics,"onUpdate:topics":m=>f.selectedTopics=m,onValidationChange:(m,Q)=>b(m,Q,f)},null,8,["title","onUpdate:title","topics","onUpdate:topics","onValidationChange"])):Y("",!0),f.selectedPlatform===4?(c(),G(Bs,{key:3,title:f.title,"onUpdate:title":m=>f.title=m,topics:f.selectedTopics,"onUpdate:topics":m=>f.selectedTopics=m,onValidationChange:(m,Q)=>b(m,Q,f)},null,8,["title","onUpdate:title","topics","onUpdate:topics","onValidationChange"])):Y("",!0),f.selectedPlatform===5?(c(),G(io,{key:4,title:f.title,"onUpdate:title":m=>f.title=m,topics:f.selectedTopics,"onUpdate:topics":m=>f.selectedTopics=m,"bili-type":f.biliType,"onUpdate:biliType":m=>f.biliType=m,"bili-partition":f.biliPartition,"onUpdate:biliPartition":m=>f.biliPartition=m,"bili-desc":f.biliDesc,"onUpdate:biliDesc":m=>f.biliDesc=m,"schedule-enabled":f.scheduleEnabled,"onUpdate:scheduleEnabled":m=>f.scheduleEnabled=m,"schedule-time":f.scheduleTime,"onUpdate:scheduleTime":m=>f.scheduleTime=m,onValidationChange:(m,Q)=>b(m,Q,f)},null,8,["title","onUpdate:title","topics","onUpdate:topics","bili-type","onUpdate:biliType","bili-partition","onUpdate:biliPartition","bili-desc","onUpdate:biliDesc","schedule-enabled","onUpdate:scheduleEnabled","schedule-time","onUpdate:scheduleTime","onValidationChange"])):Y("",!0),[1,2,3,4,5].includes(f.selectedPlatform)?Y("",!0):(c(),G(po,{key:5,title:f.title,"onUpdate:title":m=>f.title=m,topics:f.selectedTopics,"onUpdate:topics":m=>f.selectedTopics=m,"platform-key":f.selectedPlatform,onValidationChange:(m,Q)=>b(m,Q,f)},null,8,["title","onUpdate:title","topics","onUpdate:topics","platform-key","onValidationChange"]))]),f.selectedPlatform!==5?(c(),G(ps,{key:1,"schedule-enabled":f.scheduleEnabled,"onUpdate:scheduleEnabled":m=>f.scheduleEnabled=m,"videos-per-day":f.videosPerDay,"onUpdate:videosPerDay":m=>f.videosPerDay=m,"daily-times":f.dailyTimes,"onUpdate:dailyTimes":m=>f.dailyTimes=m,"start-days":f.startDays,"onUpdate:startDays":m=>f.startDays=m},null,8,["schedule-enabled","onUpdate:scheduleEnabled","videos-per-day","onUpdate:videosPerDay","daily-times","onUpdate:dailyTimes","start-days","onUpdate:startDays"])):Y("",!0),l("div",yo,[e(L,{size:"small",onClick:m=>h()},{default:t(()=>[...M[3]||(M[3]=[v("取消",-1)])]),_:1},8,["onClick"]),e(L,{size:"small",type:"primary",onClick:m=>K(f)},{default:t(()=>[...M[4]||(M[4]=[v("发布",-1)])]),_:1},8,["onClick"])])])),[[Ae,p.value===f.name]])),128))])]),e(B,{modelValue:D.value,"onUpdate:modelValue":M[2]||(M[2]=f=>D.value=f),title:"批量发布进度",width:"500px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},{footer:t(()=>[l("div",ko,[e(L,{onClick:ee,disabled:C.value===100},{default:t(()=>[...M[5]||(M[5]=[v(" 取消发布 ",-1)])]),_:1},8,["disabled"]),C.value===100?(c(),G(L,{key:0,type:"primary",onClick:M[1]||(M[1]=f=>D.value=!1)},{default:t(()=>[...M[6]||(M[6]=[v(" 关闭 ",-1)])]),_:1})):Y("",!0)])]),default:t(()=>[l("div",ho,[e(s,{percentage:C.value,status:C.value===100?"success":""},null,8,["percentage","status"]),$.value?(c(),T("div",bo," 正在发布："+z($.value.label),1)):Y("",!0),u.value.length>0?(c(),T("div",$o,[(c(!0),T(se,null,oe(u.value,(f,m)=>(c(),T("div",{key:m,class:de(["result-item",f.status])},[f.status==="success"?(c(),G(q,{key:0},{default:t(()=>[e(F(pt))]),_:1})):f.status==="error"?(c(),G(q,{key:1},{default:t(()=>[e(F(Ee))]),_:1})):(c(),G(q,{key:2},{default:t(()=>[e(F(mt))]),_:1})),l("span",wo,z(f.label),1),l("span",Vo,z(f.message),1)],2))),128))])):Y("",!0)])]),_:1},8,["modelValue"])])}}},To=Z(Co,[["__scopeId","data-v-cdc7a2a5"]]),Ao={class:"about"},Uo={__name:"About",setup(a){return(d,i)=>(c(),T("div",Ao,[...i[0]||(i[0]=[l("h1",null,"关于我们",-1),l("p",null,"这是关于页面",-1)])]))}},Po=Z(Uo,[["__scopeId","data-v-cd67ee8e"]]),xo=[{path:"/",name:"Dashboard",component:nl},{path:"/account-management",name:"AccountManagement",component:Zl},{path:"/material-management",name:"MaterialManagement",component:ga},{path:"/publish-center",name:"PublishCenter",component:To},{path:"/about",name:"About",component:Po}],Mo=Xe({history:Ge(),routes:xo}),So=Je(),we=Qe(Ct);for(const[a,d]of Object.entries(ft))we.component(a,d);we.use(Mo);we.use(So);we.use(vt);we.mount("#app");
